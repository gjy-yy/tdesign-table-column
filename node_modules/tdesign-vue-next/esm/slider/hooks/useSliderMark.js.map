{"version":3,"file":"useSliderMark.js","sources":["../../../src/slider/hooks/useSliderMark.tsx"],"sourcesContent":["import { computed, VNode, Ref } from 'vue';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { SliderMarks } from '../type';\nimport { TNode } from '../../common';\nimport log from '../../_common/js/log/log';\nimport { getStopStyle } from '../util/common';\nimport TSliderMark from '../slider-mark';\n\ninterface MarkItem {\n  point: number;\n  position: number;\n  mark: string | number | TNode<{ value: number }>;\n}\n\ninterface useSliderMarkProps {\n  max: number;\n  min: number;\n  marks: number[] | SliderMarks;\n  vertical: boolean;\n  prefixName: string;\n}\n\n/**\n * 聚合管理刻度值渲染逻辑\n */\nexport const useSliderMark = (config: Ref<useSliderMarkProps>) => {\n  const name = config.value.prefixName;\n  const markList = computed(() => {\n    const markProps = config.value;\n    if (!markProps.marks) {\n      return [];\n    }\n    const legalMarks: Array<MarkItem> = [];\n    if (Array.isArray(markProps.marks)) {\n      const marksList = cloneDeep(markProps.marks).sort((a, b) => a - b);\n      const maxLimit = Math.max(...marksList, markProps.max);\n      const minLimit = Math.min(...marksList, markProps.min);\n      if (minLimit < markProps.min) {\n        log.errorOnce('TSlider', 'marks min value should >= props min');\n      }\n      if (maxLimit > markProps.max) {\n        log.errorOnce('TSlider', 'marks max value should <= props max');\n      }\n      marksList.forEach((item) => {\n        legalMarks.push({\n          point: item,\n          position: ((item - minLimit) / (maxLimit - minLimit)) * 100,\n          mark: item,\n        });\n      });\n    } else {\n      Object.keys(markProps.marks)\n        .map(parseFloat)\n        .sort((a, b) => a - b)\n        .filter((point) => point <= markProps.max && point >= markProps.min)\n        .forEach((point) => {\n          const item: MarkItem = {\n            point,\n            position: ((point - markProps.min) * 100) / (markProps.max - markProps.min),\n            mark: markProps.marks[point],\n          };\n          legalMarks.push(item);\n        });\n    }\n    return legalMarks;\n  });\n\n  const renderMask = (onChangeFn?: (point: number) => void): VNode => {\n    if (markList.value.length) {\n      return (\n        <div>\n          <div>\n            {markList.value.map((item, index) => (\n              <div\n                class={`${name}__stop ${name}__mark-stop`}\n                style={getStopStyle(item.position, config.value.vertical)}\n                key={index}\n              />\n            ))}\n          </div>\n          <div class={`${name}__mark`}>\n            {markList.value.map((item, key) => (\n              <TSliderMark\n                mark={item.mark as any}\n                point={item.point}\n                key={key}\n                style={getStopStyle(item.position, config.value.vertical)}\n                onClickMarkPoint={onChangeFn}\n              />\n            ))}\n          </div>\n        </div>\n      );\n    }\n  };\n\n  return renderMask;\n};\n"],"names":["useSliderMark","config","name","value","prefixName","markList","computed","markProps","marks","legalMarks","Array","isArray","marksList","cloneDeep","sort","a","b","maxLimit","Math","max","minLimit","min","log","errorOnce","forEach","item","push","point","position","mark","Object","keys","map","parseFloat","filter","renderMask","onChangeFn","length","index","_createVNode","getStopStyle","vertical","key"],"mappings":"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"}