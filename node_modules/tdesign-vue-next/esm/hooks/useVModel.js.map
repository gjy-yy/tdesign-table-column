{"version":3,"file":"useVModel.js","sources":["../../src/hooks/useVModel.ts"],"sourcesContent":["import { ref, Ref, getCurrentInstance } from 'vue';\nimport kebabCase from 'lodash/kebabCase';\n\nexport type ChangeHandler<T> = (value: T, ...args: any) => void;\n\nexport default function useVModel<T, P extends (...args: any) => void>(\n  value: Ref<T>,\n  modelValue: Ref<T>,\n  defaultValue: T,\n  onChange: P,\n  propName = 'value',\n): [Ref<T>, ChangeHandler<T>] {\n  const { emit, vnode } = getCurrentInstance();\n  const internalValue: Ref<T> = ref();\n\n  const vProps = vnode.props || {};\n  const isVM = Object.prototype.hasOwnProperty.call(vProps, 'modelValue');\n  const isVMP =\n    Object.prototype.hasOwnProperty.call(vProps, propName) ||\n    Object.prototype.hasOwnProperty.call(vProps, kebabCase(propName));\n\n  if (isVM) {\n    return [\n      modelValue,\n      (newValue, ...args) => {\n        vProps['onUpdate:modelValue'] && emit('update:modelValue', newValue, ...args);\n        onChange?.(newValue, ...args);\n      },\n    ];\n  }\n\n  if (isVMP) {\n    return [\n      value,\n      (newValue, ...args) => {\n        vProps[`onUpdate:${propName}`] && emit(`update:${propName}`, newValue, ...args);\n        onChange?.(newValue, ...args);\n      },\n    ];\n  }\n\n  internalValue.value = defaultValue;\n  return [\n    internalValue,\n    (newValue, ...args) => {\n      internalValue.value = newValue;\n      onChange?.(newValue, ...args);\n    },\n  ];\n}\n"],"names":["useVModel","value","modelValue","defaultValue","onChange","propName","getCurrentInstance","emit","vnode","internalValue","ref","vProps","props","isVM","Object","prototype","hasOwnProperty","call","isVMP","kebabCase","newValue","args"],"mappings":"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"}