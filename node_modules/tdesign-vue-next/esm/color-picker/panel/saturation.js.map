{"version":3,"file":"saturation.js","sources":["../../../src/color-picker/panel/saturation.tsx"],"sourcesContent":["import { computed, defineComponent, nextTick, onBeforeUnmount, onMounted, reactive, ref } from 'vue';\nimport { SATURATION_PANEL_DEFAULT_HEIGHT, SATURATION_PANEL_DEFAULT_WIDTH } from '../const';\nimport { Draggable, Coordinate } from '../utils';\nimport { useBaseClassName } from '../hooks';\nimport baseProps from './base-props';\n\nexport default defineComponent({\n  name: 'SaturationPanel',\n\n  props: {\n    ...baseProps,\n  },\n  setup(props) {\n    const baseClassName = useBaseClassName();\n    const refPanel = ref<HTMLElement>(null);\n    const refThumb = ref<HTMLElement>(null);\n    const dragInstance = ref<Draggable>(null);\n    const panelRect = reactive({\n      width: SATURATION_PANEL_DEFAULT_WIDTH,\n      height: SATURATION_PANEL_DEFAULT_HEIGHT,\n    });\n\n    const styles = computed(() => {\n      const { saturation, value } = props.color;\n      const { width, height } = panelRect;\n      const top = Math.round((1 - value) * height);\n      const left = Math.round(saturation * width);\n      return {\n        color: props.color.rgb,\n        left: `${left}px`,\n        top: `${top}px`,\n      };\n    });\n\n    const getSaturationAndValueByCoordinate = (coordinate: Coordinate) => {\n      const { width, height } = panelRect;\n      const { x, y } = coordinate;\n      const saturation = Math.round((x / width) * 100);\n      const value = Math.round((1 - y / height) * 100);\n      return {\n        saturation,\n        value,\n      };\n    };\n\n    const handleDrag = (coordinate: Coordinate, isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      const { saturation, value } = getSaturationAndValueByCoordinate(coordinate);\n      props.onChange({\n        saturation: saturation / 100,\n        value: value / 100,\n        addUsedColor: isEnded,\n      });\n    };\n\n    const handleDragEnd = (coordinate: Coordinate) => {\n      if (props.disabled) {\n        return;\n      }\n      nextTick(() => {\n        handleDrag(coordinate, true);\n      });\n    };\n\n    const panelBackground = computed(() => {\n      return `hsl(${props.color.hue}, 100%, 50%)`;\n    });\n\n    onMounted(() => {\n      panelRect.width = refPanel.value.offsetWidth || SATURATION_PANEL_DEFAULT_WIDTH;\n      panelRect.height = refPanel.value.offsetHeight || SATURATION_PANEL_DEFAULT_HEIGHT;\n      dragInstance.value = new Draggable(refPanel.value, {\n        start() {\n          panelRect.width = refPanel.value.offsetWidth;\n          panelRect.height = refPanel.value.offsetHeight;\n        },\n        drag: (coordinate: Coordinate) => {\n          handleDrag(coordinate);\n        },\n        end: handleDragEnd,\n      });\n    });\n\n    onBeforeUnmount(() => {\n      dragInstance.value.destroy();\n    });\n\n    return {\n      baseClassName,\n      refThumb,\n      refPanel,\n      styles,\n      panelBackground,\n    };\n  },\n  render() {\n    const { baseClassName, styles, panelBackground } = this;\n    return (\n      <div\n        class={[`${baseClassName}__saturation`]}\n        ref=\"refPanel\"\n        style={{\n          background: panelBackground,\n        }}\n      >\n        <span class={[`${baseClassName}__thumb`]} role=\"slider\" tabindex={0} ref=\"refThumb\" style={styles}></span>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","baseProps","setup","baseClassName","useBaseClassName","refPanel","ref","refThumb","dragInstance","panelRect","reactive","width","SATURATION_PANEL_DEFAULT_WIDTH","height","SATURATION_PANEL_DEFAULT_HEIGHT","styles","computed","color","saturation","value","top","Math","round","left","rgb","getSaturationAndValueByCoordinate","coordinate","x","y","handleDrag","isEnded","disabled","onChange","addUsedColor","handleDragEnd","nextTick","panelBackground","hue","onMounted","offsetWidth","offsetHeight","Draggable","start","drag","end","onBeforeUnmount","destroy","render","_createVNode","background"],"mappings":"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"}