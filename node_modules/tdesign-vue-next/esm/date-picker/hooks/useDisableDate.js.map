{"version":3,"file":"useDisableDate.js","sources":["../../../src/date-picker/hooks/useDisableDate.ts"],"sourcesContent":["import dayjs from 'dayjs';\nimport isObject from 'lodash/isObject';\nimport type { TdDatePickerProps, TdDateRangePickerProps } from '../type';\n\nexport interface disableDateProps {\n  disableDate?: TdDatePickerProps['disableDate'] | TdDateRangePickerProps['disableDate'];\n  format?: TdDatePickerProps['format'];\n  mode?: TdDatePickerProps['mode'];\n  start?: Date;\n  end?: Date;\n}\n\nexport default function useDisableDate(props: disableDateProps) {\n  return {\n    disableDate: (value: Date) =>\n      !isEnabled({ disableDate: props.disableDate, format: props.format, mode: props.mode, value }),\n    minDate:\n      isObject(props.disableDate) && 'before' in props.disableDate ? new Date(props.disableDate.before) : props.start,\n    maxDate:\n      isObject(props.disableDate) && 'after' in props.disableDate ? new Date(props.disableDate.after) : props.end,\n  };\n}\n\nfunction isEnabled(props: any): boolean {\n  if (!props.disableDate) return true;\n\n  let isEnabled = true;\n  // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n  if (typeof props.disableDate === 'function') {\n    return !props.disableDate(props.value);\n  }\n\n  // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n  if (Array.isArray(props.disableDate)) {\n    let isIncludes = false;\n    const formatedDisabledDate = props.disableDate.map((item: string) => dayjs(item, props.format));\n    formatedDisabledDate.forEach((item: any) => {\n      if (item.isSame(dayjs(props.value))) {\n        isIncludes = true;\n      }\n    });\n    return !isIncludes;\n  }\n\n  // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n  if (props.disableDate.from && props.disableDate.to) {\n    const compareMin = dayjs(new Date(props.disableDate.from));\n    const compareMax = dayjs(new Date(props.disableDate.to));\n\n    return !dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  }\n\n  const min = props.disableDate.before ? new Date(props.disableDate.before) : null;\n  const max = props.disableDate.after ? new Date(props.disableDate.after) : null;\n\n  // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n  if (max && min) {\n    const compareMin = dayjs(new Date(min));\n    const compareMax = dayjs(new Date(max));\n\n    isEnabled = dayjs(props.value).isBetween(compareMin, compareMax, props.mode, '[]');\n  } else if (min) {\n    const compareMin = dayjs(new Date(min));\n    isEnabled = !dayjs(props.value).isBefore(compareMin, props.mode);\n  } else if (max) {\n    const compareMax = dayjs(new Date(max));\n    isEnabled = !dayjs(props.value).isAfter(compareMax, props.mode);\n  }\n  return isEnabled;\n}\n"],"names":["useDisableDate","props","disableDate","value","isEnabled","format","mode","minDate","isObject","Date","before","start","maxDate","after","end","Array","isArray","isIncludes","formatedDisabledDate","map","item","dayjs","forEach","isSame","from","to","compareMin","compareMax","isBetween","min","max","isBefore","isAfter"],"mappings":"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"}