{"version":3,"file":"tabs.js","sources":["../../src/tabs/tabs.tsx"],"sourcesContent":["import { ComponentPublicInstance, defineComponent, provide, Ref, toRefs } from 'vue';\nimport TTabPanel from './tab-panel';\nimport TTabNav from './tab-nav';\nimport { TabValue, TdTabsProps } from './type';\nimport props from './props';\n\nimport { useTNodeJSX } from '../hooks/tnode';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport useVModel from '../hooks/useVModel';\n\nexport interface InjectTabs {\n  value: Ref<TabValue>;\n}\n\nexport default defineComponent({\n  name: 'TTabs',\n\n  props,\n\n  setup(props) {\n    const COMPONENT_NAME = usePrefixClass('tabs');\n    const classPrefix = usePrefixClass();\n    const renderTNodeJSX = useTNodeJSX();\n\n    const { value, modelValue } = toRefs(props);\n    const [tabValue, setTabValue] = useVModel(value, modelValue, props.defaultValue || '', props.onChange);\n\n    provide<InjectTabs>('tabs', { value: tabValue });\n\n    // methods\n    const onTabAdd = (context: { e: MouseEvent }) => {\n      props.onAdd?.({ e: context.e });\n    };\n    const onTabChange = (value: TabValue) => {\n      setTabValue(value);\n    };\n    const onTabRemove = ({ e, value, index }: Parameters<TdTabsProps['onRemove']>[0]) => {\n      props.onRemove({ value, index, e });\n    };\n\n    // render\n    const getSlotPanels = () => {\n      let content = renderTNodeJSX('default');\n      if (!content) return [];\n      content = content\n        .map((item: ComponentPublicInstance) => {\n          if (item.children && Array.isArray(item.children)) return item.children;\n          return item;\n        })\n        .flat()\n        .filter((item: ComponentPublicInstance) => {\n          return item.type.name === 'TTabPanel';\n        });\n\n      return content;\n    };\n    const renderHeader = () => {\n      const panels = (props.list?.length ? props.list : getSlotPanels()) || [];\n      const panelsData = panels.map((item: ComponentPublicInstance) => {\n        const selfItem = item;\n\n        if (item.props) {\n          Object.keys(item.props).forEach((key) => {\n            selfItem[key] = item.props[key];\n          });\n        }\n\n        return selfItem;\n      });\n      const tabNavProps = {\n        theme: props.theme,\n        value: tabValue.value,\n        size: props.size,\n        disabled: props.disabled,\n        placement: props.placement,\n        addable: props.addable,\n        panels: panelsData,\n        dragSort: props.dragSort,\n      };\n      return (\n        <div\n          class={{\n            [`${classPrefix.value}-tabs__header`]: true,\n            [`${classPrefix.value}-is-${props.placement}`]: true,\n          }}\n        >\n          <TTabNav\n            {...tabNavProps}\n            onDragSort={props.onDragSort}\n            onChange={onTabChange}\n            onAdd={onTabAdd}\n            onRemove={onTabRemove}\n          />\n        </div>\n      );\n    };\n    const renderContent = () => {\n      const panels = getSlotPanels();\n      if (props.list?.length) {\n        return props.list.map((item) => <TTabPanel {...item} onRemove={onTabRemove} />);\n      }\n      if (panels && panels.length) {\n        return <div class={[`${classPrefix.value}-tabs__content`]}>{panels}</div>;\n      }\n      console.warn('Tdesign error: list or slots is empty');\n    };\n\n    return () => {\n      return (\n        <div class={[COMPONENT_NAME.value]}>\n          {props.placement !== 'bottom' ? [renderHeader(), renderContent()] : [renderContent(), renderHeader()]}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","COMPONENT_NAME","usePrefixClass","classPrefix","renderTNodeJSX","useTNodeJSX","toRefs","value","modelValue","useVModel","defaultValue","onChange","tabValue","setTabValue","provide","onTabAdd","context","onAdd","e","onTabChange","onTabRemove","index","onRemove","getSlotPanels","content","map","item","children","Array","isArray","flat","filter","type","renderHeader","panels","list","length","panelsData","selfItem","Object","keys","forEach","key","tabNavProps","theme","size","disabled","placement","addable","dragSort","_createVNode","_mergeProps","onDragSort","renderContent","TTabPanel","console","warn"],"mappings":"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"}