{"version":3,"file":"switch.js","sources":["../../src/switch/switch.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild, computed, watch, toRefs } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TNodeReturnValue } from '../common';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TSwitch',\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const disabled = useFormDisabled();\n    const COMPONENT_NAME = usePrefixClass('switch');\n    const { STATUS, SIZE } = useCommonClassName();\n    // values\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setSwitchVal] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    const activeValue = computed(() => {\n      if (props.customValue && props.customValue.length > 0) {\n        return props.customValue[0];\n      }\n      return true;\n    });\n    const inactiveValue = computed(() => {\n      if (props.customValue && props.customValue.length > 1) {\n        return props.customValue[1];\n      }\n      return false;\n    });\n\n    // methods\n    function handleToggle() {\n      const checked = innerValue.value === activeValue.value ? inactiveValue.value : activeValue.value;\n      // emits\n      setSwitchVal(checked);\n    }\n\n    function toggle() {\n      if (disabled.value || props.loading) {\n        return;\n      }\n      handleToggle();\n    }\n\n    // classes\n    const classes = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      SIZE.value[props.size],\n      {\n        [STATUS.value.disabled]: disabled.value,\n        [STATUS.value.loading]: props.loading,\n        [STATUS.value.checked]: innerValue.value === activeValue.value || props.modelValue === activeValue.value,\n      },\n    ]);\n    const nodeClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__handle`,\n        {\n          [STATUS.value.disabled]: disabled.value,\n          [STATUS.value.loading]: props.loading,\n        },\n      ];\n    });\n    const contentClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content`,\n        SIZE.value[props.size],\n        {\n          [STATUS.value.disabled]: disabled.value,\n        },\n      ];\n    });\n\n    watch(\n      innerValue,\n      (val) => {\n        if (props.customValue && props.customValue.length && !props.customValue.includes(val)) {\n          throw new Error(`value is not in ${JSON.stringify(props.customValue)}`);\n        }\n      },\n      {\n        immediate: true,\n      },\n    );\n\n    const content = computed<VNodeChild>(() => {\n      if (typeof props.label === 'function') {\n        return props.label(h, { value: innerValue.value });\n      }\n      if (typeof props.label === 'string') {\n        return props.label;\n      }\n      if (Array.isArray(props.label) && props.label.length) {\n        const label = innerValue.value === activeValue.value ? props.label[0] : props.label[1];\n        if (!label) return;\n        if (typeof label === 'string') {\n          return label;\n        }\n        if (typeof label === 'function') {\n          return label(h);\n        }\n      }\n      if (slots.label) {\n        return slots.label({ value: innerValue.value });\n      }\n      return null;\n    });\n    return () => {\n      let switchContent: VNodeChild;\n      let loadingContent: TNodeReturnValue;\n      if (props.loading) {\n        loadingContent = <TLoading size=\"small\" />;\n      } else if (content.value) {\n        switchContent = content.value;\n      }\n\n      return (\n        <div class={classes.value} disabled={disabled.value} onClick={toggle}>\n          <span class={nodeClasses.value}>{loadingContent}</span>\n          <div class={contentClasses.value}>{switchContent}</div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","slots","disabled","useFormDisabled","COMPONENT_NAME","usePrefixClass","useCommonClassName","STATUS","SIZE","toRefs","value","modelValue","useVModel","defaultValue","onChange","innerValue","setSwitchVal","activeValue","computed","customValue","length","inactiveValue","handleToggle","checked","toggle","loading","classes","size","nodeClasses","contentClasses","watch","val","includes","Error","JSON","stringify","immediate","content","label","h","Array","isArray","switchContent","loadingContent","_createVNode","TLoading"],"mappings":"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"}