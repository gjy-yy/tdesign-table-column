{"version":3,"file":"notificationList.js","sources":["../../src/notification/notificationList.tsx"],"sourcesContent":["import { defineComponent, ref, computed, Ref, CSSProperties } from 'vue';\nimport Notification from './notification';\nimport { TdNotificationProps, NotificationOptions } from './type';\nimport { DEFAULT_Z_INDEX, PLACEMENT_OFFSET, DISTANCE } from './const';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport default defineComponent({\n  props: {\n    placement: {\n      type: String,\n      default: 'top-right',\n      validator(v: string): boolean {\n        return ['top-left', 'top-right', 'bottom-left', 'bottom-right'].indexOf(v) > -1;\n      },\n    },\n  },\n  setup(props, { expose }) {\n    const COMPONENT_NAME = usePrefixClass('notification-list');\n\n    const { placement } = props as NotificationOptions;\n\n    const list: Ref<NotificationOptions[]> = ref([]);\n    const notificationList = ref([]);\n\n    const styles = computed(() => ({\n      zIndex: DEFAULT_Z_INDEX,\n      ...PLACEMENT_OFFSET[placement],\n    }));\n\n    const add = (options: TdNotificationProps): number => {\n      list.value.push(options);\n      return list.value.length - 1;\n    };\n\n    const remove = (index: number) => {\n      list.value.splice(index, 1);\n    };\n\n    const removeAll = () => {\n      list.value = [];\n    };\n\n    const getOffset = (val: string | number) => {\n      if (!val) return;\n      return isNaN(Number(val)) ? val : `${val}px`;\n    };\n\n    const notificationStyles = (item: { offset: NotificationOptions['offset']; zIndex: number }) => {\n      const styles: CSSProperties = {\n        marginBottom: DISTANCE,\n      };\n      if (item.offset) {\n        styles.position = 'relative';\n        styles.left = getOffset(item.offset[0]);\n        styles.top = getOffset(item.offset[1]);\n      }\n      if (item.zIndex) styles['z-index'] = item.zIndex;\n      return styles;\n    };\n\n    const getProps = (index: number, item: NotificationOptions) => {\n      return {\n        ...item,\n        onCloseBtnClick: (e: any) => {\n          if (item.onCloseBtnClick) {\n            item.onCloseBtnClick(e);\n          }\n          return remove(index);\n        },\n        onDurationEnd: () => {\n          if (item.onDurationEnd) {\n            item.onDurationEnd();\n          }\n          return remove(index);\n        },\n      };\n    };\n\n    const addChild = (el: Element) => {\n      if (el) {\n        notificationList.value.push(el);\n      }\n    };\n    expose({ add, remove, removeAll, list, notificationList });\n\n    return () => {\n      if (!list.value.length) return;\n\n      return (\n        <div class={`${COMPONENT_NAME.value}__show`} style={styles.value}>\n          {list.value.map((item: { offset: NotificationOptions['offset']; zIndex: number; id: number }, index) => (\n            <Notification ref={addChild} key={item.id} style={notificationStyles(item)} {...getProps(index, item)} />\n          ))}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","props","placement","type","String","validator","v","indexOf","setup","expose","COMPONENT_NAME","usePrefixClass","list","ref","notificationList","styles","computed","zIndex","DEFAULT_Z_INDEX","PLACEMENT_OFFSET","add","options","value","push","length","remove","index","splice","removeAll","getOffset","val","isNaN","Number","notificationStyles","item","marginBottom","DISTANCE","offset","position","left","top","getProps","onCloseBtnClick","e","onDurationEnd","addChild","el","_createVNode","map","Notification","_mergeProps","id"],"mappings":"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"}