{"version":3,"file":"notification.js","sources":["../../src/notification/notification.tsx"],"sourcesContent":["import { defineComponent, h, onBeforeMount, onMounted, ref } from 'vue';\nimport {\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  CloseIcon as TdCloseIcon,\n} from 'tdesign-icons-vue-next';\nimport isFunction from 'lodash/isFunction';\n\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\nimport props from './props';\nimport { useConfig, usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { fadeIn, fadeOut } from './animate';\n\nexport default defineComponent({\n  name: 'TNotification',\n  props: {\n    ...props,\n    placement: String, // just for animation\n  },\n  setup(props, { slots, expose }) {\n    const COMPONENT_NAME = usePrefixClass('notification');\n    const { classPrefix } = useConfig('classPrefix');\n    const { InfoCircleFilledIcon, CheckCircleFilledIcon, CloseIcon } = useGlobalIcon({\n      InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n      CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n      CloseIcon: TdCloseIcon,\n    });\n    const renderTNode = useTNodeJSX();\n    const renderContent = useContent();\n    const timer = ref(null);\n    const notificationRef = ref(null);\n\n    const close = (e?: MouseEvent) => {\n      const dom = notificationRef.value as HTMLElement;\n      fadeOut(dom, props.placement, () => {\n        props.onCloseBtnClick?.({ e });\n      });\n    };\n\n    const renderIcon = () => {\n      let iconContent;\n      if (props.icon === false) return null;\n      if (isFunction(props.icon)) {\n        iconContent = props.icon(h);\n      } else if (slots.icon) {\n        iconContent = slots.icon(null);\n      } else if (props.theme) {\n        const iconType =\n          props.theme === 'success' ? (\n            <CheckCircleFilledIcon class={`${classPrefix.value}-is-${props.theme}`} />\n          ) : (\n            <InfoCircleFilledIcon class={`${classPrefix.value}-is-${props.theme}`} />\n          );\n        iconContent = <div class={`t-notification__icon`}>{iconType}</div>;\n      }\n      return iconContent;\n    };\n\n    const renderClose = () => {\n      const defaultClose = <CloseIcon />;\n      return (\n        <span class={`${classPrefix.value}-message__close`} onClick={close}>\n          {renderTNode('closeBtn', defaultClose)}\n        </span>\n      );\n    };\n\n    const renderMainContent = () => {\n      return <div class={`${COMPONENT_NAME.value}__content`}>{renderContent('default', 'content')}</div>;\n    };\n\n    const clearTimer = () => {\n      props.duration && clearTimeout(timer.value);\n    };\n\n    const setTimer = () => {\n      if (!props.duration) {\n        return;\n      }\n      timer.value = Number(\n        setTimeout(() => {\n          clearTimer();\n          const dom = notificationRef.value as HTMLElement;\n          fadeOut(dom, props.placement, () => {\n            props.onDurationEnd?.();\n          });\n        }, props.duration),\n      );\n    };\n\n    onBeforeMount(() => {\n      props.duration && setTimer();\n    });\n\n    onMounted(() => {\n      const dom = notificationRef.value;\n      fadeIn(dom, props.placement);\n    });\n\n    expose({ close });\n    return () => (\n      <div ref={notificationRef} class={`${COMPONENT_NAME.value}`} onMouseenter={clearTimer} onMouseleave={setTimer}>\n        {renderIcon()}\n        <div class={`${COMPONENT_NAME.value}__main`}>\n          <div class={`${COMPONENT_NAME.value}__title__wrap`}>\n            <span class={`${COMPONENT_NAME.value}__title`}>{renderTNode('title')}</span>\n            {renderClose()}\n          </div>\n          {renderMainContent()}\n          {renderTNode('footer')}\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","placement","String","setup","slots","expose","COMPONENT_NAME","usePrefixClass","useConfig","classPrefix","useGlobalIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","CloseIcon","TdCloseIcon","renderTNode","useTNodeJSX","renderContent","useContent","timer","ref","notificationRef","close","e","dom","value","fadeOut","onCloseBtnClick","renderIcon","iconContent","icon","isFunction","h","theme","iconType","_createVNode","renderClose","defaultClose","renderMainContent","clearTimer","duration","clearTimeout","setTimer","Number","setTimeout","onDurationEnd","onBeforeMount","onMounted","fadeIn"],"mappings":"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"}