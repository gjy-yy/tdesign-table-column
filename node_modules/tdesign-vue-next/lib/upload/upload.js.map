{"version":3,"file":"upload.js","sources":["../../src/upload/upload.tsx"],"sourcesContent":["import { VNode, defineComponent, reactive, computed, toRefs } from 'vue';\n\nimport { UploadIcon as TdUploadIcon } from 'tdesign-icons-vue-next';\n\nimport Dragger from './dragger';\nimport ImageCard from './image';\nimport FlowList from './flow-list';\nimport TButton from '../button';\nimport TDialog from '../dialog';\nimport SingleFile from './single-file';\n\nimport props from './props';\nimport { UploadCtxType } from './interface';\nimport { TdUploadProps } from './type';\n\nimport { useFormDisabled } from '../form/hooks';\nimport { useComponentsStatus, useImgPreview, useDragger, useRemove, useActions, useBatchUpload } from './hooks';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { useConfig, usePrefixClass } from '../hooks/useConfig';\nimport { useContent } from '../hooks/tnode';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TUpload',\n  props,\n\n  setup(props, { expose }) {\n    const renderTNodeContent = useContent();\n    const { classPrefix: prefix, globalConfig } = useConfig('upload');\n    const UPLOAD_NAME = usePrefixClass('upload');\n    const { UploadIcon } = useGlobalIcon({ UploadIcon: TdUploadIcon });\n    const { files, modelValue } = toRefs(props);\n\n    // 合并上传相关状态\n    const { canBatchUpload, uploadInOneRequest } = useBatchUpload(props);\n    // handle controlled property and uncontrolled property\n    const [uploadValue, setUploadValue] = useVModel(\n      files,\n      modelValue,\n      props.defaultFiles || [],\n      props.onChange,\n      'files',\n    );\n\n    const uploadCtx: UploadCtxType = reactive({\n      uploadValue,\n      setUploadValue,\n      uploadInOneRequest,\n      canBatchUpload,\n      // 加载中的文件\n      loadingFile: null,\n      percent: 0,\n      // 等待上传的文件队列\n      toUploadFiles: [],\n      errorMsg: '',\n    });\n\n    const disabled = useFormDisabled();\n\n    // 组件状态\n    const { showUploadList, showTips, showErrorMsg, singleDraggable } = useComponentsStatus(props, uploadCtx);\n\n    // 图片预览\n    const { showImageViewUrl, showImageViewDialog, handlePreviewImg, cancelPreviewImgDialog } = useImgPreview(props);\n\n    // 拖动\n    const { handleDragenter, handleDragleave, dragActive } = useDragger(props, disabled);\n\n    // 删除\n    const { handleFileInputRemove, handleSingleRemove, handleMultipleRemove, handleListRemove } = useRemove(\n      props,\n      uploadCtx,\n    );\n\n    // 上传相关动作\n    const { handleChange, multipleUpload, triggerUpload, cancelUpload, handleDragChange, upload, inputRef } =\n      useActions(props, uploadCtx, disabled);\n\n    expose({\n      triggerUpload,\n      setPercent: (val: number) => {\n        uploadCtx.percent = val;\n      },\n    });\n\n    // input 节点\n    const renderInput = () => {\n      return (\n        <input\n          ref={inputRef}\n          type=\"file\"\n          disabled={disabled.value}\n          onChange={handleChange}\n          multiple={props.multiple}\n          accept={props.accept}\n          hidden\n        />\n      );\n    };\n\n    // 渲染单文件预览：设计稿有两种单文件预览方式，文本型和输入框型。输入框型的需要在右侧显示「删除」按钮\n    const renderSingleDisplay = (triggerElement: VNode) => {\n      return (\n        !props.draggable &&\n        ['file', 'file-input'].includes(props.theme) && (\n          <SingleFile\n            file={uploadValue.value && uploadValue.value[0]}\n            loadingFile={uploadCtx.loadingFile}\n            percent={uploadCtx.percent}\n            theme={props.theme}\n            onRemove={handleSingleRemove}\n            showUploadProgress={props.showUploadProgress}\n            placeholder={props.placeholder}\n          >\n            <div class={`${prefix.value}-upload__trigger`} onclick={triggerUpload}>\n              {triggerElement}\n              {!!(props.theme === 'file-input' && uploadValue.value?.length) && (\n                <TButton theme=\"primary\" variant=\"text\" onClick={handleFileInputRemove}>\n                  删除\n                </TButton>\n              )}\n            </div>\n          </SingleFile>\n        )\n      );\n    };\n\n    const renderDraggerTrigger = () => {\n      const params = {\n        dragActive: dragActive.value,\n        uploadingFile: props.multiple ? uploadCtx.toUploadFiles : uploadCtx.loadingFile,\n      };\n      let triggerElement = renderTNodeContent('default', 'trigger', { params });\n      if (!Array.isArray(triggerElement)) {\n        triggerElement = {};\n      }\n      return (\n        <Dragger\n          showUploadProgress={props.showUploadProgress}\n          loadingFile={uploadCtx.loadingFile}\n          percent={uploadCtx.percent}\n          file={uploadValue.value && uploadValue.value[0]}\n          theme={props.theme}\n          autoUpload={props.autoUpload}\n          onChange={handleDragChange}\n          onDragenter={handleDragenter}\n          onDragleave={handleDragleave}\n          onCancel={cancelUpload}\n          onClick={triggerUpload}\n          onRemove={handleSingleRemove}\n          onUpload={upload}\n          locale={props.locale}\n        >\n          {triggerElement}\n        </Dragger>\n      );\n    };\n\n    const uploadListTriggerText = computed(() => {\n      const localeFromProps = props.locale as TdUploadProps['locale'];\n\n      let uploadText = globalConfig.value.triggerUploadText.fileInput || localeFromProps?.triggerUploadText?.fileInput;\n      if (uploadCtx.toUploadFiles?.length > 0 || uploadCtx.uploadValue?.length > 0) {\n        if (props.theme === 'file-input' || (uploadCtx.uploadValue?.length > 0 && canBatchUpload.value)) {\n          uploadText = localeFromProps?.triggerUploadText?.reupload || globalConfig.value.triggerUploadText.reupload;\n        } else {\n          uploadText =\n            localeFromProps?.triggerUploadText?.continueUpload || globalConfig.value.triggerUploadText.continueUpload;\n        }\n      }\n      return uploadText;\n    });\n\n    const renderTrigger = () => {\n      const getDefaultTrigger = () => {\n        const localeFromProps = props.locale as TdUploadProps['locale'];\n\n        if (props.theme === 'file-input' || showUploadList.value) {\n          return (\n            <t-button variant=\"outline\">\n              {localeFromProps?.triggerUploadText?.fileInput || globalConfig.value.triggerUploadText.fileInput}\n            </t-button>\n          );\n        }\n        const iconSlot = { icon: () => <UploadIcon /> };\n        return (\n          <TButton variant=\"outline\" v-slots={iconSlot}>\n            {uploadListTriggerText.value}\n          </TButton>\n        );\n      };\n\n      const defaultNode = getDefaultTrigger();\n      return renderTNodeContent('default', 'trigger', defaultNode);\n    };\n\n    // 完全自定义上传\n    const renderCustom = (triggerElement: VNode) => {\n      if (props.theme !== 'custom') return;\n      return props.draggable ? (\n        renderDraggerTrigger()\n      ) : (\n        <div class={`${UPLOAD_NAME.value}__trigger`} onclick={triggerUpload}>\n          {triggerElement}\n        </div>\n      );\n    };\n\n    const renderImgCard = () =>\n      !props.draggable &&\n      props.theme === 'image' && (\n        <ImageCard\n          files={uploadValue.value}\n          loadingFile={uploadCtx.loadingFile}\n          percent={uploadCtx.percent}\n          showUploadProgress={props.showUploadProgress}\n          placeholder={props.placeholder}\n          multiple={props.multiple}\n          max={props.max}\n          disabled={disabled.value}\n          onClick={triggerUpload}\n          onRemove={handleMultipleRemove}\n          onImgPreview={handlePreviewImg}\n          locale={props.locale}\n        />\n      );\n\n    const renderFlowList = (triggerElement: VNode) => {\n      let { theme } = props;\n      if (props.multiple && props.theme === 'file' && props.draggable) {\n        theme = 'file-flow';\n      }\n      return (\n        showUploadList.value && (\n          <FlowList\n            files={uploadValue.value}\n            placeholder={props.placeholder}\n            autoUpload={props.autoUpload}\n            toUploadFiles={uploadCtx.toUploadFiles}\n            theme={theme}\n            batchUpload={uploadCtx.canBatchUpload}\n            showUploadProgress={props.showUploadProgress}\n            allowUploadDuplicateFile={props.allowUploadDuplicateFile}\n            onRemove={handleListRemove}\n            onUpload={multipleUpload}\n            onCancel={cancelUpload}\n            onImgPreview={handlePreviewImg}\n            onChange={handleDragChange}\n            onDragenter={handleDragenter}\n            onDragleave={handleDragleave}\n            locale={props.locale}\n          >\n            <div class={`${UPLOAD_NAME.value}__trigger`} onclick={triggerUpload}>\n              {triggerElement}\n            </div>\n          </FlowList>\n        )\n      );\n    };\n\n    const renderDialog = () =>\n      ['image', 'image-flow', 'custom'].includes(props.theme) && (\n        <TDialog\n          visible={showImageViewDialog.value}\n          showOverlay\n          width=\"auto\"\n          top=\"10%\"\n          class={`${UPLOAD_NAME.value}__dialog`}\n          footer={false}\n          header={false}\n          onClose={cancelPreviewImgDialog}\n        >\n          <div class={`${prefix.value}__dialog-body-img-box`}>\n            <img src={showImageViewUrl.value} alt=\"\" />\n          </div>\n        </TDialog>\n      );\n\n    const tipsClasses = computed(() => {\n      return [`${UPLOAD_NAME.value}__tips ${prefix.value}-size-s`];\n    });\n    const errorClasses = computed(() => {\n      return tipsClasses.value.concat(`${UPLOAD_NAME.value}__tips-error`);\n    });\n\n    return () => {\n      const triggerElement = renderTrigger();\n      return (\n        <div class={`${UPLOAD_NAME.value}`}>\n          {renderInput()}\n          {renderCustom(triggerElement)}\n          {renderSingleDisplay(triggerElement)}\n          {singleDraggable.value && renderDraggerTrigger()}\n          {renderImgCard()}\n          {renderFlowList(triggerElement)}\n          {renderDialog()}\n          {!uploadCtx.errorMsg && showTips.value && <small class={tipsClasses.value}>{props.tips}</small>}\n          {showErrorMsg.value && <small class={errorClasses.value}>{uploadCtx.errorMsg}</small>}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","expose","renderTNodeContent","useContent","useConfig","prefix","classPrefix","globalConfig","UPLOAD_NAME","usePrefixClass","useGlobalIcon","UploadIcon","TdUploadIcon","toRefs","files","modelValue","useBatchUpload","canBatchUpload","uploadInOneRequest","useVModel","defaultFiles","onChange","uploadValue","setUploadValue","uploadCtx","reactive","loadingFile","percent","toUploadFiles","errorMsg","disabled","useFormDisabled","useComponentsStatus","showUploadList","showTips","showErrorMsg","singleDraggable","useImgPreview","showImageViewUrl","showImageViewDialog","handlePreviewImg","cancelPreviewImgDialog","useDragger","handleDragenter","handleDragleave","dragActive","useRemove","handleFileInputRemove","handleSingleRemove","handleMultipleRemove","handleListRemove","useActions","handleChange","multipleUpload","triggerUpload","cancelUpload","handleDragChange","upload","inputRef","setPercent","val","renderInput","_createVNode","value","multiple","accept","renderSingleDisplay","triggerElement","draggable","includes","theme","showUploadProgress","placeholder","length","TButton","renderDraggerTrigger","params","uploadingFile","Array","isArray","autoUpload","locale","uploadListTriggerText","computed","localeFromProps","uploadText","triggerUploadText","fileInput","reupload","continueUpload","renderTrigger","getDefaultTrigger","_resolveComponent","iconSlot","icon","defaultNode","renderCustom","renderImgCard","max","renderFlowList","allowUploadDuplicateFile","renderDialog","TDialog","tipsClasses","errorClasses","concat","tips"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,cAAeA,eAAgB,CAAA;AAC7BC,EAAAA,IAAM,EAAA,SADuB;AAE7BC,EAAAA,KAAA,EAAAA,KAF6B;EAI7BC,KAJ6B,EAAA,SAAA,KAAA,CAIvBD,MAJuB,EAIJ,IAAA,EAAA;IAAA,IAAVE,MAAU,QAAVA,MAAU,CAAA;IACvB,IAAMC,qBAAqBC,UAAW,EAAtC,CAAA;;IACA,IAA8CC,UAAAA,GAAAA,UAAU,SAAxD;QAAqBC,MAArB,cAAQC,WAAR;QAA6BC,YAA7B,cAA6BA,YAA7B,CAAA;;AACM,IAAA,IAAAC,WAAA,GAAcC,eAAe,SAA7B,CAAA;;AACN,IAAA,IAAA,cAAA,GAAuBC,cAAc;AAAEC,MAAAA,UAAA,EAAYC,UAAAA;AAAd,MAArC;QAAQD,YAAR,kBAAQA,UAAR,CAAA;;IACA,IAA8BE,OAAAA,GAAAA,OAAOd,OAArC;QAAQe,KAAR,WAAQA,KAAR;QAAeC,UAAf,WAAeA,UAAf,CAAA;;IAGA,IAA+CC,eAAAA,GAAAA,eAAejB,OAA9D;QAAQkB,cAAR,mBAAQA,cAAR;QAAwBC,kBAAxB,mBAAwBA,kBAAxB,CAAA;;AAEM,IAAA,IAAA,UAAA,GAAgCC,SAAA,CACpCL,KADoC,EAEpCC,UAFoC,EAGpChB,MAAAA,CAAMqB,YAANrB,IAAsB,EAHc,EAIpCA,MAAM,CAAAsB,QAJ8B,EAKpC,OALoC,CAAhC;AAAA,QAAA,WAAA,GAAA,cAAA,CAAA,UAAA,EAAA,CAAA,CAAA;AAAA,QAACC,WAAD,GAAA,WAAA,CAAA,CAAA,CAAA;AAAA,QAAcC,cAAd,GAAA,WAAA,CAAA,CAAA,CAAA,CAAA;;IAQN,IAAMC,YAA2BC,QAAS,CAAA;AACxCH,MAAAA,WAAA,EAAAA,WADwC;AAExCC,MAAAA,cAAA,EAAAA,cAFwC;AAGxCL,MAAAA,kBAAA,EAAAA,kBAHwC;AAIxCD,MAAAA,cAAA,EAAAA,cAJwC;AAMxCS,MAAAA,WAAa,EAAA,IAN2B;AAOxCC,MAAAA,OAAS,EAAA,CAP+B;AASxCC,MAAAA,eAAe,EATyB;AAUxCC,MAAAA,QAAU,EAAA,EAAA;AAV8B,KAAA,CAA1C,CAAA;IAaA,IAAMC,WAAWC,eAAgB,EAAjC,CAAA;;AAGM,IAAA,IAAA,oBAAA,GAA8DC,mBAAA,CAAoBjC,MAApB,EAA2ByB,SAA3B,CAA9D;QAAES,cAAF,wBAAEA,cAAF;QAAkBC,QAAlB,wBAAkBA,QAAlB;QAA4BC,YAA5B,wBAA4BA,YAA5B;QAA0CC,eAA1C,wBAA0CA,eAA1C,CAAA;;IAGN,IAA4FC,cAAAA,GAAAA,cAActC,OAA1G;QAAQuC,gBAAR,kBAAQA,gBAAR;QAA0BC,mBAA1B,kBAA0BA,mBAA1B;QAA+CC,gBAA/C,kBAA+CA,gBAA/C;QAAiEC,sBAAjE,kBAAiEA,sBAAjE,CAAA;;AAGA,IAAA,IAAA,WAAA,GAAyDC,UAAA,CAAW3C,MAAX,EAAkB+B,QAAlB,CAAzD;QAAQa,eAAR,eAAQA,eAAR;QAAyBC,eAAzB,eAAyBA,eAAzB;QAA0CC,UAA1C,eAA0CA,UAA1C,CAAA;;AAGA,IAAA,IAAA,UAAA,GAA8FC,SAAA,CAC5F/C,MAD4F,EAE5FyB,SAF4F,CAA9F;QAAQuB,qBAAR,cAAQA,qBAAR;QAA+BC,kBAA/B,cAA+BA,kBAA/B;QAAmDC,oBAAnD,cAAmDA,oBAAnD;QAAyEC,gBAAzE,cAAyEA,gBAAzE,CAAA;;AAMA,IAAA,IAAA,WAAA,GACEC,UAAA,CAAWpD,MAAX,EAAkByB,SAAlB,EAA6BM,QAA7B,CADF;QAAQsB,YAAR,eAAQA,YAAR;QAAsBC,cAAtB,eAAsBA,cAAtB;QAAsCC,aAAtC,eAAsCA,aAAtC;QAAqDC,YAArD,eAAqDA,YAArD;QAAmEC,gBAAnE,eAAmEA,gBAAnE;QAAqFC,MAArF,eAAqFA,MAArF;QAA6FC,QAA7F,eAA6FA,QAA7F,CAAA;;AAGOzD,IAAAA,MAAA,CAAA;AACLqD,MAAAA,aAAA,EAAAA,aADK;MAELK,UAAA,EAAY,SAACC,UAAAA,CAAAA,GAAD,EAAiB;QAC3BpC,SAAA,CAAUG,OAAV,GAAoBiC,GAApB,CAAA;AACF,OAAA;AAJK,KAAA,CAAA,CAAA;;AAQP,IAAA,IAAMC,cAAc,SAAdA,WAAc,GAAM;AACxB,MAAA,OAAAC,WAAA,CAAA,OAAA,EAAA;AAAA,QAAA,KAAA,EAESJ,QAFT;AAAA,QAAA,MAAA,EAGS,MAHT;QAAA,UAIc5B,EAAAA,QAAA,CAASiC,KAJvB;AAAA,QAAA,UAAA,EAKcX,YALd;QAAA,UAMcrD,EAAAA,MAAAA,CAAMiE,QANpB;QAAA,QAOYjE,EAAAA,MAAAA,CAAMkE,MAPlB;AAAA,QAAA,QAAA,EAAA,IAAA;AAAA,OAAA,EAAA,IAAA,CAAA,CAAA;KADF,CAAA;;AAeM,IAAA,IAAAC,mBAAA,GAAsB,SAAtBA,mBAAsB,CAACC,cAAD,EAA2B;AAAA,MAAA,IAAA,kBAAA,CAAA;;AACrD,MAAA,OACE,CAACpE,MAAM,CAAAqE,SAAP,IACA,CAAC,MAAD,EAAS,YAAT,EAAuBC,QAAvB,CAAgCtE,MAAAA,CAAMuE,KAAtC,CADA,IAAAR,WAAA,CAAA,UAAA,EAAA;QAAA,MAGUxC,EAAAA,WAAA,CAAYyC,KAAZ,IAAqBzC,WAAY,CAAAyC,KAAZ,CAAkB,CAAlB,CAH/B;QAAA,aAIiBvC,EAAAA,SAAA,CAAUE,WAJ3B;QAAA,SAKaF,EAAAA,UAAUG,OALvB;QAAA,OAMW5B,EAAAA,OAAMuE,KANjB;AAAA,QAAA,UAAA,EAOctB,kBAPd;QAAA,oBAQwBjD,EAAAA,MAAAA,CAAMwE,kBAR9B;AAAA,QAAA,aAAA,EASiBxE,MAAAA,CAAMyE,WAAAA;AATvB,OAAA,EAAA;AAAA,QAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,UAAA,OAAA,CAAAV,WAAA,CAAA,KAAA,EAAA;YAAA,OAWmBzD,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,MAAA,CAAO0D,KAX1B,EAAA,kBAAA,CAAA;YAAA,SAW4DT,EAAAA,aAAAA;AAX5D,WAAA,EAAA,CAYOa,cAZP,EAaO,CAAC,EAAEpE,MAAAA,CAAMuE,KAANvE,KAAgB,YAAhBA,IAAAA,CAAAA,kBAAAA,GAAgCuB,YAAYyC,KAA5ChE,MAAgC,IAAA,IAAA,kBAAA,KAAA,KAAA,CAAA,IAAA,kBAAA,CAAmB0E,MAArD,CAAD,IAAAX,WAAA,CAAAY,MAAA,EAAA;AAAA,YAAA,OAAA,EACgB,SADhB;AAAA,YAAA,SAAA,EACkC,MADlC;YAAA,SACkD3B,EAAAA,qBAAAA;AADlD,WAAA,EAAA;AAAA,YAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,cAAA,OAAA,CACyE,cADzE,CAAA,CAAA;AAAA,aAAA;WAbP,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,SAAA;OADF,CAAA,CAAA;KADI,CAAA;;AA0BN,IAAA,IAAM4B,uBAAuB,SAAvBA,oBAAuB,GAAM;AACjC,MAAA,IAAMC,MAAS,GAAA;QACb/B,YAAYA,UAAW,CAAAkB,KADV;QAEbc,aAAe9E,EAAAA,MAAAA,CAAMiE,QAANjE,GAAiByB,SAAA,CAAUI,aAA3B7B,GAA2CyB,SAAU,CAAAE,WAAAA;OAFtE,CAAA;AAIA,MAAA,IAAIyC,iBAAiBjE,kBAAmB,CAAA,SAAA,EAAW,SAAX,EAAsB;AAAE0E,QAAAA,QAAAA,MAAAA;AAAF,OAAtB,CAAxC,CAAA;;AACA,MAAA,IAAI,CAACE,KAAA,CAAMC,OAAN,CAAcZ,cAAd,CAAL,EAAoC;AAClCA,QAAAA,cAAA,GAAiB,EAAjB,CAAA;AACF,OAAA;;AACA,MAAA,OAAAL,WAAA,CAAA,OAAA,EAAA;QAAA,oBAEwB/D,EAAAA,OAAMwE,kBAF9B;QAAA,aAGiB/C,EAAAA,UAAUE,WAH3B;QAAA,SAIaF,EAAAA,SAAU,CAAAG,OAJvB;QAAA,MAKUL,EAAAA,WAAY,CAAAyC,KAAZ,IAAqBzC,YAAYyC,KAAZ,CAAkB,CAAlB,CAL/B;QAAA,OAMWhE,EAAAA,MAAM,CAAAuE,KANjB;QAAA,YAOgBvE,EAAAA,MAAAA,CAAMiF,UAPtB;AAAA,QAAA,UAAA,EAQcxB,gBARd;AAAA,QAAA,aAAA,EASiBb,eATjB;AAAA,QAAA,aAAA,EAUiBC,eAVjB;AAAA,QAAA,UAAA,EAWcW,YAXd;AAAA,QAAA,SAAA,EAYaD,aAZb;AAAA,QAAA,UAAA,EAacN,kBAbd;AAAA,QAAA,UAAA,EAccS,MAdd;AAAA,QAAA,QAAA,EAeY1D,MAAM,CAAAkF,MAAAA;OAEbd,EAAAA,OAAAA,CAAAA,cAjBL,IAiBKA,cAjBL,GAAA;AAAA,QAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,UAAA,OAAA,CAiBKA,cAjBL,CAAA,CAAA;AAAA,SAAA;AAAA,OAAA,CAAA,CAAA;KATF,CAAA;;AA+BM,IAAA,IAAAe,qBAAA,GAAwBC,SAAS,YAAM;AAAA,MAAA,IAAA,qBAAA,EAAA,qBAAA,EAAA,qBAAA,CAAA;;AAC3C,MAAA,IAAMC,kBAAkBrF,MAAM,CAAAkF,MAA9B,CAAA;MAEA,IAAII,aAAa9E,YAAa,CAAAwD,KAAb,CAAmBuB,iBAAnB,CAAqCC,SAArC,KAAkDH,eAAlD,KAAkDA,IAAAA,IAAAA,eAAlD,gDAAkDA,gBAAiBE,iBAAnE,MAAkD,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,qBAAA,CAAoCC,SAAtF,CAAjB,CAAA;;AACA,MAAA,IAAI,0BAAA/D,UAAUI,aAAV,MAAA,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,qBAAA,CAAyB6C,MAAzB,IAAkC,CAAlC,IAAuC,CAAA,CAAA,qBAAA,GAAAjD,SAAU,CAAAF,WAAV,gFAAuBmD,MAAvB,IAAgC,CAA3E,EAA8E;AAAA,QAAA,IAAA,sBAAA,CAAA;;AACxE1E,QAAAA,IAAAA,MAAAA,CAAMuE,KAANvE,KAAgB,YAAhBA,IAAiC,2BAAAyB,SAAA,CAAUF,WAAV,MAAA,IAAA,IAAA,sBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,sBAAA,CAAuBmD,MAAvB,IAAgC,CAAhC,IAAqCxD,eAAe8C,KAArFhE,EAA6F;AAAA,UAAA,IAAA,sBAAA,CAAA;;UAC/FsF,UAAA,GAAa,CAAAD,eAAiB,KAAA,IAAjB,IAAAA,eAAiB,KAAA,KAAA,CAAjB,sCAAAA,eAAiB,CAAAE,iBAAjB,MAAoCE,IAAAA,IAAAA,sBAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,sBAAAA,CAAAA,QAApC,KAAgDjF,YAAA,CAAawD,KAAb,CAAmBuB,iBAAnB,CAAqCE,QAAlG,CAAA;AACK,SAFHzF,MAEG;AAAA,UAAA,IAAA,sBAAA,CAAA;;UACLsF,UAAA,GACE,CAAAD,eAAiB,KAAA,IAAjB,IAAAA,eAAiB,KAAA,KAAA,CAAjB,sCAAAA,eAAiB,CAAAE,iBAAjB,MAAoCG,IAAAA,IAAAA,sBAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,sBAAAA,CAAAA,cAApC,KAAsDlF,YAAA,CAAawD,KAAb,CAAmBuB,iBAAnB,CAAqCG,cAD7F,CAAA;AAEF,SAAA;AACF,OAAA;;AACO,MAAA,OAAAJ,UAAA,CAAA;AACR,MAbK,CAAA;;AAeN,IAAA,IAAMK,gBAAgB,SAAhBA,aAAgB,GAAM;AAC1B,MAAA,IAAMC,oBAAoB,SAApBA,iBAAoB,GAAM;AAC9B,QAAA,IAAMP,kBAAkBrF,MAAM,CAAAkF,MAA9B,CAAA;;QAEA,IAAIlF,MAAM,CAAAuE,KAANvE,KAAgB,YAAhBA,IAAgCkC,cAAA,CAAe8B,KAAnD,EAA0D;AAAA,UAAA,IAAA,sBAAA,CAAA;;AAEtD,UAAA,OAAAD,WAAA,CAAA8B,gBAAA,CAAA,UAAA,CAAA,EAAA;YAAA,SAAkB,EAAA,SAAA;AAAlB,WAAA,EAAA;AAAA,YAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,cAAA,OAAA,CACG,CAAAR,eAAA,KAAA,IAAA,IAAAA,eAAA,KAAA,KAAA,CAAA,sCAAAA,eAAA,CAAiBE,iBAAjB,MAAoCC,IAAAA,IAAAA,sBAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,sBAAAA,CAAAA,SAApC,KAAiDhF,YAAa,CAAAwD,KAAb,CAAmBuB,iBAAnB,CAAqCC,SADzF,CAAA,CAAA;AAAA,aAAA;AAAA,WAAA,CAAA,CAAA;AAIJ,SAAA;;AACA,QAAA,IAAMM,WAAW;AAAEC,UAAAA,IAAA,EAAM,SAAA,IAAA,GAAA;AAAA,YAAA,OAAAhC,WAAA,CAAAnD,YAAA,EAAA,IAAA,EAAA,IAAA,CAAA,CAAA;AAAA,WAAA;SAAzB,CAAA;AAEE,QAAA,OAAAmD,WAAA,CAAAY,MAAA,EAAA;UAAA,SAAiB,EAAA,SAAA;AAAjB,SAAA,EAAA,aAAA,CAAA;AAAA,UAAA,SAAA,EAAA,SAAA,QAAA,GAAA;YAAA,OACGQ,CAAAA,qBAAA,CAAsBnB,KADzB,CAAA,CAAA;AAAA,WAAA;AAAA,SAAA,EAAoC8B,QAApC,CAAA,CAAA,CAAA;OAZJ,CAAA;;MAkBA,IAAME,cAAcJ,iBAAkB,EAAtC,CAAA;AACO,MAAA,OAAAzF,kBAAA,CAAmB,SAAnB,EAA8B,SAA9B,EAAyC6F,WAAzC,CAAA,CAAA;KApBT,CAAA;;AAwBM,IAAA,IAAAC,YAAA,GAAe,SAAfA,YAAe,CAAC7B,cAAD,EAA2B;AAC9C,MAAA,IAAIpE,OAAMuE,KAANvE,KAAgB,QAApB,EAA8B,OAAA;AAC9B,MAAA,OAAOA,MAAM,CAAAqE,SAANrE,GACL4E,oBAAqB,EADhB5E,GAAAA,WAAAA,CAAAA,KAAAA,EAAAA;QAAAA,OAGUS,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,WAAY,CAAAuD,KAHtBhE,EAAAA,WAAAA,CAAAA;QAAAA,SAGiDuD,EAAAA,aAAAA;AAHjDvD,OAAAA,EAAAA,CAIFoE,cAJEpE,CAAP,CAAA,CAAA;KAFI,CAAA;;IAWN,IAAMkG,gBAAgB,SAAhBA,aAAgB,GAAA;MAAA,OACpB,CAAClG,OAAMqE,SAAP,IACArE,MAAAA,CAAMuE,KAANvE,KAAgB,OADhB,IAAA+D,WAAA,CAAA,SAAA,EAAA;QAAA,OAGWxC,EAAAA,WAAA,CAAYyC,KAHvB;QAAA,aAIiBvC,EAAAA,SAAA,CAAUE,WAJ3B;QAAA,SAKaF,EAAAA,SAAA,CAAUG,OALvB;QAAA,oBAMwB5B,EAAAA,MAAAA,CAAMwE,kBAN9B;QAAA,aAOiBxE,EAAAA,OAAMyE,WAPvB;QAAA,UAQczE,EAAAA,OAAMiE,QARpB;QAAA,KASSjE,EAAAA,OAAMmG,GATf;QAAA,UAUcpE,EAAAA,SAASiC,KAVvB;AAAA,QAAA,SAAA,EAWaT,aAXb;AAAA,QAAA,UAAA,EAYcL,oBAZd;AAAA,QAAA,cAAA,EAakBT,gBAblB;AAAA,QAAA,QAAA,EAcYzC,OAAMkF,MAAAA;OAfE,EAAA,IAAA,CAAA,CAAA;KAAtB,CAAA;;AAmBM,IAAA,IAAAkB,cAAA,GAAiB,SAAjBA,cAAiB,CAAChC,cAAD,EAA2B;AAC5C,MAAA,IAAEG,KAAF,GAAYvE,MAAZ,CAAEuE,KAAF,CAAA;;AACJ,MAAA,IAAIvE,OAAMiE,QAANjE,IAAkBA,MAAAA,CAAMuE,KAANvE,KAAgB,MAAlCA,IAA4CA,OAAMqE,SAAtD,EAAiE;AACvDE,QAAAA,KAAA,GAAA,WAAA,CAAA;AACV,OAAA;;MAEE,OAAArC,cAAA,CAAe8B,KAAf,IAAAD,WAAA,CAAA,QAAA,EAAA;QAAA,OAEWxC,EAAAA,YAAYyC,KAFvB;QAAA,aAGiBhE,EAAAA,MAAM,CAAAyE,WAHvB;QAAA,YAIgBzE,EAAAA,MAAAA,CAAMiF,UAJtB;QAAA,eAKmBxD,EAAAA,SAAA,CAAUI,aAL7B;AAAA,QAAA,OAAA,EAMW0C,KANX;QAAA,aAOiB9C,EAAAA,SAAU,CAAAP,cAP3B;QAAA,oBAQwBlB,EAAAA,MAAAA,CAAMwE,kBAR9B;QAAA,0BAS8BxE,EAAAA,MAAM,CAAAqG,wBATpC;AAAA,QAAA,UAAA,EAUclD,gBAVd;AAAA,QAAA,UAAA,EAWcG,cAXd;AAAA,QAAA,UAAA,EAYcE,YAZd;AAAA,QAAA,cAAA,EAakBf,gBAblB;AAAA,QAAA,UAAA,EAccgB,gBAdd;AAAA,QAAA,aAAA,EAeiBb,eAfjB;AAAA,QAAA,aAAA,EAgBiBC,eAhBjB;AAAA,QAAA,QAAA,EAiBY7C,OAAMkF,MAAAA;AAjBlB,OAAA,EAAA;AAAA,QAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,UAAA,OAAA,CAAAnB,WAAA,CAAA,KAAA,EAAA;YAAA,OAmBmBtD,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,WAAA,CAAYuD,KAnB/B,EAAA,WAAA,CAAA;YAAA,SAmB0DT,EAAAA,aAAAA;AAnB1D,WAAA,EAAA,CAoBOa,cApBP,CAAA,CAAA,CAAA,CAAA;AAAA,SAAA;OAAA,CAAA,CAAA;KANE,CAAA;;IAiCA,IAAAkC,YAAA,GAAe,SAAfA,YAAe,GAAA;MAAA,OACnB,CAAC,OAAD,EAAU,YAAV,EAAwB,QAAxB,CAAA,CAAkChC,QAAlC,CAA2CtE,MAAM,CAAAuE,KAAjD,CAAA,IAAAR,WAAA,CAAAwC,MAAA,EAAA;QAAA,SAEa/D,EAAAA,mBAAoB,CAAAwB,KAFjC;AAAA,QAAA,aAAA,EAAA,IAAA;AAAA,QAAA,OAAA,EAIU,MAJV;AAAA,QAAA,KAAA,EAKQ,KALR;QAAA,OAMcvD,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,YAAYuD,KAN1B,EAAA,UAAA,CAAA;AAAA,QAAA,QAAA,EAOY,KAPZ;AAAA,QAAA,QAAA,EAQY,KARZ;QAAA,SASatB,EAAAA,sBAAAA;AATb,OAAA,EAAA;AAAA,QAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,UAAA,OAAA,CAAAqB,WAAA,CAAA,KAAA,EAAA;YAAA,OAWmBzD,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,MAAA,CAAO0D,KAX1B,EAAA,uBAAA,CAAA;AAAA,WAAA,EAAA,CAAAD,WAAA,CAAA,KAAA,EAAA;YAAA,KAYgBxB,EAAAA,gBAAiB,CAAAyB,KAZjC;YAAA,KAY4C,EAAA,EAAA;AAZ5C,WAAA,EAAA,IAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,SAAA;OADmB,CAAA,CAAA;KAAf,CAAA;;AAkBA,IAAA,IAAAwC,WAAA,GAAcpB,SAAS,YAAM;MACjC,OAAO,CAAA,EAAA,CAAA,MAAA,CAAI3E,WAAY,CAAAuD,KAAhB,oBAA+B1D,OAAO0D,KAAtC,EAAP,SAAA,CAAA,CAAA,CAAA;AACD,MAFK,CAAA;AAGA,IAAA,IAAAyC,YAAA,GAAerB,SAAS,YAAM;MAClC,OAAOoB,WAAY,CAAAxC,KAAZ,CAAkB0C,MAAlB,CAA4BjG,EAAAA,CAAAA,MAAAA,CAAAA,YAAYuD,KAAxC,EAAP,cAAA,CAAA,CAAA,CAAA;AACD,MAFK,CAAA;AAIN,IAAA,OAAO,YAAM;MACX,IAAMI,iBAAiBuB,aAAc,EAArC,CAAA;AACA,MAAA,OAAA5B,WAAA,CAAA,KAAA,EAAA;QAAA,OACiBtD,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,WAAY,CAAAuD,KAD7B,CAAA;AAAA,OAAA,EAAA,CAEKF,WAAY,EAFjB,EAGKmC,aAAa7B,eAHlB,EAIKD,oBAAoBC,eAJzB,EAKK/B,eAAA,CAAgB2B,KAAhB,IAAyBY,oBAAqB,EALnD,EAMKsB,aAAc,EANnB,EAOKE,eAAehC,eAPpB,EAQKkC,YAAa,EARlB,EASK,CAAC7E,SAAA,CAAUK,QAAX,IAAuBK,QAAA,CAAS6B,KAAhC,IAAAD,WAAA,CAAA,OAAA,EAAA;AAAA,QAAA,OAAA,EAAuDyC,WAAY,CAAAxC,KAAAA;AAAnE,OAAA,EAAA,CAA2EhE,MAAM,CAAA2G,IAAjF,EATL,EAUKvE,YAAA,CAAa4B,KAAb,IAAAD,WAAA,CAAA,OAAA,EAAA;AAAA,QAAA,OAAA,EAAoC0C,YAAa,CAAAzC,KAAAA;OAAQvC,EAAAA,CAAAA,SAAU,CAAAK,QAAnE,CAVL,CAAA,CAAA,CAAA,CAAA;KAFF,CAAA;AAgBF,GAAA;AAvR6B,CAAA,CAA/B;;;;"}