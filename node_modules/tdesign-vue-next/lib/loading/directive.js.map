{"version":3,"file":"directive.js","sources":["../../src/loading/directive.ts"],"sourcesContent":["import type { Directive, DirectiveBinding } from 'vue';\nimport { TdLoadingProps } from './type';\nimport produceLoading from './plugin';\n\nconst INSTANCE_KEY = Symbol('TdLoading');\n\nconst createInstance = (el: HTMLElement, binding: DirectiveBinding) => {\n  const { fullscreen, inheritColor } = binding.modifiers;\n  const options: TdLoadingProps = {\n    attach: () => el,\n    fullscreen: fullscreen ?? false,\n    inheritColor: inheritColor ?? false,\n    loading: binding.value,\n  };\n\n  el[INSTANCE_KEY] = {\n    options,\n    instance: produceLoading(options),\n  };\n};\n\nexport const vLoading: Directive = {\n  mounted(el, binding) {\n    if (binding.value) {\n      createInstance(el, binding);\n    }\n  },\n  updated(el, binding) {\n    const instance = el[INSTANCE_KEY];\n    const { value, oldValue } = binding;\n    if (!!oldValue !== !!value) {\n      if (value) {\n        createInstance(el, binding);\n      } else {\n        instance?.instance.hide();\n      }\n    }\n  },\n  unmounted(el) {\n    el[INSTANCE_KEY]?.instance.hide();\n  },\n};\n"],"names":["INSTANCE_KEY","Symbol","createInstance","el","binding","modifiers","fullscreen","inheritColor","options","attach","loading","value","instance","produceLoading","vLoading","mounted","updated","oldValue","hide","unmounted"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,IAAMA,YAAA,GAAeC,OAAO,YAA5B,CAAA;;AAEA,IAAMC,cAAA,GAAiB,SAAjBA,cAAiB,CAACC,EAAD,EAAkBC,OAAlB,EAAgD;EACrE,IAAqCA,kBAAAA,GAAAA,OAAQ,CAAAC,SAA7C;MAAQC,UAAR,sBAAQA,UAAR;MAAoBC,YAApB,sBAAoBA,YAApB,CAAA;AACA,EAAA,IAAMC,OAA0B,GAAA;AAC9BC,IAAAA,QAAQ,SAAA,MAAA,GAAA;AAAA,MAAA,OAAMN,EAAN,CAAA;KADsB;AAE9BG,IAAAA,YAAYA,uBAAAA,eAAAA,KAAAA,CAAAA,GAAAA,aAAc,KAFI;AAG9BC,IAAAA,cAAcA,yBAAAA,iBAAAA,KAAAA,CAAAA,GAAAA,eAAgB,KAHA;IAI9BG,SAASN,OAAQ,CAAAO,KAAAA;GAJnB,CAAA;EAOAR,EAAA,CAAGH,YAAH,CAAA,GAAmB;AACjBQ,IAAAA,OAAA,EAAAA,OADiB;IAEjBI,QAAA,EAAUC,cAAeL;GAF3B,CAAA;AAIF,CAbA,CAAA;;AAeO,IAAMM,QAAsB,GAAA;AACjCC,EAAAA,OADiC,EACzBZ,SAAAA,OAAAA,CAAAA,EADyB,EACrBC,OADqB,EACZ;IACnB,IAAIA,QAAQO,KAAZ,EAAmB;AACjBT,MAAAA,cAAA,CAAeC,EAAf,EAAmBC,OAAnB,CAAA,CAAA;AACF,KAAA;GAJ+B;AAMjCY,EAAAA,OANiC,EAMzBb,SAAAA,OAAAA,CAAAA,EANyB,EAMrBC,OANqB,EAMZ;AACnB,IAAA,IAAMQ,WAAWT,EAAG,CAAAH,YAAA,CAApB,CAAA;AACM,IAAA,IAAEW,KAAF,GAAsBP,OAAtB,CAAEO,KAAF;AAAA,QAASM,QAAT,GAAsBb,OAAtB,CAASa,QAAT,CAAA;;AACN,IAAA,IAAI,CAAC,CAACA,QAAF,KAAe,CAAC,CAACN,KAArB,EAA4B;AAC1B,MAAA,IAAIA,KAAJ,EAAW;AACTT,QAAAA,cAAA,CAAeC,EAAf,EAAmBC,OAAnB,CAAA,CAAA;AACK,OAFP,MAEO;QACLQ,QAAA,KAAA,IAAA,IAAAA,QAAA,KAAA,KAAA,CAAA,YAAAA,QAAA,CAAUA,QAAV,CAAmBM,IAAnB,EAAA,CAAA;AACF,OAAA;AACF,KAAA;GAf+B;EAiBjCC,SAjBiC,EAAA,SAAA,SAAA,CAiBvBhB,EAjBuB,EAiBnB;AAAA,IAAA,IAAA,gBAAA,CAAA;;AACT,IAAA,CAAA,gBAAA,GAAAA,EAAA,CAAAH,YAAA,CAAA,MAAeY,IAAAA,IAAAA,gBAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,gBAAAA,CAAAA,QAAf,CAAwBM,IAAxB,EAAA,CAAA;AACL,GAAA;AAnBiC;;;;"}