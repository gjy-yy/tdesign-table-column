{"version":3,"file":"inputs.js","sources":["../../../../src/color-picker/panel/format/inputs.tsx"],"sourcesContent":["import { computed, defineComponent, PropType, reactive, watch } from 'vue';\nimport throttle from 'lodash/throttle';\nimport props from '../../props';\nimport { Color } from '../../utils';\nimport TInput from '../../../input';\nimport TInputNumber from '../../../input-number';\nimport { FORMAT_INPUT_CONFIG } from './config';\n\nexport default defineComponent({\n  name: 'FormatInputs',\n  inheritAttrs: false,\n  props: {\n    ...props,\n    color: {\n      type: Object as PropType<Color>,\n    },\n    onInputChange: {\n      type: Function,\n      default: () => {\n        return () => {};\n      },\n    },\n  },\n  setup(props) {\n    const inputConfigs = computed(() => {\n      const configs = [...FORMAT_INPUT_CONFIG[props.format]];\n      if (props.enableAlpha) {\n        configs.push({\n          type: 'inputNumber',\n          key: 'a',\n          min: 0,\n          max: 100,\n          format: (value: number) => `${value}%`,\n          flex: 1.15,\n        });\n      }\n      return configs;\n    });\n\n    const modelValue = reactive<any>({});\n    const lastModelValue = reactive<any>({});\n\n    /**\n     * 获取不同格式的输入输出值\n     * @param type 'encode' | 'decode'\n     * @returns\n     */\n    const getFormatColorMap = (type: 'encode' | 'decode') => {\n      const { color } = props;\n      if (type === 'encode') {\n        return {\n          HSV: color.getHsva(),\n          HSL: color.getHsla(),\n          RGB: color.getRgba(),\n          CMYK: color.getCmyk(),\n          CSS: {\n            css: color.css,\n          },\n          HEX: {\n            hex: color.hex,\n          },\n        };\n      }\n      // decode\n      return {\n        HSV: Color.object2color(modelValue, 'HSV'),\n        HSL: Color.object2color(modelValue, 'HSL'),\n        RGB: Color.object2color(modelValue, 'RGB'),\n        CMYK: Color.object2color(modelValue, 'CMYK'),\n        CSS: modelValue.css,\n        HEX: modelValue.hex,\n      };\n    };\n\n    // 更新modelValue\n    const updateModelValue = () => {\n      const { format, color } = props;\n      const values: any = getFormatColorMap('encode')[format];\n      values.a = Math.round(color.alpha * 100);\n      Object.keys(values).forEach((key) => {\n        modelValue[key] = values[key];\n        lastModelValue[key] = values[key];\n      });\n    };\n\n    updateModelValue();\n\n    const throttleUpdate = throttle(updateModelValue, 100);\n\n    watch(() => {\n      const { saturation, hue, value, alpha } = props.color;\n      return [saturation, hue, value, alpha, props.format];\n    }, throttleUpdate);\n\n    const handleChange = (key: string, v: number | string) => {\n      if (v === lastModelValue[key]) {\n        return;\n      }\n      const value = getFormatColorMap('decode')[props.format];\n      props.onInputChange(value, modelValue.a / 100, key, v);\n    };\n\n    return {\n      modelValue,\n      inputConfigs,\n      handleChange,\n    };\n  },\n  render() {\n    const inputProps = {\n      ...((this.inputProps as any) || {}),\n    };\n    return (\n      <div class=\"input-group\">\n        {this.inputConfigs.map((config) => {\n          return (\n            <div\n              class=\"input-group__item\"\n              key={config.key}\n              style={{\n                flex: config.flex || 1,\n              }}\n            >\n              {config.type === 'input' ? (\n                <TInput\n                  {...inputProps}\n                  align=\"center\"\n                  size=\"small\"\n                  disabled={this.disabled}\n                  v-model={this.modelValue[config.key]}\n                  maxlength={this.format === 'HEX' ? 9 : undefined}\n                  title={this.modelValue[config.key]}\n                  onBlur={(v: string) => this.handleChange(config.key, v)}\n                  onEnter={(v: string) => this.handleChange(config.key, v)}\n                />\n              ) : (\n                <TInputNumber\n                  {...inputProps}\n                  align=\"center\"\n                  size=\"small\"\n                  disabled={this.disabled}\n                  v-model={this.modelValue[config.key]}\n                  title={this.modelValue[config.key]}\n                  min={config.min}\n                  max={config.max}\n                  step={1}\n                  format={config.format}\n                  theme=\"normal\"\n                  onBlur={(v: number) => this.handleChange(config.key, v)}\n                  onEnter={(v: number) => this.handleChange(config.key, v)}\n                />\n              )}\n            </div>\n          );\n        })}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","inheritAttrs","props","color","type","Object","onInputChange","Function","setup","inputConfigs","computed","configs","FORMAT_INPUT_CONFIG","format","enableAlpha","push","key","min","max","value","flex","modelValue","reactive","lastModelValue","getFormatColorMap","HSV","getHsva","HSL","getHsla","RGB","getRgba","CMYK","getCmyk","CSS","css","HEX","hex","Color","object2color","updateModelValue","values","a","Math","round","alpha","keys","forEach","throttleUpdate","throttle","watch","saturation","hue","handleChange","v","render","inputProps","_createVNode","map","config","disabled","TInputNumber","_mergeProps"],"mappings":"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"}