{"version":3,"file":"useAffix.js","sources":["../../../src/table/hooks/useAffix.ts"],"sourcesContent":["import { computed, ref, watch, onBeforeMount } from 'vue';\nimport { TdBaseTableProps } from '../type';\nimport { on, off } from '../../utils/dom';\nimport { AffixProps } from '../../affix';\n\n/**\n * 1. 表头吸顶（普通表头吸顶 和 虚拟滚动表头吸顶）\n * 2. 表尾吸底\n * 3. 底部滚动条吸底\n * 4. 分页器吸底\n */\nexport default function useAffix(props: TdBaseTableProps) {\n  const tableContentRef = ref<HTMLDivElement>();\n  // 吸顶表头\n  const affixHeaderRef = ref<HTMLDivElement>();\n  // 吸底表尾\n  const affixFooterRef = ref<HTMLDivElement>();\n  // 吸底滚动条\n  const horizontalScrollbarRef = ref<HTMLDivElement>();\n  // 吸底分页器\n  const paginationRef = ref<HTMLDivElement>();\n  // 当表格完全滚动消失在视野时，需要隐藏吸顶表头\n  const showAffixHeader = ref(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底尾部\n  const showAffixFooter = ref(true);\n  // 当表格完全滚动消失在视野时，需要隐藏吸底分页器\n  const showAffixPagination = ref(true);\n\n  const isVirtualScroll = computed(\n    () => props.scroll && props.scroll.type === 'virtual' && (props.scroll.threshold || 100) < props.data.length,\n  );\n\n  const isAffixed = computed(\n    () => !!(props.headerAffixedTop || props.footerAffixedBottom || props.horizontalScrollAffixedBottom),\n  );\n\n  let lastScrollLeft = 0;\n  const onHorizontalScroll = (scrollElement?: HTMLElement) => {\n    if (!isAffixed.value && !isVirtualScroll.value) return;\n    let target = scrollElement;\n    if (!target && tableContentRef.value) {\n      lastScrollLeft = 0;\n      target = tableContentRef.value;\n    }\n    if (!target) return;\n    const left = target.scrollLeft;\n    // 如果 lastScrollLeft 等于 left，说明不是横向滚动，不需要更新横向滚动距离\n    if (lastScrollLeft === left) return;\n    lastScrollLeft = left;\n    // 表格内容、吸顶表头、吸底表尾、吸底横向滚动更新\n    const toUpdateScrollElement = [\n      tableContentRef.value,\n      affixHeaderRef.value,\n      affixFooterRef.value,\n      horizontalScrollbarRef.value,\n    ];\n    for (let i = 0, len = toUpdateScrollElement.length; i < len; i++) {\n      if (toUpdateScrollElement[i] && scrollElement !== toUpdateScrollElement[i]) {\n        toUpdateScrollElement[i].scrollLeft = left;\n      }\n    }\n  };\n\n  // 吸底的元素（footer、横向滚动条、分页器）是否显示\n  const isAffixedBottomElementShow = (elementRect: DOMRect, tableRect: DOMRect, headerHeight: number) =>\n    tableRect.top + headerHeight < elementRect.top && elementRect.top > elementRect.height;\n\n  const getOffsetTop = (props: boolean | AffixProps) => {\n    if (typeof props === 'boolean') return 0;\n    return props.offsetTop || 0;\n  };\n\n  const updateAffixHeaderOrFooter = () => {\n    if (!isAffixed.value && !isVirtualScroll.value) return;\n    const pos = tableContentRef.value?.getBoundingClientRect();\n    const headerRect = tableContentRef.value?.querySelector('thead')?.getBoundingClientRect();\n    const headerHeight = headerRect.height || 0;\n    const footerRect = affixFooterRef.value?.getBoundingClientRect();\n    if ((props.headerAffixedTop || isVirtualScroll.value) && affixHeaderRef.value) {\n      const offsetTop = getOffsetTop(props.headerAffixProps || props.headerAffixedTop);\n      const footerHeight = footerRect?.height || 0;\n      let r = Math.abs(pos.top) < pos.height - headerHeight - offsetTop - footerHeight;\n      // 如果是虚拟滚动的表头，只要表头在可视区域内，一律永久显示（虚拟滚动表头 和 吸顶表头可能同时存在）\n      if (isVirtualScroll.value) {\n        r = pos.top > -1 * headerRect.height;\n      }\n      showAffixHeader.value = r;\n    }\n    // 底部内容吸底 和 底部滚动条吸底，不可能同时存在，二选一即可\n    if (props.footerAffixedBottom && affixFooterRef?.value) {\n      showAffixFooter.value = isAffixedBottomElementShow(footerRect, pos, headerHeight);\n    } else if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef?.value) {\n      const horizontalScrollbarRect = horizontalScrollbarRef.value.getBoundingClientRect();\n      showAffixFooter.value = isAffixedBottomElementShow(horizontalScrollbarRect, pos, headerHeight);\n    }\n    if (props.paginationAffixedBottom && paginationRef.value) {\n      const pageRect = paginationRef.value.getBoundingClientRect();\n      showAffixPagination.value = isAffixedBottomElementShow(pageRect, pos, headerHeight);\n    }\n  };\n\n  const onDocumentScroll = () => {\n    updateAffixHeaderOrFooter();\n  };\n\n  const onFootScroll = () => {\n    onHorizontalScroll(affixFooterRef.value);\n  };\n\n  const onHeaderScroll = () => {\n    onHorizontalScroll(affixHeaderRef.value);\n  };\n\n  const horizontalScrollbarScroll = () => {\n    onHorizontalScroll(horizontalScrollbarRef.value);\n  };\n\n  const onTableContentScroll = () => {\n    onHorizontalScroll(tableContentRef.value);\n  };\n\n  const onFootMouseEnter = () => {\n    on(affixFooterRef.value, 'scroll', onFootScroll);\n  };\n\n  const onFootMouseLeave = () => {\n    off(affixFooterRef.value, 'scroll', onFootScroll);\n  };\n\n  const onHeaderMouseEnter = () => {\n    on(affixHeaderRef.value, 'scroll', onHeaderScroll);\n  };\n\n  const onHeaderMouseLeave = () => {\n    off(affixHeaderRef.value, 'scroll', onHeaderScroll);\n  };\n\n  const onScrollbarMouseEnter = () => {\n    on(horizontalScrollbarRef.value, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onScrollbarMouseLeave = () => {\n    off(horizontalScrollbarRef.value, 'scroll', horizontalScrollbarScroll);\n  };\n\n  const onTableContentMouseEnter = () => {\n    on(tableContentRef.value, 'scroll', onTableContentScroll);\n  };\n\n  const onTableContentMouseLeave = () => {\n    off(tableContentRef.value, 'scroll', onTableContentScroll);\n  };\n\n  const addHorizontalScrollListeners = () => {\n    if (affixHeaderRef.value) {\n      on(affixHeaderRef.value, 'mouseenter', onHeaderMouseEnter);\n      on(affixHeaderRef.value, 'mouseleave', onHeaderMouseLeave);\n    }\n\n    if (props.footerAffixedBottom && affixFooterRef.value) {\n      on(affixFooterRef.value, 'mouseenter', onFootMouseEnter);\n      on(affixFooterRef.value, 'mouseleave', onFootMouseLeave);\n    }\n\n    if (props.horizontalScrollAffixedBottom && horizontalScrollbarRef.value) {\n      on(horizontalScrollbarRef.value, 'mouseenter', onScrollbarMouseEnter);\n      on(horizontalScrollbarRef.value, 'mouseleave', onScrollbarMouseLeave);\n    }\n\n    if ((isAffixed.value || isVirtualScroll.value) && tableContentRef.value) {\n      on(tableContentRef.value, 'mouseenter', onTableContentMouseEnter);\n      on(tableContentRef.value, 'mouseleave', onTableContentMouseLeave);\n    }\n  };\n\n  const removeHorizontalScrollListeners = () => {\n    if (affixHeaderRef.value) {\n      off(affixHeaderRef.value, 'mouseenter', onHeaderMouseEnter);\n      off(affixHeaderRef.value, 'mouseleave', onHeaderMouseLeave);\n    }\n    if (affixFooterRef.value) {\n      off(affixFooterRef.value, 'mouseenter', onFootMouseEnter);\n      off(affixFooterRef.value, 'mouseleave', onFootMouseLeave);\n    }\n    if (tableContentRef.value) {\n      off(tableContentRef.value, 'mouseenter', onTableContentMouseEnter);\n      off(tableContentRef.value, 'mouseleave', onTableContentMouseLeave);\n    }\n    if (horizontalScrollbarRef.value) {\n      off(horizontalScrollbarRef.value, 'mouseenter', onScrollbarMouseEnter);\n      off(horizontalScrollbarRef.value, 'mouseleave', onScrollbarMouseLeave);\n    }\n  };\n\n  const addVerticalScrollListener = () => {\n    if (!isAffixed.value && !props.paginationAffixedBottom) return;\n    const timer = setTimeout(() => {\n      if (isAffixed.value || props.paginationAffixedBottom) {\n        on(document, 'scroll', onDocumentScroll);\n      } else {\n        off(document, 'scroll', onDocumentScroll);\n      }\n      clearTimeout(timer);\n    });\n  };\n\n  watch([affixHeaderRef, affixFooterRef, horizontalScrollbarRef, tableContentRef], () => {\n    addHorizontalScrollListeners();\n    onHorizontalScroll();\n    updateAffixHeaderOrFooter();\n  });\n\n  watch(isAffixed, addVerticalScrollListener);\n\n  watch(\n    () => [\n      props.data,\n      props.columns,\n      props.headerAffixedTop,\n      props.footerAffixedBottom,\n      props.horizontalScrollAffixedBottom,\n    ],\n    () => {\n      onHorizontalScroll();\n    },\n  );\n\n  onBeforeMount(() => {\n    off(document, 'scroll', onDocumentScroll);\n    removeHorizontalScrollListeners();\n  });\n\n  const setTableContentRef = (tableContent: HTMLDivElement) => {\n    tableContentRef.value = tableContent;\n    addVerticalScrollListener();\n  };\n\n  return {\n    showAffixHeader,\n    showAffixFooter,\n    showAffixPagination,\n    affixHeaderRef,\n    affixFooterRef,\n    horizontalScrollbarRef,\n    paginationRef,\n    onHorizontalScroll,\n    setTableContentRef,\n    updateAffixHeaderOrFooter,\n  };\n}\n"],"names":["useAffix","props","tableContentRef","ref","affixHeaderRef","affixFooterRef","horizontalScrollbarRef","paginationRef","showAffixHeader","showAffixFooter","showAffixPagination","isVirtualScroll","computed","scroll","type","threshold","data","length","isAffixed","headerAffixedTop","footerAffixedBottom","horizontalScrollAffixedBottom","lastScrollLeft","onHorizontalScroll","scrollElement","value","target","left","scrollLeft","toUpdateScrollElement","i","len","isAffixedBottomElementShow","elementRect","tableRect","headerHeight","top","height","getOffsetTop","offsetTop","updateAffixHeaderOrFooter","pos","getBoundingClientRect","headerRect","querySelector","footerRect","headerAffixProps","footerHeight","r","Math","abs","horizontalScrollbarRect","paginationAffixedBottom","pageRect","onDocumentScroll","onFootScroll","onHeaderScroll","horizontalScrollbarScroll","onTableContentScroll","onFootMouseEnter","on","onFootMouseLeave","off","onHeaderMouseEnter","onHeaderMouseLeave","onScrollbarMouseEnter","onScrollbarMouseLeave","onTableContentMouseEnter","onTableContentMouseLeave","addHorizontalScrollListeners","removeHorizontalScrollListeners","addVerticalScrollListener","timer","setTimeout","document","clearTimeout","watch","columns","onBeforeMount","setTableContentRef","tableContent"],"mappings":"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"}