{"version":3,"file":"collapse-panel.js","sources":["../../src/collapse/collapse-panel.tsx"],"sourcesContent":["import { defineComponent, ref, computed, inject, Ref, toRefs, Transition } from 'vue';\nimport props from './collapse-panel-props';\nimport FakeArrow from '../common-components/fake-arrow';\nimport { CollapseValue, TdCollapsePanelProps } from './type';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport useCollapseAnimation from './useCollapseAnimation';\n\nexport default defineComponent({\n  name: 'TCollapsePanel',\n  props,\n  setup(props: TdCollapsePanelProps) {\n    const renderTNodeJSX = useTNodeJSX();\n    const componentName = usePrefixClass('collapse-panel');\n    const disableClass = usePrefixClass('is-disabled');\n    const clickableClass = usePrefixClass('is-clickable');\n    const transitionClass = usePrefixClass('slide-down');\n    const { value, disabled, destroyOnCollapse, expandIcon } = toRefs(props);\n    const collapseValue: Ref<CollapseValue> = inject('collapseValue');\n    const updateCollapseValue: Function = inject('updateCollapseValue');\n    const getUniqId: Function = inject('getUniqId', () => undefined, false);\n    const {\n      defaultExpandAll,\n      disabled: disableAll,\n      expandIconPlacement,\n      expandOnRowClick,\n      expandIcon: expandIconAll,\n    } = inject<any>('collapseProps');\n    const innerValue = value.value || getUniqId();\n    const showExpandIcon = computed(() => (expandIcon.value === undefined ? expandIconAll.value : expandIcon.value));\n    if (defaultExpandAll.value) {\n      updateCollapseValue(innerValue);\n    }\n    const { beforeEnter, enter, afterEnter, beforeLeave, leave, afterLeave } = useCollapseAnimation();\n    const headRef = ref<HTMLElement>();\n    const isDisabled = computed(() => disabled.value || disableAll.value);\n    const isActive = computed(() =>\n      collapseValue.value instanceof Array\n        ? collapseValue.value.includes(innerValue)\n        : collapseValue.value === innerValue,\n    );\n    const classes = computed(() => {\n      return [componentName.value, { [disableClass.value]: isDisabled.value }];\n    });\n    const handleClick = (e: MouseEvent) => {\n      const canExpand =\n        (expandOnRowClick.value && e.target === headRef.value) ||\n        (e.target as Element).getAttribute('name') === 'arrow';\n      if (canExpand && !isDisabled.value) {\n        updateCollapseValue(innerValue);\n      }\n    };\n    const renderIcon = (direction: string) => {\n      return (\n        <FakeArrow\n          name=\"arrow\"\n          isActive={isActive.value}\n          overlayClassName={`${componentName.value}__icon ${componentName.value}__icon--${direction}`}\n        />\n      );\n    };\n    const renderBlank = () => {\n      return <div class={`${componentName.value}__header--blank`}></div>;\n    };\n    const renderHeader = () => {\n      const cls = [\n        `${componentName.value}__header`,\n        {\n          [clickableClass.value]: expandOnRowClick.value && !isDisabled.value,\n        },\n      ];\n      return (\n        <div ref={headRef} class={cls} onClick={handleClick}>\n          {showExpandIcon.value && expandIconPlacement.value === 'left' ? renderIcon(expandIconPlacement.value) : null}\n          {renderTNodeJSX('header')}\n          {renderBlank()}\n          {renderTNodeJSX('headerRightContent')}\n          {showExpandIcon.value && expandIconPlacement.value === 'right' ? renderIcon(expandIconPlacement.value) : null}\n        </div>\n      );\n    };\n    const renderBodyByNormal = () => {\n      return (\n        <div v-show={isActive.value} class={`${componentName.value}__body`}>\n          <div class={`${componentName.value}__content`}>{renderTNodeJSX('default')}</div>\n        </div>\n      );\n    };\n    const renderBodyDestroyOnCollapse = () => {\n      return isActive.value ? (\n        <div class={`${componentName.value}__body`}>\n          <div class={`${componentName.value}__content`}>{renderTNodeJSX('default')}</div>\n        </div>\n      ) : null;\n    };\n    const renderBody = () => {\n      return destroyOnCollapse.value ? renderBodyDestroyOnCollapse() : renderBodyByNormal();\n    };\n    return () => {\n      return (\n        <div class={classes.value}>\n          <div class={`${componentName.value}__wrapper`}>\n            {renderHeader()}\n            <Transition\n              name={transitionClass.value}\n              onBeforeEnter={beforeEnter}\n              onEnter={enter}\n              onAfterEnter={afterEnter}\n              onBeforeLeave={beforeLeave}\n              onLeave={leave}\n              onAfterLeave={afterLeave}\n            >\n              {renderBody()}\n            </Transition>\n          </div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","renderTNodeJSX","useTNodeJSX","componentName","usePrefixClass","disableClass","clickableClass","transitionClass","toRefs","value","disabled","destroyOnCollapse","expandIcon","collapseValue","inject","updateCollapseValue","getUniqId","defaultExpandAll","disableAll","expandIconPlacement","expandOnRowClick","expandIconAll","innerValue","showExpandIcon","computed","useCollapseAnimation","beforeEnter","enter","afterEnter","beforeLeave","leave","afterLeave","headRef","ref","isDisabled","isActive","Array","includes","classes","handleClick","e","canExpand","target","getAttribute","renderIcon","direction","_createVNode","renderBlank","renderHeader","cls","renderBodyByNormal","_withDirectives","renderBodyDestroyOnCollapse","renderBody"],"mappings":"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"}