{"version":3,"file":"menu-item.mjs","sources":["../../src/menu/menu-item.tsx"],"sourcesContent":["import { defineComponent, computed, inject, onMounted, ref } from 'vue';\nimport props from './menu-item-props';\nimport { TdMenuInterface, TdSubMenuInterface } from './const';\nimport { renderContent, renderTNodeJSX } from '../utils/render-tnode';\nimport { emitEvent } from '../utils/event';\nimport useRipple from '../hooks/useRipple';\nimport { usePrefixClass } from '../hooks/useConfig';\n\nexport default defineComponent({\n  name: 'TMenuItem',\n  props: { ...props },\n  emits: ['click'],\n  setup(props, ctx) {\n    const classPrefix = usePrefixClass();\n    const menu = inject<TdMenuInterface>('TdMenu');\n    const itemRef = ref<HTMLElement>();\n    useRipple(itemRef);\n    const submenu = inject<TdSubMenuInterface>('TdSubmenu', null);\n    const active = computed(() => menu.activeValue.value === props.value);\n    const classes = computed(() => [\n      `${classPrefix.value}-menu__item`,\n      {\n        [`${classPrefix.value}-is-active`]: active.value,\n        [`${classPrefix.value}-is-disabled`]: props.disabled,\n        [`${classPrefix.value}-menu__item--plain`]: !ctx.slots.icon && !props.icon,\n        [`${classPrefix.value}-submenu__item`]: !!submenu && !menu.isHead,\n      },\n    ]);\n\n    // lifetimes\n    onMounted(() => {\n      menu?.vMenu?.add({ value: props.value, parent: submenu?.value, vnode: ctx.slots.default });\n    });\n\n    return {\n      classPrefix,\n      menu,\n      active,\n      classes,\n      itemRef,\n    };\n  },\n  methods: {\n    handleClick() {\n      if (this.disabled) return;\n      this.menu.select(this.value);\n      emitEvent(this, 'click');\n      if (this.href) {\n        window.open(this.href, this.target);\n      } else if (this.to) {\n        const router = this.router || this.$router;\n        const methods: string = this.replace ? 'replace' : 'push';\n        router[methods](this.to).catch((err: Error) => {\n          // vue-router 3.1.0+ push/replace cause NavigationDuplicated error\n          // https://github.com/vuejs/vue-router/issues/2872\n          // 当前path和目标path相同时，会抛出NavigationDuplicated的错误\n          if (\n            err.name !== 'NavigationDuplicated' &&\n            !err.message.includes('Avoided redundant navigation to current location')\n          ) {\n            throw err;\n          }\n        });\n      }\n    },\n  },\n  render() {\n    return (\n      <li ref=\"itemRef\" class={this.classes} onClick={this.handleClick}>\n        {renderTNodeJSX(this, 'icon')}\n        <span class={[`${this.classPrefix}-menu__content`]}>{renderContent(this, 'default', 'content')}</span>\n      </li>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","emits","setup","ctx","classPrefix","usePrefixClass","menu","inject","itemRef","ref","useRipple","submenu","active","computed","activeValue","value","classes","disabled","slots","icon","isHead","onMounted","vMenu","add","parent","vnode","methods","handleClick","select","emitEvent","href","window","open","target","to","router","$router","replace","err","message","includes","render","_createVNode","renderTNodeJSX","renderContent"],"mappings":"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"}