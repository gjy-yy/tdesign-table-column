{"version":3,"file":"anchor.mjs","sources":["../../src/anchor/anchor.tsx"],"sourcesContent":["import {\n  defineComponent,\n  nextTick,\n  ComponentPublicInstance,\n  ref,\n  reactive,\n  onMounted,\n  onUnmounted,\n  watchEffect,\n  provide,\n} from 'vue';\nimport { ANCHOR_SHARP_REGEXP, ANCHOR_CONTAINER, getOffsetTop } from './utils';\nimport { isServer, on, off, getScroll, scrollTo, getScrollContainer as utilsGetScrollContainer } from '../utils/dom';\nimport props from './props';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport { SlotReturnValue } from '../common';\nimport Affix from '../affix';\nimport { TdAnchorProps } from './type';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport { AnchorInjectionKey } from './constants';\n\nexport interface Anchor extends ComponentPublicInstance {\n  scrollContainer: ANCHOR_CONTAINER;\n  // 执行scrollTo设置的flag, 用来禁止执行handleScroll\n  handleScrollLock: boolean;\n}\n\nexport default defineComponent({\n  name: 'TAnchor',\n  props,\n  setup(props: TdAnchorProps, { attrs }) {\n    const anchorRef = ref<HTMLElement | null>(null);\n    const links = ref<string[]>([]);\n    const active = ref('');\n    const scrollContainer = ref<ANCHOR_CONTAINER>(null);\n    const handleScrollLock = ref<boolean>(false);\n    const activeLineStyle = reactive({});\n    const COMPONENT_NAME = usePrefixClass('anchor');\n    const ANCHOR_LINE_CLASSNAME = usePrefixClass('anchor__line');\n    const ANCHOR_LINE_CURSOR_CLASSNAME = usePrefixClass('anchor__line-cursor');\n    const { STATUS, SIZE } = useCommonClassName();\n    const renderTNodeJSX = useTNodeJSX();\n    /**\n     * 获取滚动容器\n     * 1. 如果是string则通过id获取\n     * 2. 如果是method则获取方法返回值\n     */\n    const getScrollContainer = () => {\n      if (isServer) {\n        return;\n      }\n      const { container } = props;\n      scrollContainer.value = utilsGetScrollContainer(container) as HTMLElement;\n      on(scrollContainer.value, 'scroll', handleScroll);\n      handleScroll();\n    };\n    /**\n     * 监听滚动事件\n     */\n    const handleScroll = () => {\n      if (handleScrollLock.value) return;\n      const { bounds, targetOffset } = props;\n      const filters: { top: number; link: string }[] = [];\n      let active = '';\n      // 找出所有当前top小于预设值\n      links.value.forEach((link) => {\n        const anchor = getAnchorTarget(link);\n        if (!anchor) {\n          return;\n        }\n        const top = getOffsetTop(anchor, scrollContainer.value);\n        if (top < bounds + targetOffset) {\n          filters.push({\n            link,\n            top,\n          });\n        }\n      });\n      // 找出小于预设值集合中top最大的\n      if (filters.length) {\n        const latest = filters.reduce((prev, cur) => (prev.top > cur.top ? prev : cur));\n        active = latest.link;\n      }\n      setCurrentActiveLink(active);\n    };\n    /**\n     * 获取锚点对应的target元素\n     *\n     * @param {string} link\n     */\n    const getAnchorTarget = (link: string): HTMLElement => {\n      const matcher = link.match(ANCHOR_SHARP_REGEXP);\n      if (!matcher) {\n        return;\n      }\n      const anchor = document.getElementById(matcher[1]);\n      if (!anchor) {\n        return;\n      }\n      return anchor;\n    };\n    /**\n     * 注册锚点\n     *\n     * @param {string} link\n     */\n    const registerLink = (link: string) => {\n      if (!ANCHOR_SHARP_REGEXP.test(link) || links.value.indexOf(link) !== -1) {\n        return;\n      }\n      links.value.push(link);\n    };\n    /**\n     * 注销锚点\n     *\n     * @param {string} link\n     */\n    const unregisterLink = (link: string) => {\n      links.value = links.value.filter((each) => each !== link);\n    };\n    /**\n     * 设置当前激活状态锚点\n     *\n     * @param {string} link\n     */\n    const setCurrentActiveLink = async (link: string): Promise<void> => {\n      if (active.value === link) {\n        return;\n      }\n      active.value = link;\n      props.onChange?.(link, active.value);\n      await nextTick();\n      updateActiveLine();\n    };\n    /**\n     * 计算active-line所在的位置\n     * 当前active-item的top + height, 以及ANCHOR_ITEM_PADDING修正\n     */\n    const updateActiveLine = () => {\n      const ele = anchorRef.value?.querySelector(`.${STATUS.value.active}>a`) as HTMLAnchorElement;\n      if (!ele) {\n        Object.assign(activeLineStyle, {});\n        return;\n      }\n      const { offsetTop: top, offsetHeight: height } = ele;\n      Object.assign(activeLineStyle, {\n        top: `${top}px`,\n        height: `${height}px`,\n        opacity: 1,\n      });\n    };\n    /**\n     * 监听AnchorLink点击事件\n     * @param {{ href: string; title: string }} link\n     */\n    const handleLinkClick = (link: { href: string; title: string; e: MouseEvent }) => {\n      props.onClick?.(link);\n    };\n    /**\n     * 滚动到指定锚点\n     *\n     * @param {string} link\n     */\n    const handleScrollTo = async (link: string): Promise<void> => {\n      const anchor = getAnchorTarget(link);\n      setCurrentActiveLink(link);\n      if (!anchor) return;\n      handleScrollLock.value = true;\n      const { targetOffset } = props;\n      const scrollTop = getScroll(scrollContainer.value);\n      const offsetTop = getOffsetTop(anchor, scrollContainer.value);\n      const top = scrollTop + offsetTop - targetOffset;\n      await scrollTo(top, {\n        container: scrollContainer.value,\n      });\n      handleScrollLock.value = false;\n    };\n    const renderCursor = () => {\n      const titleContent: SlotReturnValue = renderTNodeJSX('cursor');\n      return titleContent || <div class={ANCHOR_LINE_CURSOR_CLASSNAME.value}></div>;\n    };\n    onMounted(async () => {\n      getScrollContainer();\n      if (active.value) {\n        await nextTick();\n        handleScrollTo(active.value);\n      }\n    });\n    onUnmounted(() => {\n      if (!scrollContainer.value) return;\n      off(scrollContainer.value, 'scroll', handleScroll);\n    });\n    watchEffect(() => {\n      // 清空上一个container的事件监听\n      if (scrollContainer.value) {\n        off(scrollContainer.value, 'scroll', handleScroll);\n      }\n      getScrollContainer();\n    });\n    provide(\n      AnchorInjectionKey,\n      reactive({\n        registerLink,\n        unregisterLink,\n        handleScrollTo,\n        handleLinkClick,\n        active,\n      }),\n    );\n    return () => {\n      const { size, affixProps } = props;\n      const className = [COMPONENT_NAME.value, SIZE.value[size]];\n\n      const content = (\n        <div ref={anchorRef} class={className} {...attrs}>\n          <div class={ANCHOR_LINE_CLASSNAME.value}>\n            <div class={`${ANCHOR_LINE_CURSOR_CLASSNAME.value}-wrapper`} style={activeLineStyle}>\n              {renderCursor()}\n            </div>\n          </div>\n          {renderTNodeJSX('default')}\n        </div>\n      );\n\n      if (affixProps) {\n        return <Affix {...affixProps}>{content}</Affix>;\n      }\n\n      return content;\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","attrs","anchorRef","ref","links","active","scrollContainer","handleScrollLock","activeLineStyle","reactive","COMPONENT_NAME","usePrefixClass","ANCHOR_LINE_CLASSNAME","ANCHOR_LINE_CURSOR_CLASSNAME","useCommonClassName","STATUS","SIZE","renderTNodeJSX","useTNodeJSX","getScrollContainer","isServer","container","value","utilsGetScrollContainer","on","handleScroll","bounds","targetOffset","filters","forEach","link","anchor","getAnchorTarget","top","getOffsetTop","push","length","latest","reduce","prev","cur","setCurrentActiveLink","matcher","match","ANCHOR_SHARP_REGEXP","document","getElementById","registerLink","test","indexOf","unregisterLink","filter","each","_regeneratorRuntime","onChange","nextTick","updateActiveLine","ele","querySelector","Object","assign","offsetTop","height","offsetHeight","opacity","handleLinkClick","onClick","handleScrollTo","scrollTop","getScroll","scrollTo","renderCursor","titleContent","_createVNode","onMounted","onUnmounted","off","watchEffect","provide","AnchorInjectionKey","size","affixProps","className","content"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA,cAAeA,eAAgB,CAAA;AAC7BC,EAAAA,IAAM,EAAA,SADuB;AAE7BC,EAAAA,KAAA,EAAAA,KAF6B;EAG7BC,KAH6B,EAAA,SAAA,KAAA,CAGvBD,MAHuB,EAGU,IAAA,EAAA;IAAA,IAATE,KAAS,QAATA,KAAS,CAAA;AAC/B,IAAA,IAAAC,SAAA,GAAYC,IAAwB,KAApC,CAAA;AACA,IAAA,IAAAC,KAAA,GAAQD,GAAc,CAAA,EAAA,CAAtB,CAAA;AACA,IAAA,IAAAE,MAAA,GAASF,IAAI,GAAb,CAAA;AACA,IAAA,IAAAG,eAAA,GAAkBH,IAAsB,KAAxC,CAAA;AACA,IAAA,IAAAI,gBAAA,GAAmBJ,IAAa,MAAhC,CAAA;AACA,IAAA,IAAAK,eAAA,GAAkBC,QAAS,CAAA,EAAA,CAA3B,CAAA;AACA,IAAA,IAAAC,cAAA,GAAiBC,eAAe,SAAhC,CAAA;AACA,IAAA,IAAAC,qBAAA,GAAwBD,eAAe,eAAvC,CAAA;AACA,IAAA,IAAAE,4BAAA,GAA+BF,eAAe,sBAA9C,CAAA;;AACN,IAAA,IAAA,mBAAA,GAAyBG,kBAAmB,EAA5C;QAAQC,MAAR,uBAAQA,MAAR;QAAgBC,IAAhB,uBAAgBA,IAAhB,CAAA;;IACA,IAAMC,iBAAiBC,WAAY,EAAnC,CAAA;;AAMA,IAAA,IAAMC,uBAAqB,SAArBA,oBAAqB,GAAM;AAC/B,MAAA,IAAIC,QAAJ,EAAc;AACZ,QAAA,OAAA;AACF,OAAA;;AACM,MAAA,IAAEC,SAAF,GAAgBtB,MAAhB,CAAEsB,SAAF,CAAA;AACUf,MAAAA,eAAA,CAAAgB,KAAA,GAAQC,mBAAwBF,UAAhC,CAAA;MACbG,EAAA,CAAAlB,eAAA,CAAgBgB,KAAhB,EAAuB,QAAvB,EAAiCG,YAAjC,CAAA,CAAA;MACUA,YAAA,EAAA,CAAA;KAPf,CAAA;;AAYA,IAAA,IAAMA,eAAe,SAAfA,YAAe,GAAM;MACzB,IAAIlB,gBAAiB,CAAAe,KAArB,EAA4B,OAAA;AACtB,MAAA,IAAEI,MAAF,GAA2B3B,MAA3B,CAAE2B,MAAF;AAAA,UAAUC,YAAV,GAA2B5B,MAA3B,CAAU4B,YAAV,CAAA;MACN,IAAMC,UAA2C,EAAjD,CAAA;MACA,IAAIvB,OAAS,GAAA,EAAb,CAAA;AAEMD,MAAAA,KAAA,CAAAkB,KAAA,CAAMO,OAAN,CAAc,UAACC,IAAD,EAAU;AACtB,QAAA,IAAAC,MAAA,GAASC,gBAAgBF,KAAzB,CAAA;;QACN,IAAI,CAACC,MAAL,EAAa;AACX,UAAA,OAAA;AACF,SAAA;;QACA,IAAME,GAAM,GAAAC,YAAA,CAAaH,MAAb,EAAqBzB,eAAA,CAAgBgB,KAArC,CAAZ,CAAA;;AACI,QAAA,IAAAW,GAAA,GAAMP,SAASC,YAAf,EAA6B;UAC/BC,OAAA,CAAQO,IAAR,CAAa;AACXL,YAAAA,IAAA,EAAAA,IADW;AAEXG,YAAAA,GAAA,EAAAA,GAAAA;WAFF,CAAA,CAAA;AAIF,SAAA;OAXI,CAAA,CAAA;;MAcN,IAAIL,QAAQQ,MAAZ,EAAoB;QACZ,IAAAC,MAAA,GAAST,OAAQ,CAAAU,MAAR,CAAe,UAACC,IAAD,EAAOC,GAAP,EAAA;UAAA,OAAgBD,IAAA,CAAKN,GAAL,GAAWO,GAAA,CAAIP,GAAf,GAAqBM,IAArB,GAA4BC,GAA5C,CAAA;AAAA,SAAf,CAAT,CAAA;QACNnC,UAASgC,MAAO,CAAAP,IAAhBzB,CAAAA;AACF,OAAA;;MACAoC,oBAAA,CAAqBpC,OAArB,CAAA,CAAA;KAxBF,CAAA;;AA+BM,IAAA,IAAA2B,eAAA,GAAkB,SAAlBA,eAAkB,CAACF,IAAD,EAA+B;AAC/C,MAAA,IAAAY,OAAA,GAAUZ,IAAK,CAAAa,KAAL,CAAWC,mBAAX,CAAV,CAAA;;MACN,IAAI,CAACF,OAAL,EAAc;AACZ,QAAA,OAAA;AACF,OAAA;;MACA,IAAMX,MAAS,GAAAc,QAAA,CAASC,cAAT,CAAwBJ,OAAA,CAAQ,CAAR,CAAxB,CAAf,CAAA;;MACA,IAAI,CAACX,MAAL,EAAa;AACX,QAAA,OAAA;AACF,OAAA;;AACO,MAAA,OAAAA,MAAA,CAAA;KATH,CAAA;;AAgBA,IAAA,IAAAgB,YAAA,GAAe,SAAfA,YAAe,CAACjB,IAAD,EAAkB;AACjC,MAAA,IAAA,CAACc,mBAAoB,CAAAI,IAApB,CAAyBlB,IAAzB,CAAD,IAAmC1B,MAAMkB,KAAN,CAAY2B,OAAZ,CAAoBnB,IAApB,CAA8B,KAAA,CAAI,CAArE,EAAqE;AACvE,QAAA,OAAA;AACF,OAAA;;AACM1B,MAAAA,KAAA,CAAAkB,KAAA,CAAMa,IAAN,CAAWL,IAAX,CAAA,CAAA;KAJF,CAAA;;AAWA,IAAA,IAAAoB,cAAA,GAAiB,SAAjBA,cAAiB,CAACpB,IAAD,EAAkB;MACvC1B,KAAA,CAAMkB,KAAN,GAAclB,KAAM,CAAAkB,KAAN,CAAY6B,MAAZ,CAAmB,UAACC,IAAD,EAAA;QAAA,OAAUA,SAAStB,IAAnB,CAAA;AAAA,OAAnB,CAAd,CAAA;KADI,CAAA;;AAQA,IAAA,IAAAW,oBAAA,gBAAA,YAAA;AAAA,MAAA,IAAA,KAAA,GAAA,iBAAA,eAAAY,WAAA,CAAA,IAAA,CAAuB,iBAAOvB,IAAP,EAAA;AAAA,QAAA,IAAA,gBAAA,CAAA;;AAAA,QAAA,OAAAuB,WAAA,CAAA,IAAA,CAAA,SAAA,QAAA,CAAA,QAAA,EAAA;AAAA,UAAA,OAAA,CAAA,EAAA;AAAA,YAAA,QAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;AAAA,cAAA,KAAA,CAAA;AAAA,gBAAA,IAAA,EACvBhD,MAAA,CAAOiB,KAAP,KAAiBQ,IADM,CAAA,EAAA;AAAA,kBAAA,QAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,kBAAA,MAAA;AAAA,iBAAA;;AAAA,gBAAA,OAAA,QAAA,CAAA,MAAA,CAAA,QAAA,CAAA,CAAA;;AAAA,cAAA,KAAA,CAAA;gBAI3BzB,MAAA,CAAOiB,KAAP,GAAeQ,IAAf,CAAA;gBACA/B,CAAAA,gBAAAA,GAAAA,MAAM,CAAAuD,QAANvD,MAAAA,IAAAA,IAAAA,gBAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,gBAAAA,CAAAA,IAAAA,CAAAA,MAAM,EAAW+B,IAAX,EAAiBzB,MAAA,CAAOiB,KAAxB,CAANvB,CAAAA;AAL2B,gBAAA,QAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,gBAAA,OAMrBwD,QAAS,EANY,CAAA;;AAAA,cAAA,KAAA,CAAA;gBAOVC,gBAAA,EAAA,CAAA;;AAPU,cAAA,KAAA,CAAA,CAAA;AAAA,cAAA,KAAA,KAAA;AAAA,gBAAA,OAAA,QAAA,CAAA,IAAA,EAAA,CAAA;AAAA,aAAA;AAAA,WAAA;AAAA,SAAA,EAAA,OAAA,CAAA,CAAA;OAAvB,CAAA,CAAA,CAAA;;AAAA,MAAA,OAAA,SAAAf,oBAAA,CAAA,EAAA,EAAA;AAAA,QAAA,OAAA,KAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,CAAA;AAAA,OAAA,CAAA;KAAA,EAAA,CAAA;;AAaN,IAAA,IAAMe,mBAAmB,SAAnBA,gBAAmB,GAAM;AAAA,MAAA,IAAA,gBAAA,CAAA;;AAC7B,MAAA,IAAMC,0BAAMvD,SAAU,CAAAoB,WAAV,IAAA,IAAA,gBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,gBAAA,CAAiBoC,aAAjB,CAAA,GAAA,CAAA,MAAA,CAAmC3C,MAAA,CAAOO,KAAP,CAAajB,MAAhD,EAAZ,IAAA,CAAA,CAAA,CAAA;;MACA,IAAI,CAACoD,GAAL,EAAU;AACDE,QAAAA,MAAA,CAAAC,MAAA,CAAOpD,eAAP,EAAwB,EAAxB,CAAA,CAAA;AACP,QAAA,OAAA;AACF,OAAA;;AACA,MAAA,IAAmByB,GAAnB,GAAiDwB,GAAjD,CAAQI,SAAR;AAAA,UAAsCC,MAAtC,GAAiDL,GAAjD,CAAwBM,YAAxB,CAAA;AACAJ,MAAAA,MAAA,CAAOC,MAAP,CAAcpD,eAAd,EAA+B;QAC7ByB,eAAQA,KADqB,IAAA,CAAA;QAE7B6B,kBAAWA,QAFkB,IAAA,CAAA;AAG7BE,QAAAA,OAAS,EAAA,CAAA;OAHX,CAAA,CAAA;KAPF,CAAA;;AAiBM,IAAA,IAAAC,eAAA,GAAkB,SAAlBA,eAAkB,CAACnC,IAAD,EAA0D;AAAA,MAAA,IAAA,eAAA,CAAA;;AAChF/B,MAAAA,CAAAA,eAAAA,GAAAA,MAAAA,CAAMmE,OAANnE,yEAAAA,MAAAA,EAAgB+B,IAAhB/B,CAAAA,CAAAA;KADI,CAAA;;AAQA,IAAA,IAAAoE,cAAA,gBAAA,YAAA;AAAA,MAAA,IAAA,KAAA,GAAA,iBAAA,eAAAd,WAAA,CAAA,IAAA,CAAiB,kBAAOvB,IAAP,EAAA;AAAA,QAAA,IAAA,MAAA,EAAA,YAAA,EAAA,SAAA,EAAA,SAAA,EAAA,GAAA,CAAA;AAAA,QAAA,OAAAuB,WAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,UAAA,OAAA,CAAA,EAAA;AAAA,YAAA,QAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,cAAA,KAAA,CAAA;AACftB,gBAAAA,MADe,GACNC,gBAAgBF,KADV,CAAA;gBAErBW,oBAAA,CAAqBX,IAArB,CAAA,CAAA;;AAFqB,gBAAA,IAGhBC,MAHgB,EAAA;AAAA,kBAAA,SAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,kBAAA,MAAA;AAAA,iBAAA;;AAAA,gBAAA,OAAA,SAAA,CAAA,MAAA,CAAA,QAAA,CAAA,CAAA;;AAAA,cAAA,KAAA,CAAA;gBAIrBxB,gBAAA,CAAiBe,KAAjB,GAAyB,IAAzB,CAAA;gBACQK,YALa,GAKI5B,MALJ,CAKb4B,YALa,CAAA;AAMfyC,gBAAAA,SANe,GAMHC,SAAU,CAAA/D,eAAA,CAAgBgB,KAAhB,CANP,CAAA;gBAOfuC,SAPe,GAOH3B,YAAA,CAAaH,MAAb,EAAqBzB,eAAA,CAAgBgB,KAArC,CAPG,CAAA;AAQfW,gBAAAA,GARe,GAQTmC,YAAYP,SAAZ,GAAwBlC,YARf,CAAA;AAAA,gBAAA,SAAA,CAAA,IAAA,GAAA,EAAA,CAAA;gBAAA,OASf2C,SAASrC,KAAK;kBAClBZ,WAAWf,eAAgB,CAAAgB,KAAAA;AADT,kBATC,CAAA;;AAAA,cAAA,KAAA,EAAA;gBAYrBf,gBAAA,CAAiBe,KAAjB,GAAyB,KAAzB,CAAA;;AAZqB,cAAA,KAAA,EAAA,CAAA;AAAA,cAAA,KAAA,KAAA;AAAA,gBAAA,OAAA,SAAA,CAAA,IAAA,EAAA,CAAA;AAAA,aAAA;AAAA,WAAA;AAAA,SAAA,EAAA,QAAA,CAAA,CAAA;OAAjB,CAAA,CAAA,CAAA;;AAAA,MAAA,OAAA,SAAA6C,cAAA,CAAA,GAAA,EAAA;AAAA,QAAA,OAAA,KAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,CAAA;AAAA,OAAA,CAAA;KAAA,EAAA,CAAA;;AAcN,IAAA,IAAMI,eAAe,SAAfA,YAAe,GAAM;AACnB,MAAA,IAAAC,YAAA,GAAgCvD,eAAe,SAA/C,CAAA;AACN,MAAA,OAAOuD,YAAgB,IAAAC,WAAA,CAAA,KAAA,EAAA;AAAA,QAAA,OAAA,EAAY5D,6BAA6BS,KAAAA;OAAhE,EAAA,IAAA,CAAA,CAAA;KAFF,CAAA;;AAIAoD,IAAAA,SAAA,eAAU,iBAAA,eAAArB,WAAA,CAAA,IAAA,CAAA,SAAA,QAAA,GAAA;AAAA,MAAA,OAAAA,WAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,QAAA,OAAA,CAAA,EAAA;AAAA,UAAA,QAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,YAAA,KAAA,CAAA;cACWlC,oBAAA,EAAA,CAAA;;cADX,IAEJd,CAAAA,OAAOiB,KAFH,EAAA;AAAA,gBAAA,SAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,gBAAA,MAAA;AAAA,eAAA;;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,CAAA,CAAA;AAAA,cAAA,OAGAiC,QAAS,EAHT,CAAA;;AAAA,YAAA,KAAA,CAAA;AAINY,cAAAA,cAAA,CAAe9D,OAAOiB,KAAtB,CAAA,CAAA;;AAJM,YAAA,KAAA,CAAA,CAAA;AAAA,YAAA,KAAA,KAAA;AAAA,cAAA,OAAA,SAAA,CAAA,IAAA,EAAA,CAAA;AAAA,WAAA;AAAA,SAAA;AAAA,OAAA,EAAA,QAAA,CAAA,CAAA;AAAA,KAAV,CAAA,CAAA,CAAA,CAAA;AAOAqD,IAAAA,WAAA,CAAY,YAAM;AAChB,MAAA,IAAI,CAACrE,eAAgB,CAAAgB,KAArB,EAA4B,OAAA;MACxBsD,GAAA,CAAAtE,eAAA,CAAgBgB,KAAhB,EAAuB,QAAvB,EAAiCG,YAAjC,CAAA,CAAA;AACL,KAHD,CAAA,CAAA;AAIAoD,IAAAA,WAAA,CAAY,YAAM;MAEhB,IAAIvE,gBAAgBgB,KAApB,EAA2B;QACrBsD,GAAA,CAAAtE,eAAA,CAAgBgB,KAAhB,EAAuB,QAAvB,EAAiCG,YAAjC,CAAA,CAAA;AACN,OAAA;;MACmBN,oBAAA,EAAA,CAAA;AACpB,KAND,CAAA,CAAA;AAOA2D,IAAAA,OAAA,CACEC,kBADF,EAEEtE,QAAS,CAAA;AACPsC,MAAAA,YAAA,EAAAA,YADO;AAEPG,MAAAA,cAAA,EAAAA,cAFO;AAGPiB,MAAAA,cAAA,EAAAA,cAHO;AAIPF,MAAAA,eAAA,EAAAA,eAJO;AAKP5D,MAAAA,MAAA,EAAAA,MAAAA;AALO,KAAA,CAFX,CAAA,CAAA;AAUA,IAAA,OAAO,YAAM;AACL,MAAA,IAAE2E,IAAF,GAAuBjF,MAAvB,CAAEiF,IAAF;AAAA,UAAQC,UAAR,GAAuBlF,MAAvB,CAAQkF,UAAR,CAAA;AACN,MAAA,IAAMC,YAAY,CAACxE,cAAA,CAAeY,KAAhB,EAAuBN,IAAA,CAAKM,KAAL,CAAW0D,IAAX,CAAvB,CAAlB,CAAA;;AAEA,MAAA,IAAMG;eACMjF;eAAkBgF,EAAAA,SAAAA;SAAejF;iBAC7BW,qBAAsB,CAAAU,KAAAA;;eACjBT,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,4BAAA,CAA6BS;eAAwBd,EAAAA,eAAAA;UACjE+D,oBAGJtD,eAAe,WAPpB,CAAA,CAAA;;AAWA,MAAA,IAAIgE,UAAJ,EAAgB;AACd,QAAA,OAAAR,WAAA,CAAA,KAAA,EAAkBQ,UAAlB,EAAA,OAAA,CAA+BE,OAA/B,CAAA,GAA+BA,OAA/B,GAAA;AAAA,UAAA,SAAA,EAAA,SAAA,QAAA,GAAA;AAAA,YAAA,OAAA,CAA+BA,OAA/B,CAAA,CAAA;AAAA,WAAA;AAAA,SAAA,CAAA,CAAA;AACF,OAAA;;AAEO,MAAA,OAAAA,OAAA,CAAA;KAnBT,CAAA;AAqBF,GAAA;AA3M6B,CAAA,CAA/B;;;;"}