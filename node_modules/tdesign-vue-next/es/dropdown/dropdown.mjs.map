{"version":3,"file":"dropdown.mjs","sources":["../../src/dropdown/dropdown.tsx"],"sourcesContent":["import { defineComponent, provide, reactive, ref, toRefs } from 'vue';\nimport Popup from '../popup/index';\nimport DropdownMenu from './dropdown-menu';\nimport { DropdownOption, TdDropdownProps } from './type';\nimport props from './props';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport { injectKey } from './const';\n\nexport default defineComponent({\n  name: 'TDropdown',\n  props,\n  setup(props: TdDropdownProps, { attrs, slots }) {\n    const renderTNodeJSX = useTNodeJSX();\n    const COMPONENT_NAME = usePrefixClass('dropdown');\n    const popupElem = ref(null);\n\n    const handleMenuClick = (data: DropdownOption, context: { e: MouseEvent }) => {\n      if (props.hideAfterItemClick && popupElem.value) {\n        popupElem.value.handleClose();\n      }\n      props.onClick?.(data, context);\n    };\n\n    const { maxHeight, maxColumnWidth, minColumnWidth } = toRefs(props);\n    provide(\n      injectKey,\n      reactive({\n        handleMenuClick,\n        maxHeight,\n        maxColumnWidth,\n        minColumnWidth,\n      }),\n    );\n\n    return () => {\n      const trigger = renderTNodeJSX('default');\n\n      const contentSlot = renderTNodeJSX('dropdown');\n\n      const popupProps = {\n        ...attrs,\n        disabled: props.disabled,\n        placement: props.placement,\n        trigger: props.trigger,\n        overlayClassName: [COMPONENT_NAME.value, (props.popupProps as TdDropdownProps['popupProps'])?.overlayClassName],\n      };\n\n      return (\n        <Popup\n          {...props.popupProps}\n          {...popupProps}\n          destroyOnClose\n          ref={popupElem}\n          expandAnimation\n          v-slots={{\n            content: () =>\n              contentSlot || (\n                <DropdownMenu\n                  options={props.options}\n                  maxHeight={props.maxHeight}\n                  maxColumnWidth={props.maxColumnWidth}\n                  minColumnWidth={props.minColumnWidth}\n                />\n              ),\n          }}\n        >\n          {trigger}\n        </Popup>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","attrs","slots","renderTNodeJSX","useTNodeJSX","COMPONENT_NAME","usePrefixClass","popupElem","ref","handleMenuClick","data","context","hideAfterItemClick","value","handleClose","onClick","toRefs","maxHeight","maxColumnWidth","minColumnWidth","provide","injectKey","reactive","trigger","contentSlot","popupProps","disabled","placement","overlayClassName","_createVNode","_mergeProps","content","DropdownMenu","options"],"mappings":"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"}