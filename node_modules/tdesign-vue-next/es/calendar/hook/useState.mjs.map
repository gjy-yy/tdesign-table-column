{"version":3,"file":"useState.mjs","sources":["../../../src/calendar/hook/useState.ts"],"sourcesContent":["import { reactive, watch } from 'vue';\nimport dayjs from 'dayjs';\n\nimport { useConfig } from '../../hooks/useConfig';\nimport { COMPONENT_NAME } from '../const';\nimport { createDefaultCurDate } from '../utils';\nimport { TdCalendarProps } from '../type';\nimport { CalendarState } from '../interface';\n\nexport function useState(props: TdCalendarProps) {\n  const { globalConfig } = useConfig(COMPONENT_NAME);\n\n  const state = reactive<CalendarState>({\n    realFirstDayOfWeek: 1,\n    curDate: null,\n    curSelectedYear: null,\n    curSelectedMonth: null,\n    curSelectedMode: null,\n    isShowWeekend: true,\n    controlSize: 'medium',\n  });\n\n  function toToday() {\n    const curDate = createDefaultCurDate();\n    state.curSelectedYear = curDate.year();\n    state.curSelectedMonth = parseInt(curDate.format('M'), 10);\n  }\n\n  function setCurSelectedYear(year?: TdCalendarProps['year']) {\n    const curSelectedYear = year ? parseInt(`${year}`, 10) : createDefaultCurDate().year();\n    if (!isNaN(curSelectedYear) && curSelectedYear > 0) {\n      state.curSelectedYear = curSelectedYear;\n    }\n  }\n\n  function setCurSelectedMonth(month?: TdCalendarProps['month']) {\n    const curSelectedMonth = month ? parseInt(`${month}`, 10) : parseInt(createDefaultCurDate().format('M'), 10);\n    if (!isNaN(curSelectedMonth) && curSelectedMonth > 0 && curSelectedMonth <= 12) {\n      state.curSelectedMonth = curSelectedMonth;\n    }\n  }\n\n  function setCurrentDate(value?: TdCalendarProps['value']): void {\n    state.curDate = value ? dayjs(value) : createDefaultCurDate();\n  }\n\n  function checkDayVisibled(day: number) {\n    let re = true;\n    if (!state.isShowWeekend) {\n      re = day !== 6 && day !== 7;\n    }\n    return re;\n  }\n\n  watch(\n    () => props.firstDayOfWeek,\n    () => {\n      state.realFirstDayOfWeek = props.firstDayOfWeek ?? globalConfig.value.firstDayOfWeek ?? 1;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.value,\n    (v: TdCalendarProps['value']) => {\n      setCurrentDate(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.year,\n    (v: TdCalendarProps['year']) => {\n      setCurSelectedYear(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.month,\n    (v: TdCalendarProps['month']) => {\n      setCurSelectedMonth(v);\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.isShowWeekendDefault,\n    (v: TdCalendarProps['isShowWeekendDefault']) => {\n      state.isShowWeekend = v;\n    },\n    { immediate: true },\n  );\n  watch(\n    () => props.mode,\n    (v: TdCalendarProps['mode']) => {\n      state.curSelectedMode = v;\n    },\n    { immediate: true },\n  );\n\n  return {\n    state,\n    toToday,\n    checkDayVisibled,\n  };\n}\n"],"names":["useState","props","useConfig","COMPONENT_NAME","globalConfig","state","reactive","realFirstDayOfWeek","curDate","curSelectedYear","curSelectedMonth","curSelectedMode","isShowWeekend","controlSize","toToday","createDefaultCurDate","year","parseInt","format","setCurSelectedYear","isNaN","setCurSelectedMonth","month","setCurrentDate","value","dayjs","checkDayVisibled","day","re","watch","firstDayOfWeek","immediate","v","isShowWeekendDefault","mode"],"mappings":"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"}