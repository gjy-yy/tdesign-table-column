{"version":3,"file":"skeleton.mjs","sources":["../../src/skeleton/skeleton.tsx"],"sourcesContent":["import { h, defineComponent, ref, watch } from 'vue';\nimport isNumber from 'lodash/isNumber';\nimport isFunction from 'lodash/isFunction';\nimport props from './props';\nimport { SkeletonRowCol, SkeletonRowColObj, TdSkeletonProps } from './type';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useContent } from '../hooks/tnode';\n\nconst ThemeMap: Record<TdSkeletonProps['theme'], SkeletonRowCol> = {\n  text: [1],\n  avatar: [{ type: 'circle', size: '56px' }],\n  paragraph: [1, 1, { width: '70%' }],\n  'avatar-text': [[{ type: 'circle' }, { type: 'text', height: '32px' }]],\n  tab: [{ height: '30px' }, { height: '200px' }],\n  article: [\n    { type: 'rect', height: '30px', width: '100%' },\n    { type: 'rect', height: '200px', width: '100%' },\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n    [\n      { type: 'text', height: '30px' },\n      { type: 'text', height: '30px' },\n    ],\n  ],\n};\n\nconst getColItemStyle = (obj: SkeletonRowColObj) => {\n  const styleName = ['width', 'height', 'marginRight', 'marginLeft', 'margin', 'size', 'background', 'backgroundColor'];\n  const style = Object.create(null);\n  styleName.forEach((name) => {\n    if (name in obj) {\n      const px = isNumber(obj[name]) ? `${obj[name]}px` : obj[name];\n      if (name === 'size') {\n        [style.width, style.height] = [px, px];\n      } else {\n        style[name] = px;\n      }\n    }\n  });\n  return style;\n};\n\nexport default defineComponent({\n  name: 'TSkeleton',\n\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const isShow = ref(false);\n    const COMPONENT_NAME = usePrefixClass('skeleton');\n    const renderContent = useContent();\n    const getColItemClass = (obj: SkeletonRowColObj) => [\n      `${COMPONENT_NAME.value}__col`,\n      `${COMPONENT_NAME.value}--type-${obj.type || 'text'}`,\n      { [`${COMPONENT_NAME.value}--animation-${props.animation}`]: props.animation },\n    ];\n\n    const renderCols = (_cols: Number | SkeletonRowColObj | Array<SkeletonRowColObj>) => {\n      let cols: Array<SkeletonRowColObj> = [];\n      if (Array.isArray(_cols)) {\n        cols = _cols;\n      } else if (isNumber(_cols)) {\n        cols = new Array(_cols).fill({ type: 'text' });\n      } else {\n        cols = [_cols as SkeletonRowColObj];\n      }\n      return cols.map((obj) => (\n        <div class={getColItemClass(obj)} style={getColItemStyle(obj)}>\n          {isFunction(obj.content) ? obj.content(h) : obj.content}\n        </div>\n      ));\n    };\n\n    const renderRowCol = (_rowCol?: SkeletonRowCol) => {\n      const rowCol: SkeletonRowCol = _rowCol || props.rowCol;\n\n      const getBlockClass = () => [`${COMPONENT_NAME.value}__row`];\n\n      return rowCol.map((item) => <div class={getBlockClass()}>{renderCols(item)}</div>);\n    };\n\n    watch(\n      () => props.loading,\n      (val) => {\n        if (!val || props.delay === 0) {\n          isShow.value = val;\n          return;\n        }\n        setTimeout(() => {\n          isShow.value = val;\n        }, props.delay);\n      },\n      { immediate: true },\n    );\n\n    return () => {\n      const content = renderContent('default', 'content');\n\n      if (slots.default && !isShow.value) {\n        return <div>{content}</div>;\n      }\n\n      if (!isShow.value) {\n        return;\n      }\n\n      const children = [];\n      if (props.theme) {\n        children.push(renderRowCol(ThemeMap[props.theme]));\n      }\n      if (props.rowCol) {\n        children.push(renderRowCol(props.rowCol));\n      }\n      if (!props.theme && !props.rowCol) {\n        // 什么都不传时，传入默认 rowCol\n        children.push(renderRowCol([1, 1, 1, { width: '70%' }]));\n      }\n\n      return <div class={COMPONENT_NAME.value}>{children}</div>;\n    };\n  },\n});\n"],"names":["ThemeMap","text","avatar","type","size","paragraph","width","height","tab","article","getColItemStyle","obj","styleName","style","Object","create","forEach","name","px","isNumber","defineComponent","props","setup","slots","isShow","ref","COMPONENT_NAME","usePrefixClass","renderContent","useContent","getColItemClass","value","animation","renderCols","_cols","cols","Array","isArray","fill","map","_createVNode","isFunction","content","h","renderRowCol","_rowCol","rowCol","getBlockClass","item","watch","loading","val","delay","setTimeout","immediate","children","theme","push"],"mappings":"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"}