{"version":3,"file":"group.mjs","sources":["../../src/radio/group.tsx"],"sourcesContent":["import { VNode, defineComponent, h, provide, reactive, ref, computed, onMounted, watch, nextTick, toRefs } from 'vue';\nimport isString from 'lodash/isString';\nimport isNumber from 'lodash/isNumber';\nimport isNil from 'lodash/isNil';\nimport props from './radio-group-props';\nimport { RadioOptionObj, RadioOption } from './type';\nimport Radio from './radio';\nimport { RadioGroupInjectionKey } from './constants';\n\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport useVModel from '../hooks/useVModel';\nimport { useTNodeDefault } from '../hooks/tnode';\n\nexport default defineComponent({\n  name: 'TRadioGroup',\n  props: { ...props },\n  setup(props) {\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setInnerValue] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    /** calculate bar style */\n    const radioGroupRef = ref<HTMLElement>();\n    const radioBtnName = usePrefixClass('radio-button');\n    const { STATUS, SIZE } = useCommonClassName();\n\n    const checkedClassName = computed(() => `.${radioBtnName.value}.${STATUS.value.checked}`);\n\n    const barStyle = ref({ width: '0px', left: '0px' });\n\n    const calcDefaultBarStyle = () => {\n      const div = document.createElement('div');\n      div.setAttribute('style', 'position: absolute; visibility: hidden;');\n      div.appendChild(radioGroupRef.value.cloneNode(true));\n      document.body.appendChild(div);\n\n      const defaultCheckedRadio: HTMLElement = div.querySelector(checkedClassName.value);\n      const { offsetWidth, offsetLeft } = defaultCheckedRadio;\n      barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      document.body.removeChild(div);\n    };\n\n    const calcBarStyle = () => {\n      if (props.variant === 'outline') return;\n\n      const checkedRadio: HTMLElement = radioGroupRef.value.querySelector(checkedClassName.value);\n      if (!checkedRadio) {\n        barStyle.value = { width: '0px', left: '0px' };\n        return;\n      }\n\n      const { offsetWidth, offsetLeft } = checkedRadio;\n      // current node is not renderedï¼Œfallback to default render\n      if (!offsetWidth) {\n        calcDefaultBarStyle();\n      } else {\n        barStyle.value = { width: `${offsetWidth}px`, left: `${offsetLeft}px` };\n      }\n    };\n\n    watch(innerValue, async () => {\n      await nextTick();\n      calcBarStyle();\n    });\n    onMounted(() => {\n      calcBarStyle();\n    });\n    /** calculate bar style end */\n\n    const { name, disabled } = toRefs(props);\n    provide(\n      RadioGroupInjectionKey,\n      reactive({\n        name,\n        disabled,\n        value: innerValue,\n        setValue: setInnerValue,\n      }),\n    );\n\n    const radioGroupName = usePrefixClass('radio-group');\n    const renderSlot = useTNodeDefault();\n    const renderBlock = (): VNode => {\n      if (props.variant.includes('filled') && !isNil(innerValue.value))\n        return <div style={barStyle.value} class={`${radioGroupName.value}__bg-block`} />;\n    };\n    const renderOptions = (): VNode[] => {\n      return props.options?.map((option: RadioOption) => {\n        let opt = option as RadioOptionObj;\n        if (isNumber(option) || isString(option)) {\n          opt = { value: option, label: option.toString() };\n        }\n        return (\n          <Radio\n            key={`radio-group-options-${opt.value}-${Math.random()}`}\n            name={props.name}\n            checked={innerValue.value === opt.value}\n            disabled={'disabled' in opt ? opt.disabled : props.disabled}\n            value={opt.value}\n          >\n            {typeof opt.label === 'function' ? opt.label(h) : opt.label}\n          </Radio>\n        );\n      });\n    };\n\n    const groupClass = computed(() => [\n      `${radioGroupName.value}`,\n      SIZE.value[props.size],\n      {\n        [`${radioGroupName.value}__outline`]: props.variant === 'outline',\n        [`${radioGroupName.value}--filled`]: props.variant.includes('filled'),\n        [`${radioGroupName.value}--primary-filled`]: props.variant === 'primary-filled',\n      },\n    ]);\n\n    return () => (\n      <div ref={radioGroupRef} class={groupClass.value}>\n        {renderSlot('default') || renderOptions()}\n        {renderBlock()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","setup","toRefs","value","modelValue","useVModel","defaultValue","onChange","innerValue","setInnerValue","radioGroupRef","ref","radioBtnName","usePrefixClass","useCommonClassName","STATUS","SIZE","checkedClassName","computed","checked","barStyle","width","left","calcDefaultBarStyle","div","document","createElement","setAttribute","appendChild","cloneNode","body","defaultCheckedRadio","querySelector","offsetWidth","offsetLeft","removeChild","calcBarStyle","variant","checkedRadio","watch","_regeneratorRuntime","nextTick","onMounted","disabled","provide","RadioGroupInjectionKey","reactive","setValue","radioGroupName","renderSlot","useTNodeDefault","renderBlock","includes","isNil","_createVNode","renderOptions","options","map","option","opt","isNumber","isString","label","toString","Radio","Math","random","h","groupClass","size"],"mappings":"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"}