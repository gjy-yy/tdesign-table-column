{"version":3,"file":"useTagScroll.mjs","sources":["../../../src/tag-input/hooks/useTagScroll.ts"],"sourcesContent":["/**\n * 当标签数量过多时，输入框显示不下，则需要滚动查看，以下为滚动逻辑\n * 如果标签过多时的处理方式，是标签省略，则不需要此功能\n */\n\nimport { onMounted, onUnmounted, ref, toRefs } from 'vue';\nimport { TdTagInputProps } from '../type';\n\nexport default function useTagScroll(props: TdTagInputProps) {\n  const tagInputRef = ref();\n  const { excessTagsDisplayType, readonly, disabled } = toRefs(props);\n  // 允许向右滚动的最大距离\n  const scrollDistance = ref(0);\n  const scrollElement = ref<HTMLElement>();\n  const mouseEnterTimer = ref();\n\n  const updateScrollElement = (element: HTMLElement) => {\n    const inputElement = element.children[0] as HTMLElement;\n    scrollElement.value = inputElement;\n  };\n\n  const updateScrollDistance = () => {\n    scrollDistance.value = scrollElement.value.scrollWidth - scrollElement.value.clientWidth;\n  };\n\n  const scrollTo = (distance: number) => {\n    scrollElement.value?.scroll({ left: distance, behavior: 'smooth' });\n  };\n\n  const scrollToRight = () => {\n    updateScrollDistance();\n    scrollTo(scrollDistance.value);\n  };\n\n  const scrollToLeft = () => {\n    scrollTo(0);\n  };\n\n  // TODO：MAC 电脑横向滚动，Windows 纵向滚动。当前只处理了横向滚动\n  const onWheel = ({ e }: { e: WheelEvent }) => {\n    if (readonly.value || disabled.value) return;\n    if (!scrollElement.value) return;\n    if (e.deltaX > 0) {\n      const distance = Math.min(scrollElement.value.scrollLeft + 120, scrollDistance.value);\n      scrollTo(distance);\n    } else {\n      const distance = Math.max(scrollElement.value.scrollLeft - 120, 0);\n      scrollTo(distance);\n    }\n  };\n\n  // 鼠标 hover，自动滑动到最右侧，以便输入新标签\n  const scrollToRightOnEnter = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    // 一闪而过的 mousenter 不需要执行\n    mouseEnterTimer.value = setTimeout(() => {\n      scrollToRight();\n      clearTimeout(mouseEnterTimer.value);\n    }, 100);\n  };\n\n  const scrollToLeftOnLeave = () => {\n    if (excessTagsDisplayType.value !== 'scroll') return;\n    scrollTo(0);\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  const init = () => {\n    const element = tagInputRef.value?.$el;\n    if (!element) return;\n    updateScrollElement(element);\n  };\n\n  const clear = () => {\n    clearTimeout(mouseEnterTimer.value);\n  };\n\n  onMounted(init);\n\n  onUnmounted(clear);\n\n  return {\n    tagInputRef,\n    scrollElement,\n    scrollDistance,\n    scrollTo,\n    scrollToRight,\n    scrollToLeft,\n    updateScrollElement,\n    updateScrollDistance,\n    onWheel,\n    scrollToRightOnEnter,\n    scrollToLeftOnLeave,\n  };\n}\n"],"names":["useTagScroll","props","tagInputRef","ref","toRefs","excessTagsDisplayType","readonly","disabled","scrollDistance","scrollElement","mouseEnterTimer","updateScrollElement","element","inputElement","children","value","updateScrollDistance","scrollWidth","clientWidth","scrollTo","distance","scroll","left","behavior","scrollToRight","scrollToLeft","onWheel","e","deltaX","Math","min","scrollLeft","max","scrollToRightOnEnter","setTimeout","clearTimeout","scrollToLeftOnLeave","init","$el","clear","onMounted","onUnmounted"],"mappings":";;;;;;;;AAQA,SAAwBA,YAAxB,CAAqCC,KAArC,EAA6D;EAC3D,IAAMC,cAAcC,GAAI,EAAxB,CAAA;;EACA,IAAsDC,OAAAA,GAAAA,OAAOH,MAA7D;MAAQI,qBAAR,WAAQA,qBAAR;MAA+BC,QAA/B,WAA+BA,QAA/B;MAAyCC,QAAzC,WAAyCA,QAAzC,CAAA;;AAEM,EAAA,IAAAC,cAAA,GAAiBL,IAAI,EAArB,CAAA;EACN,IAAMM,gBAAgBN,GAAiB,EAAvC,CAAA;EACA,IAAMO,kBAAkBP,GAAI,EAA5B,CAAA;;AAEM,EAAA,IAAAQ,mBAAA,GAAsB,SAAtBA,mBAAsB,CAACC,OAAD,EAA0B;AAC9C,IAAA,IAAAC,YAAA,GAAeD,QAAQE,QAAR,CAAiB,CAAjB,CAAf,CAAA;IACNL,aAAA,CAAcM,KAAd,GAAsBF,YAAtB,CAAA;GAFI,CAAA;;AAKN,EAAA,IAAMG,uBAAuB,SAAvBA,oBAAuB,GAAM;AACjCR,IAAAA,cAAA,CAAeO,KAAf,GAAuBN,aAAA,CAAcM,KAAd,CAAoBE,WAApB,GAAkCR,cAAcM,KAAd,CAAoBG,WAA7E,CAAA;GADF,CAAA;;AAIM,EAAA,IAAAC,QAAA,GAAW,SAAXA,QAAW,CAACC,QAAD,EAAsB;AAAA,IAAA,IAAA,oBAAA,CAAA;;AACrC,IAAA,CAAA,oBAAA,GAAAX,aAAA,CAAcM,KAAd,MAAA,IAAA,IAAA,oBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,oBAAA,CAAqBM,MAArB,CAA4B;AAAEC,MAAAA,MAAMF,QAAR;AAAkBG,MAAAA,QAAA,EAAU,QAAA;KAAxD,CAAA,CAAA;GADI,CAAA;;AAIN,EAAA,IAAMC,gBAAgB,SAAhBA,aAAgB,GAAM;IACLR,oBAAA,EAAA,CAAA;AACrBG,IAAAA,QAAA,CAASX,eAAeO,KAAxB,CAAA,CAAA;GAFF,CAAA;;AAKA,EAAA,IAAMU,eAAe,SAAfA,YAAe,GAAM;IACzBN,QAAA,CAAS,CAAT,CAAA,CAAA;GADF,CAAA;;AAKA,EAAA,IAAMO,OAAU,GAAA,SAAVA,OAAU,CAA8B,IAAA,EAAA;IAAA,IAA3BC,CAA2B,QAA3BA,CAA2B,CAAA;AACxC,IAAA,IAAArB,QAAA,CAASS,KAAT,IAAkBR,QAAS,CAAAQ,KAA3B,EAAkC,OAAA;AACtC,IAAA,IAAI,CAACN,aAAc,CAAAM,KAAnB,EAA0B,OAAA;;AACtB,IAAA,IAAAY,CAAA,CAAEC,MAAF,GAAW,CAAX,EAAc;AACV,MAAA,IAAAR,QAAA,GAAWS,KAAKC,GAAL,CAASrB,aAAA,CAAcM,KAAd,CAAoBgB,UAApB,GAAiC,GAA1C,EAA+CvB,eAAeO,KAA9D,CAAX,CAAA;MACNI,QAAA,CAASC,QAAT,CAAA,CAAA;AACK,KAHH,MAGG;AACL,MAAA,IAAMA,YAAWS,IAAK,CAAAG,GAAL,CAASvB,cAAcM,KAAd,CAAoBgB,UAApB,GAAiC,GAA1C,EAA+C,CAA/C,CAAjB,CAAA;;MACAZ,QAAA,CAASC,SAAT,CAAA,CAAA;AACF,KAAA;GATF,CAAA;;AAaA,EAAA,IAAMa,uBAAuB,SAAvBA,oBAAuB,GAAM;AACjC,IAAA,IAAI5B,sBAAsBU,KAAtB,KAAgC,QAApC,EAA8C,OAAA;AAE9BL,IAAAA,eAAA,CAAAK,KAAA,GAAQmB,WAAW,YAAM;MACzBV,aAAA,EAAA,CAAA;AACdW,MAAAA,YAAA,CAAazB,gBAAgBK,KAA7B,CAAA,CAAA;OACC,IAHa,CAAA;GAHlB,CAAA;;AASA,EAAA,IAAMqB,sBAAsB,SAAtBA,mBAAsB,GAAM;AAChC,IAAA,IAAI/B,sBAAsBU,KAAtB,KAAgC,QAApC,EAA8C,OAAA;IAC9CI,QAAA,CAAS,CAAT,CAAA,CAAA;AACAgB,IAAAA,YAAA,CAAazB,gBAAgBK,KAA7B,CAAA,CAAA;GAHF,CAAA;;AAMA,EAAA,IAAMsB,OAAO,SAAPA,IAAO,GAAM;AAAA,IAAA,IAAA,kBAAA,CAAA;;AACX,IAAA,IAAAzB,OAAA,GAAUV,CAAAA,kBAAAA,GAAAA,YAAYa,KAAtB,MAAA,IAAA,IAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAU,mBAAmBuB,GAA7B,CAAA;IACN,IAAI,CAAC1B,OAAL,EAAc,OAAA;IACdD,mBAAA,CAAoBC,OAApB,CAAA,CAAA;GAHF,CAAA;;AAMA,EAAA,IAAM2B,QAAQ,SAARA,KAAQ,GAAM;AAClBJ,IAAAA,YAAA,CAAazB,gBAAgBK,KAA7B,CAAA,CAAA;GADF,CAAA;;EAIAyB,SAAA,CAAUH,IAAV,CAAA,CAAA;EAEAI,WAAA,CAAYF,KAAZ,CAAA,CAAA;EAEO,OAAA;AACLrC,IAAAA,WAAA,EAAAA,WADK;AAELO,IAAAA,aAAA,EAAAA,aAFK;AAGLD,IAAAA,cAAA,EAAAA,cAHK;AAILW,IAAAA,QAAA,EAAAA,QAJK;AAKLK,IAAAA,aAAA,EAAAA,aALK;AAMLC,IAAAA,YAAA,EAAAA,YANK;AAOLd,IAAAA,mBAAA,EAAAA,mBAPK;AAQLK,IAAAA,oBAAA,EAAAA,oBARK;AASLU,IAAAA,OAAA,EAAAA,OATK;AAULO,IAAAA,oBAAA,EAAAA,oBAVK;AAWLG,IAAAA,mBAAA,EAAAA,mBAAAA;GAXK,CAAA;AAaT;;;;"}