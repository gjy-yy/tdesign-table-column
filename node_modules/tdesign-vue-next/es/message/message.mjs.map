{"version":3,"file":"message.mjs","sources":["../../src/message/message.tsx"],"sourcesContent":["import { defineComponent, h, onBeforeMount, onMounted, computed, ref } from 'vue';\nimport {\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n  HelpCircleFilledIcon as TdHelpCircleFilledIcon,\n  CloseIcon as TdCloseIcon,\n} from 'tdesign-icons-vue-next';\n\nimport TLoading from '../loading';\nimport { THEME_LIST } from './const';\nimport props from './props';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { fadeIn, fadeOut } from './animation';\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\n\nexport default defineComponent({\n  name: 'TMessage',\n  props: {\n    ...props,\n    placement: String, // just for animation\n  },\n  setup(props, { slots, expose }) {\n    const COMPONENT_NAME = usePrefixClass('message');\n    const { InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon, HelpCircleFilledIcon, CloseIcon } =\n      useGlobalIcon({\n        InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n        CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n        ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n        HelpCircleFilledIcon: TdHelpCircleFilledIcon,\n        CloseIcon: TdCloseIcon,\n      });\n    const classPrefix = usePrefixClass();\n\n    const renderTNode = useTNodeJSX();\n    const renderContent = useContent();\n\n    const msgRef = ref(null);\n    const timer = ref(null);\n\n    const classes = computed(() => {\n      const status = {};\n      THEME_LIST.forEach((t) => (status[`${classPrefix.value}-is-${t}`] = props.theme === t));\n      return [\n        COMPONENT_NAME.value,\n        status,\n        {\n          [`${classPrefix.value}-is-closable`]: props.closeBtn || slots.closeBtn,\n        },\n      ];\n    });\n\n    const close = (e?: MouseEvent) => {\n      props.onCloseBtnClick?.({ e });\n    };\n\n    const clearTimer = () => {\n      props.duration && clearTimeout(timer.value);\n    };\n\n    const setTimer = () => {\n      if (!props.duration) {\n        return;\n      }\n      timer.value = Number(\n        setTimeout(() => {\n          clearTimer();\n          const msgDom = msgRef.value as HTMLElement;\n          fadeOut(msgDom, props.placement, () => {\n            props.onDurationEnd?.();\n          });\n        }, props.duration),\n      );\n    };\n\n    const renderClose = () => {\n      const defaultClose = <CloseIcon />;\n      return (\n        <span class={`${COMPONENT_NAME.value}__close`} onClick={close}>\n          {renderTNode('closeBtn', defaultClose)}\n        </span>\n      );\n    };\n\n    const renderIcon = () => {\n      if (props.icon === false) return;\n      if (typeof props.icon === 'function') return props.icon(h);\n      if (slots.icon) {\n        return slots.icon(null);\n      }\n      const Icon = {\n        info: InfoCircleFilledIcon,\n        success: CheckCircleFilledIcon,\n        warning: ErrorCircleFilledIcon,\n        error: ErrorCircleFilledIcon,\n        question: HelpCircleFilledIcon,\n        loading: TLoading,\n      }[props.theme];\n      return <Icon />;\n    };\n\n    onBeforeMount(() => {\n      props.duration && setTimer();\n    });\n\n    onMounted(() => {\n      const msgDom = msgRef.value;\n      fadeIn(msgDom, props.placement);\n    });\n\n    expose({ close });\n\n    return () => (\n      <div ref={msgRef} class={classes.value} onMouseenter={clearTimer} onMouseleave={setTimer}>\n        {renderIcon()}\n        {renderContent('content', 'default')}\n        {renderClose()}\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","placement","String","setup","slots","expose","COMPONENT_NAME","usePrefixClass","useGlobalIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","HelpCircleFilledIcon","TdHelpCircleFilledIcon","CloseIcon","TdCloseIcon","classPrefix","renderTNode","useTNodeJSX","renderContent","useContent","msgRef","ref","timer","classes","computed","status","THEME_LIST","forEach","t","value","theme","closeBtn","close","e","onCloseBtnClick","clearTimer","duration","clearTimeout","setTimer","Number","setTimeout","msgDom","fadeOut","onDurationEnd","renderClose","defaultClose","_createVNode","renderIcon","icon","h","Icon","info","success","warning","error","question","loading","TLoading","onBeforeMount","onMounted","fadeIn"],"mappings":"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"}