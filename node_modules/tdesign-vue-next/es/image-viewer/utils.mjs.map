{"version":3,"file":"utils.mjs","sources":["../../src/image-viewer/utils.ts"],"sourcesContent":["import { TdImageViewerProps, ImageInfo } from './type';\n\nexport const downloadFile = function (imgSrc: string) {\n  const image = new Image();\n  const name = imgSrc?.split?.('/').pop() || Math.random().toString(32).slice(2);\n\n  image.setAttribute('crossOrigin', 'anonymous');\n\n  image.onload = () => {\n    const canvas = document.createElement('canvas');\n    canvas.width = image.width;\n    canvas.height = image.height;\n\n    const context = canvas.getContext('2d');\n    context.drawImage(image, 0, 0, image.width, image.height);\n    canvas.toBlob((blob) => {\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.download = name;\n      a.href = url;\n      a.click();\n      a.remove();\n      URL.revokeObjectURL(url);\n    });\n  };\n  image.src = imgSrc;\n};\n\nconst isImageInfo = (image: string | ImageInfo): image is ImageInfo => {\n  return typeof image !== 'string';\n};\n\nexport const formatImages = (images: TdImageViewerProps['images']): ImageInfo[] => {\n  if (!Array.isArray(images)) return [];\n  return images.map((item) => {\n    if (isImageInfo(item)) {\n      return {\n        download: true,\n        thumbnail: item.mainImage,\n        ...item,\n      };\n    }\n    return {\n      mainImage: item,\n      thumbnail: item,\n      download: true,\n    };\n  });\n};\n\nexport const getOverlay = (props: TdImageViewerProps) => {\n  if (props.showOverlay !== undefined) {\n    return props.showOverlay;\n  }\n  return props.mode === 'modal';\n};\n"],"names":["downloadFile","imgSrc","image","Image","name","split","pop","Math","random","toString","slice","setAttribute","onload","canvas","document","createElement","width","height","context","getContext","drawImage","toBlob","blob","url","URL","createObjectURL","a","download","href","click","remove","revokeObjectURL","src","isImageInfo","formatImages","images","Array","isArray","map","item","thumbnail","mainImage","getOverlay","props","showOverlay","mode"],"mappings":"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"}