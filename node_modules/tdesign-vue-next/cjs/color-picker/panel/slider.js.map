{"version":3,"file":"slider.js","sources":["../../../src/color-picker/panel/slider.tsx"],"sourcesContent":["import { computed, defineComponent, onBeforeUnmount, onMounted, PropType, reactive, ref } from 'vue';\nimport { SLIDER_DEFAULT_WIDTH } from '../const';\nimport { Draggable, Coordinate } from '../utils';\nimport { useBaseClassName } from '../hooks';\nimport baseProps from './base-props';\n\nexport default defineComponent({\n  name: 'ColorSlider',\n  props: {\n    ...baseProps,\n    className: {\n      type: String,\n      default: '',\n    },\n    value: {\n      type: Number,\n      default: 0,\n    },\n    maxValue: {\n      type: Number,\n      default: 360,\n    },\n    railStyle: {\n      type: Object as PropType<any>,\n    },\n    type: {\n      type: String as PropType<'hue' | 'alpha'>,\n      default: 'hue',\n    },\n  },\n  setup(props) {\n    const baseClassName = useBaseClassName();\n    const refPanel = ref<HTMLElement>(null);\n    const refThumb = ref<HTMLElement>(null);\n    const dragInstance = ref<Draggable>(null);\n    const panelRect = reactive({\n      width: SLIDER_DEFAULT_WIDTH,\n    });\n    const styles = computed(() => {\n      const { width } = panelRect;\n      if (!width) {\n        return;\n      }\n      const left = Math.round((props.value / props.maxValue) * width);\n      return {\n        left: `${left}px`,\n        color: props.color.rgb,\n      };\n    });\n\n    const handleDrag = (coordinate: Coordinate, isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      const { width } = panelRect;\n      const { x } = coordinate;\n      const value = Math.round((x / width) * props.maxValue * 100) / 100;\n      props.onChange(value, isEnded);\n    };\n\n    const handleDragEnd = (coordinate: Coordinate) => {\n      if (props.disabled) {\n        return;\n      }\n      handleDrag(coordinate, true);\n    };\n\n    onMounted(() => {\n      panelRect.width = refPanel.value.offsetWidth || SLIDER_DEFAULT_WIDTH;\n      dragInstance.value = new Draggable(refPanel.value, {\n        start: () => {\n          // pop模式下由于是隐藏显示，这个宽度让其每次点击的时候重新计算\n          panelRect.width = refPanel.value.offsetWidth;\n        },\n        drag: (coordinate: Coordinate) => {\n          handleDrag(coordinate);\n        },\n        end: handleDragEnd,\n      });\n    });\n\n    onBeforeUnmount(() => {\n      dragInstance.value.destroy();\n    });\n\n    return {\n      baseClassName,\n      refThumb,\n      refPanel,\n      styles,\n    };\n  },\n  render() {\n    const { baseClassName, className, railStyle, styles, type, color } = this;\n    const paddingStyle = {\n      background: `linear-gradient(90deg, rgba(0,0,0,.0) 0%, rgba(0,0,0,.0) 93%, ${color.rgb} 93%, ${color.rgb} 100%)`,\n    };\n    return (\n      <div class={[`${baseClassName}__slider-wrapper`, `${baseClassName}__slider-wrapper--${type}-type`]}>\n        {type === 'alpha' && <div className={`${baseClassName}__slider-padding`} style={paddingStyle} />}\n        <div class={[`${baseClassName}__slider`, className]} ref=\"refPanel\">\n          <div class={`${baseClassName}__rail`} style={railStyle}></div>\n          <span class={[`${baseClassName}__thumb`]} role=\"slider\" tabindex={0} ref=\"refThumb\" style={styles}></span>\n        </div>\n      </div>\n    );\n  },\n});\n"],"names":["defineComponent","name","props","baseProps","className","type","String","value","Number","maxValue","railStyle","Object","setup","baseClassName","useBaseClassName","refPanel","ref","refThumb","dragInstance","panelRect","reactive","width","SLIDER_DEFAULT_WIDTH","styles","computed","left","Math","round","color","rgb","handleDrag","coordinate","isEnded","disabled","x","onChange","handleDragEnd","onMounted","offsetWidth","Draggable","start","drag","end","onBeforeUnmount","destroy","render","paddingStyle","background","_createVNode"],"mappings":"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"}