{"version":3,"file":"tr.js","sources":["../../src/table/tr.tsx"],"sourcesContent":["import {\n  defineComponent,\n  PropType,\n  SetupContext,\n  h,\n  computed,\n  ref,\n  reactive,\n  onMounted,\n  onBeforeUnmount,\n  toRefs,\n} from 'vue';\nimport isFunction from 'lodash/isFunction';\nimport upperFirst from 'lodash/upperFirst';\nimport isString from 'lodash/isString';\nimport pick from 'lodash/pick';\nimport get from 'lodash/get';\nimport { formatRowAttributes, formatRowClassNames } from './utils';\nimport { getRowFixedStyles, getColumnFixedStyles } from './hooks/useFixed';\nimport useClassName from './hooks/useClassName';\nimport TEllipsis from './ellipsis';\nimport { BaseTableCellParams, TableRowData, RowspanColspan, TdPrimaryTableProps, TdBaseTableProps } from './type';\nimport baseTableProps from './base-table-props';\nimport useLazyLoad from './hooks/useLazyLoad';\nimport { RowAndColFixedPosition } from './interface';\nimport { getCellKey, SkipSpansValue } from './hooks/useRowspanAndColspan';\n\nexport interface RenderTdExtra {\n  rowAndColFixedPosition: RowAndColFixedPosition;\n  columnLength: number;\n  dataLength: number;\n  cellSpans: RowspanColspan;\n  cellEmptyContent: TdBaseTableProps['cellEmptyContent'];\n}\n\nexport interface RenderEllipsisCellParams {\n  cellNode: any;\n}\n\nexport type TrCommonProps = Pick<TdPrimaryTableProps, TrPropsKeys>;\n\nexport const TABLE_PROPS = [\n  'rowKey',\n  'rowClassName',\n  'columns',\n  'fixedRows',\n  'footData',\n  'rowAttributes',\n  'rowspanAndColspan',\n  'scroll',\n  'cellEmptyContent',\n  'onCellClick',\n  'onRowClick',\n  'onRowDblclick',\n  'onRowMouseover',\n  'onRowMousedown',\n  'onRowMouseenter',\n  'onRowMouseleave',\n  'onRowMouseup',\n] as const;\n\nexport type TrPropsKeys = typeof TABLE_PROPS[number];\n\nexport interface TrProps extends TrCommonProps {\n  rowKey: string;\n  row: TableRowData;\n  rowIndex: number;\n  dataLength: number;\n  rowAndColFixedPosition?: RowAndColFixedPosition;\n  skipSpansMap?: Map<string, SkipSpansValue>;\n  scrollType?: string;\n  isVirtual?: boolean;\n  rowHeight?: number;\n  trs?: Map<number, object>;\n  bufferSize?: number;\n  tableElm?: any;\n  // HTMLDivElement\n  tableContentElm?: any;\n  cellEmptyContent: TdBaseTableProps['cellEmptyContent'];\n}\n\nexport const ROW_LISTENERS = ['click', 'dblclick', 'mouseover', 'mousedown', 'mouseenter', 'mouseleave', 'mouseup'];\n\nexport function renderCell(\n  params: BaseTableCellParams<TableRowData>,\n  slots: SetupContext['slots'],\n  extra?: {\n    cellEmptyContent?: TdBaseTableProps['cellEmptyContent'];\n  },\n) {\n  const { col, row } = params;\n  if (isFunction(col.cell)) {\n    return col.cell(h, params);\n  }\n  if (slots[col.colKey]) {\n    return slots[col.colKey](params);\n  }\n  if (isString(col.cell) && slots[col.cell]) {\n    return slots[col.cell](params);\n  }\n  if (isFunction(col.render)) {\n    return col.render(h, { ...params, type: 'cell' });\n  }\n  const r = get(row, col.colKey);\n  // 0 和 false 属于正常可用之，不能使用兜底逻辑 cellEmptyContent\n  if (![undefined, '', null].includes(r)) return r;\n  // cellEmptyContent 作为空数据兜底显示，用户可自定义\n  if (extra?.cellEmptyContent) {\n    return isFunction(extra.cellEmptyContent) ? extra.cellEmptyContent(h, params) : extra.cellEmptyContent;\n  }\n  if (slots.cellEmptyContent) return slots.cellEmptyContent(params);\n  return r;\n}\n\n// 表格行组件\nexport default defineComponent({\n  name: 'TR',\n\n  props: {\n    row: Object as PropType<TableRowData>,\n    rowIndex: Number,\n    dataLength: Number,\n    rowAndColFixedPosition: Map as PropType<RowAndColFixedPosition>,\n    // 合并单元格，是否跳过渲染\n    skipSpansMap: Map as PropType<TrProps['skipSpansMap']>,\n    ...pick(baseTableProps, TABLE_PROPS),\n    scrollType: String,\n    rowHeight: Number,\n    trs: Map as PropType<TrProps['trs']>,\n    bufferSize: Number,\n    isVirtual: Boolean,\n    // eslint-disable-next-line\n    tableElm: {},\n    // eslint-disable-next-line\n    tableContentElm: {},\n  },\n\n  emits: ['row-mounted'],\n\n  setup(props: TrProps, context: SetupContext) {\n    const { tableContentElm } = toRefs(props);\n    const trRef = ref(null);\n    const {\n      tdEllipsisClass,\n      tableBaseClass,\n      tableColFixedClasses,\n      tableRowFixedClasses,\n      tdAlignClasses,\n      tableDraggableClasses,\n    } = useClassName();\n    const trStyles = computed(() =>\n      getRowFixedStyles(\n        get(props.row, props.rowKey || 'id'),\n        props.rowIndex,\n        props.dataLength,\n        props.fixedRows,\n        props.rowAndColFixedPosition,\n        tableRowFixedClasses,\n      ),\n    );\n\n    const trAttributes = computed(\n      () => formatRowAttributes(props.rowAttributes, { row: props.row, rowIndex: props.rowIndex, type: 'body' }) || {},\n    );\n\n    const classes = computed(() => {\n      const customClasses = formatRowClassNames(\n        props.rowClassName,\n        { row: props.row, rowIndex: props.rowIndex, type: 'body' },\n        props.rowKey || 'id',\n      );\n      return [trStyles.value?.classes, customClasses].filter((v) => v);\n    });\n\n    const { hasLazyLoadHolder, tRowHeight } = useLazyLoad(\n      tableContentElm,\n      trRef,\n      reactive({ ...props.scroll, rowIndex: props.rowIndex }),\n    );\n\n    const getTrListeners = (row: TableRowData, rowIndex: number) => {\n      const trListeners: { [eventName: string]: (e: MouseEvent) => void } = {};\n      // add events to row\n      ROW_LISTENERS.forEach((eventName) => {\n        trListeners[`on${upperFirst(eventName)}`] = (e: MouseEvent) => {\n          const p = { e, row, index: rowIndex };\n          props[`onRow${upperFirst(eventName)}`]?.(p);\n        };\n      });\n      return trListeners;\n    };\n\n    onMounted(() => {\n      const { scrollType, isVirtual, row: rowData, trs } = props;\n      if (scrollType === 'virtual') {\n        if (isVirtual) {\n          const { $index } = rowData;\n          trs.set($index, trRef.value);\n          context.emit('row-mounted');\n        }\n      }\n    });\n\n    onBeforeUnmount(() => {\n      if (props.isVirtual) {\n        const { trs, row } = props;\n        const { $index } = row;\n        trs.delete($index);\n      }\n    });\n\n    return {\n      trRef,\n      tableColFixedClasses,\n      tSlots: context.slots,\n      tdEllipsisClass,\n      tableBaseClass,\n      tdAlignClasses,\n      tableDraggableClasses,\n      trStyles,\n      classes,\n      trAttributes,\n      tRowHeight,\n      hasLazyLoadHolder,\n      getTrListeners,\n    };\n  },\n\n  methods: {\n    renderEllipsisCell(cellParams: BaseTableCellParams<TableRowData>, params: RenderEllipsisCellParams) {\n      const { cellNode } = params;\n      const { col, colIndex } = cellParams;\n      // 前两列左对齐显示\n      const placement = colIndex < 2 ? 'top-left' : 'top-right';\n      const content = isFunction(col.ellipsis) ? col.ellipsis(h, cellParams) : undefined;\n      const tableElement = this.tableElm as HTMLDivElement;\n      return (\n        <TEllipsis\n          placement={placement}\n          attach={tableElement ? () => tableElement : undefined}\n          tooltipContent={content && (() => content)}\n          tooltipProps={typeof col.ellipsis === 'object' ? col.ellipsis : undefined}\n        >\n          {cellNode}\n        </TEllipsis>\n      );\n    },\n\n    renderTd(params: BaseTableCellParams<TableRowData>, extra: RenderTdExtra) {\n      const { col, colIndex, rowIndex } = params;\n      const { cellSpans, dataLength, rowAndColFixedPosition } = extra;\n      const cellNode = renderCell(params, this.tSlots, { cellEmptyContent: extra.cellEmptyContent });\n      const tdStyles = getColumnFixedStyles(col, colIndex, rowAndColFixedPosition, this.tableColFixedClasses);\n      const customClasses = isFunction(col.className) ? col.className({ ...params, type: 'td' }) : col.className;\n      const classes = [\n        tdStyles.classes,\n        customClasses,\n        {\n          [this.tdEllipsisClass]: col.ellipsis,\n          [this.tableBaseClass.tdLastRow]: rowIndex + cellSpans.rowspan === dataLength,\n          [this.tableBaseClass.tdFirstCol]: colIndex === 0 && this.rowspanAndColspan,\n          [this.tdAlignClasses[col.align]]: col.align && col.align !== 'left',\n          // 标记可拖拽列\n          [this.tableDraggableClasses.handle]: col.colKey === 'drag',\n        },\n      ];\n      const onClick = (e: MouseEvent) => {\n        const p = { ...params, e };\n        this.onCellClick?.(p);\n      };\n      const attrs = { ...col.attrs, ...cellSpans };\n      return (\n        <td key={`${col.colKey}_${colIndex}`} class={classes} style={tdStyles.style} {...attrs} onClick={onClick}>\n          {col.ellipsis ? this.renderEllipsisCell(params, { cellNode }) : cellNode}\n        </td>\n      );\n    },\n  },\n\n  render() {\n    const { row, rowIndex, dataLength, rowAndColFixedPosition } = this;\n    const columVNodeList = this.columns?.map((col, colIndex) => {\n      const cellSpans: RowspanColspan = {};\n      const params = {\n        row,\n        col,\n        rowIndex,\n        colIndex,\n      };\n      let spanState = null;\n      if (this.skipSpansMap.size) {\n        const cellKey = getCellKey(row, this.rowKey, col.colKey, colIndex);\n        spanState = this.skipSpansMap.get(cellKey) || {};\n        spanState?.rowspan > 1 && (cellSpans.rowspan = spanState.rowspan);\n        spanState?.colspan > 1 && (cellSpans.colspan = spanState.colspan);\n        if (spanState.skipped) return null;\n      }\n      return this.renderTd(params, {\n        dataLength,\n        rowAndColFixedPosition,\n        columnLength: this.columns.length,\n        cellSpans,\n        cellEmptyContent: this.cellEmptyContent,\n      });\n    });\n    return (\n      <tr\n        ref=\"trRef\"\n        {...this.trAttributes}\n        style={this.trStyles?.style}\n        class={this.classes}\n        {...this.getTrListeners(row, rowIndex)}\n      >\n        {this.hasLazyLoadHolder ? [<td style={{ height: `${this.tRowHeight}px`, border: 'none' }} />] : columVNodeList}\n      </tr>\n    );\n  },\n});\n"],"names":["TABLE_PROPS","ROW_LISTENERS","renderCell","params","slots","extra","col","row","isFunction","cell","h","colKey","isString","render","type","r","get","includes","cellEmptyContent","defineComponent","name","props","Object","rowIndex","Number","dataLength","rowAndColFixedPosition","Map","skipSpansMap","pick","baseTableProps","scrollType","String","rowHeight","trs","bufferSize","isVirtual","Boolean","tableElm","tableContentElm","emits","setup","context","toRefs","trRef","ref","useClassName","tdEllipsisClass","tableBaseClass","tableColFixedClasses","tableRowFixedClasses","tdAlignClasses","tableDraggableClasses","trStyles","computed","getRowFixedStyles","rowKey","fixedRows","trAttributes","formatRowAttributes","rowAttributes","classes","customClasses","formatRowClassNames","rowClassName","value","filter","v","useLazyLoad","reactive","scroll","hasLazyLoadHolder","tRowHeight","getTrListeners","trListeners","forEach","eventName","upperFirst","e","p","index","onMounted","rowData","$index","set","emit","onBeforeUnmount","tSlots","methods","renderEllipsisCell","cellParams","cellNode","colIndex","placement","content","ellipsis","tableElement","_createVNode","TEllipsis","_typeof","renderTd","cellSpans","tdStyles","getColumnFixedStyles","className","_defineProperty","tdLastRow","rowspan","tdFirstCol","rowspanAndColspan","align","handle","onClick","onCellClick","attrs","_mergeProps","style","columVNodeList","columns","map","spanState","size","cellKey","getCellKey","colspan","skipped","columnLength","length","height","border"],"mappings":"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"}