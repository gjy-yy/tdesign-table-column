{"version":3,"file":"useRowSelect.js","sources":["../../../src/table/hooks/useRowSelect.tsx"],"sourcesContent":["// 行选中相关功能：单选 + 多选\n\nimport { computed, toRefs, h, ref, watch } from 'vue';\nimport intersection from 'lodash/intersection';\nimport get from 'lodash/get';\nimport isFunction from 'lodash/isFunction';\nimport useDefaultValue from '../../hooks/useDefaultValue';\nimport {\n  PrimaryTableCellParams,\n  PrimaryTableCol,\n  RowClassNameParams,\n  TableRowData,\n  TdPrimaryTableProps,\n} from '../type';\nimport { isRowSelectedDisabled } from '../../_common/js/table/utils';\nimport { TableClassName } from './useClassName';\nimport Checkbox from '../../checkbox';\nimport Radio from '../../radio';\nimport log from '../../_common/js/log';\n\nexport default function useRowSelect(\n  props: TdPrimaryTableProps,\n  tableSelectedClasses: TableClassName['tableSelectedClasses'],\n) {\n  const { selectedRowKeys, columns, data, rowKey } = toRefs(props);\n  const selectedRowClassNames = ref();\n  const [tSelectedRowKeys, setTSelectedRowKeys] = useDefaultValue(\n    selectedRowKeys,\n    props.defaultSelectedRowKeys || [],\n    props.onSelectChange,\n    'selectedRowKeys',\n  );\n  const selectedRowDataMap = ref(new Map<string | number, TableRowData>());\n  const selectColumn = computed(() => props.columns.find(({ type }) => ['multiple', 'single'].includes(type)));\n  const canSelectedRows = computed(() => data.value.filter((row, rowIndex): boolean => !isDisabled(row, rowIndex)));\n  // 选中的行，和所有可以选择的行，交集，用于计算 isSelectedAll 和 isIndeterminate\n  const intersectionKeys = computed(() =>\n    intersection(\n      tSelectedRowKeys.value,\n      canSelectedRows.value.map((t) => get(t, props.rowKey || 'id')),\n    ),\n  );\n\n  watch(\n    [data, columns, tSelectedRowKeys, selectColumn, rowKey],\n    () => {\n      const disabledRowFunc = (p: RowClassNameParams<TableRowData>) =>\n        selectColumn.value.disabled(p) ? tableSelectedClasses.disabled : '';\n      const disabledRowClass = selectColumn.value?.disabled ? disabledRowFunc : undefined;\n      const selected = new Set(tSelectedRowKeys.value);\n      const selectedRowClassFunc = ({ row }: RowClassNameParams<TableRowData>) => {\n        const rowId = get(row, props.rowKey || 'id');\n        return selected.has(rowId) ? tableSelectedClasses.selected : '';\n      };\n      const selectedRowClass = selected.size ? selectedRowClassFunc : undefined;\n      selectedRowClassNames.value = [disabledRowClass, selectedRowClass];\n    },\n    { immediate: true },\n  );\n\n  function isDisabled(row: Record<string, any>, rowIndex: number): boolean {\n    return isRowSelectedDisabled(selectColumn.value, row, rowIndex);\n  }\n\n  function getSelectedHeader() {\n    return () => {\n      const isIndeterminate =\n        intersectionKeys.value.length > 0 && intersectionKeys.value.length < canSelectedRows.value.length;\n      const isChecked =\n        intersectionKeys.value.length !== 0 &&\n        canSelectedRows.value.length !== 0 &&\n        intersectionKeys.value.length === canSelectedRows.value.length;\n      return (\n        <Checkbox\n          checked={isChecked}\n          indeterminate={isIndeterminate}\n          disabled={!canSelectedRows.value.length}\n          onChange={handleSelectAll}\n        />\n      );\n    };\n  }\n\n  function renderSelectCell(p: PrimaryTableCellParams<TableRowData>) {\n    const { col: column, row = {}, rowIndex } = p;\n    const checked = tSelectedRowKeys.value.includes(get(row, props.rowKey || 'id'));\n    const disabled: boolean =\n      typeof column.disabled === 'function' ? column.disabled({ row, rowIndex }) : column.disabled;\n    const checkProps = isFunction(column.checkProps) ? column.checkProps({ row, rowIndex }) : column.checkProps;\n    const selectBoxProps: Object = {\n      checked,\n      disabled,\n      ...checkProps,\n      // 兼容处理不同的参数\n      onClick: (e: MouseEvent | { e: MouseEvent }) => {\n        // 选中行功能中，点击 checkbox/radio 需阻止事件冒泡，避免触发不必要的 onRowClick\n        if (typeof e === 'object' && 'e' in e) {\n          e.e?.stopPropagation();\n        } else {\n          e?.stopPropagation();\n        }\n      },\n      onChange: () => handleSelectChange(row),\n    };\n    if (column.type === 'single') return <Radio {...selectBoxProps} />;\n    if (column.type === 'multiple') {\n      const isIndeterminate = props.indeterminateSelectedRowKeys?.length\n        ? props.indeterminateSelectedRowKeys.includes(get(row, props.rowKey))\n        : false;\n      return <Checkbox indeterminate={isIndeterminate} {...selectBoxProps} />;\n    }\n    return null;\n  }\n\n  function handleSelectChange(row: TableRowData = {}) {\n    let selectedRowKeys = [...tSelectedRowKeys.value];\n    const reRowKey = props.rowKey || 'id';\n    const id = get(row, reRowKey);\n    selectedRowDataMap.value.set(id, row);\n    const selectedRowIndex = selectedRowKeys.indexOf(id);\n    const isExisted = selectedRowIndex !== -1;\n    if (selectColumn.value.type === 'multiple') {\n      isExisted ? selectedRowKeys.splice(selectedRowIndex, 1) : selectedRowKeys.push(id);\n    } else if (selectColumn.value.type === 'single') {\n      selectedRowKeys = !isExisted ? [id] : [];\n    } else {\n      log.warn('Table', '`column.type` must be one of `multiple` and `single`');\n      return;\n    }\n    setTSelectedRowKeys(selectedRowKeys, {\n      selectedRowData: selectedRowKeys.map((t) => selectedRowDataMap.value.get(t)),\n      currentRowKey: id,\n      currentRowData: row,\n      type: isExisted ? 'uncheck' : 'check',\n    });\n  }\n\n  function handleSelectAll(checked: boolean) {\n    const reRowKey = props.rowKey || 'id';\n    const canSelectedRowKeys = canSelectedRows.value.map((record) => get(record, reRowKey));\n    const disabledSelectedRowKeys = selectedRowKeys.value?.filter((id) => !canSelectedRowKeys.includes(id)) || [];\n    const allIds = checked ? [...disabledSelectedRowKeys, ...canSelectedRowKeys] : [...disabledSelectedRowKeys];\n    setTSelectedRowKeys(allIds, {\n      selectedRowData: checked ? allIds.map((t) => selectedRowDataMap.value.get(t)) : [],\n      type: checked ? 'check' : 'uncheck',\n      currentRowKey: 'CHECK_ALL_BOX',\n    });\n  }\n\n  function formatToRowSelectColumn(col: PrimaryTableCol) {\n    const isSelection = ['multiple', 'single'].includes(col.type);\n    if (!isSelection) return col;\n    return {\n      ...col,\n      width: col.width || 64,\n      className: [tableSelectedClasses.checkCell, col.className],\n      cell: (_: typeof h, p: PrimaryTableCellParams<TableRowData>) => renderSelectCell(p),\n      title: col.type === 'multiple' ? getSelectedHeader() : '',\n    };\n  }\n\n  watch(\n    [data, rowKey],\n    ([data, rowKey]) => {\n      for (let i = 0, len = data.length; i < len; i++) {\n        selectedRowDataMap.value.set(get(data[i], rowKey || 'id'), data[i]);\n      }\n    },\n    { immediate: true },\n  );\n\n  return {\n    selectedRowClassNames,\n    formatToRowSelectColumn,\n  };\n}\n"],"names":["useRowSelect","props","tableSelectedClasses","toRefs","selectedRowKeys","columns","data","rowKey","selectedRowClassNames","ref","useDefaultValue","defaultSelectedRowKeys","onSelectChange","_slicedToArray","tSelectedRowKeys","setTSelectedRowKeys","selectedRowDataMap","Map","selectColumn","computed","find","type","includes","canSelectedRows","value","filter","row","rowIndex","isDisabled","intersectionKeys","intersection","map","t","get","watch","disabledRowFunc","p","disabled","disabledRowClass","selected","Set","selectedRowClassFunc","rowId","has","selectedRowClass","size","immediate","isRowSelectedDisabled","getSelectedHeader","isIndeterminate","length","isChecked","_createVNode","Checkbox","handleSelectAll","renderSelectCell","column","col","checked","checkProps","isFunction","selectBoxProps","onClick","e","_typeof","stopPropagation","onChange","handleSelectChange","indeterminateSelectedRowKeys","_mergeProps","_toConsumableArray","reRowKey","id","set","selectedRowIndex","indexOf","isExisted","splice","push","log","warn","selectedRowData","currentRowKey","currentRowData","canSelectedRowKeys","record","disabledSelectedRowKeys","allIds","formatToRowSelectColumn","isSelection","width","className","checkCell","cell","_","title","i","len"],"mappings":"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"}