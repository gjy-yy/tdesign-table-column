{"version":3,"file":"slot.js","sources":["../../src/hooks/slot.ts"],"sourcesContent":["import { Slots, VNode, Component, getCurrentInstance, Fragment, Comment } from 'vue';\n\n/**\n * 渲染default slot，获取子组件VNode。处理多种子组件创建场景\n * 使用场景：<t-steps> <t-steps-item /> </t-steps>, <t-steps> <t-steps-item v-for=\"(item, index)\" :key=\"index\" /> </t-steps>\n * @returns {function(childComponentName: string, slots: Slots): VNode[]}\n * @param childComponentName\n * @param slots\n * @example const getChildByName = useChildComponentSlots()\n * @example getChildComponentByName('TStepItem')\n */\nexport function useChildComponentSlots() {\n  const instance = getCurrentInstance();\n  return (childComponentName: string, slots?: Slots): VNode[] => {\n    if (!slots) {\n      slots = instance.slots;\n    }\n    const content = slots?.default?.() || [];\n\n    // 满足基于基础组件封装场景，递归找到子组件\n    const childList: VNode[] = [];\n    const getChildren = (content: VNode[]) => {\n      if (!Array.isArray(content)) return;\n      content.forEach((item: VNode) => {\n        if (item.children && Array.isArray(item.children)) {\n          if (item.type !== Fragment) return;\n          getChildren(item.children as VNode[]);\n        } else {\n          childList.push(item);\n        }\n      });\n      return childList;\n    };\n\n    return getChildren(content).filter((item: VNode) =>\n      (item.type as Component).name?.endsWith(childComponentName),\n    ) as VNode[];\n  };\n}\n\n/**\n * 渲染default slot，获取slot child\n * @param childComponentName\n * @param slots\n * @example const getChildSlots = useChildSlots()\n * @example getChildSlots()\n */\nexport function useChildSlots() {\n  const instance = getCurrentInstance();\n  return () => {\n    const { slots } = instance;\n    const content = slots?.default?.() || [];\n\n    return content\n      .filter((item) => {\n        return item.type !== Comment;\n      })\n      .map((item) => {\n        if (item.children && Array.isArray(item.children) && item.type === Fragment) return item.children;\n        return item;\n      })\n      .flat();\n  };\n}\n"],"names":["useChildComponentSlots","instance","getCurrentInstance","childComponentName","slots","content","childList","getChildren","Array","isArray","forEach","item","children","type","Fragment","push","filter","name","endsWith","useChildSlots","Comment","map","flat"],"mappings":";;;;;;;;;;;;AAWO,SAASA,sBAAT,GAAkC;EACvC,IAAMC,WAAWC,sBAAmB,EAApC,CAAA;AACO,EAAA,OAAA,UAACC,kBAAD,EAA6BC,KAA7B,EAAwD;AAAA,IAAA,IAAA,MAAA,EAAA,cAAA,CAAA;;IAC7D,IAAI,CAACA,KAAL,EAAY;MACVA,KAAA,GAAQH,QAAS,CAAAG,KAAjB,CAAA;AACF,KAAA;;AACA,IAAA,IAAMC,OAAU,GAAA,CAAA,CAAA,MAAA,GAAAD,KAAA,MAAA,IAAA,uJAAsB,EAAtC,CAAA;IAGA,IAAME,YAAqB,EAA3B,CAAA;;AACM,IAAA,IAAAC,WAAA,GAAc,SAAdA,WAAc,CAACF,QAAD,EAAsB;AACpC,MAAA,IAAA,CAACG,KAAM,CAAAC,OAAN,CAAcJ,QAAd,CAAD,EAAyB,OAAA;AAC7BA,MAAAA,QAAAA,CAAQK,OAARL,CAAgB,UAACM,IAAD,EAAiB;AAC/B,QAAA,IAAIA,KAAKC,QAAL,IAAiBJ,KAAA,CAAMC,OAAN,CAAcE,IAAA,CAAKC,QAAnB,CAArB,EAAmD;AACjD,UAAA,IAAID,KAAKE,IAAL,KAAcC,YAAlB,EAA4B,OAAA;AAC5BP,UAAAA,WAAA,CAAYI,KAAKC,QAAjB,CAAA,CAAA;AACK,SAHP,MAGO;UACLN,SAAA,CAAUS,IAAV,CAAeJ,IAAf,CAAA,CAAA;AACF,SAAA;OANFN,CAAAA,CAAAA;AAQO,MAAA,OAAAC,SAAA,CAAA;KAVH,CAAA;;IAaC,OAAAC,WAAA,CAAYF,OAAZ,CAAA,CAAqBW,MAArB,CAA4B,UAACL,IAAD,EAAA;AAAA,MAAA,IAAA,eAAA,CAAA;;MAAA,OAChCA,CAAAA,eAAAA,GAAAA,IAAA,CAAKE,IAAL,CAAwBI,IADQ,oDAChC,eAA8BC,CAAAA,QAA9B,CAAuCf,kBAAvC,CADgC,CAAA;AAAA,KAA5B,CAAA,CAAA;GArBF,CAAA;AAyBT,CAAA;AASO,SAASgB,aAAT,GAAyB;EAC9B,IAAMlB,WAAWC,sBAAmB,EAApC,CAAA;AACA,EAAA,OAAO,YAAM;AAAA,IAAA,IAAA,eAAA,CAAA;;AACL,IAAA,IAAEE,KAAF,GAAYH,QAAZ,CAAEG,KAAF,CAAA;AACN,IAAA,IAAMC,OAAU,GAAA,CAAAD,KAAA,SAAA,IAAAA,KAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,CAAA,eAAA,GAAAA,KAAA,CAAA,SAAA,CAAA,MAAAA,IAAAA,IAAAA,eAAAA,KAAAA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,eAAAA,CAAAA,IAAAA,CAAAA,KAAA,MAAsB,EAAtC,CAAA;AAEO,IAAA,OAAAC,OAAA,CACJW,MADI,CACG,UAACL,IAAD,EAAU;AAChB,MAAA,OAAOA,KAAKE,IAAL,KAAcO,WAArB,CAAA;AACD,KAHI,CAIJC,CAAAA,GAJI,CAIA,UAACV,IAAD,EAAU;MACT,IAAAA,IAAA,CAAKC,QAAL,IAAiBJ,KAAM,CAAAC,OAAN,CAAcE,KAAKC,QAAnB,CAAjB,IAAiDD,KAAKE,IAAL,KAAcC,YAA/D,EAAyE,OAAOH,IAAK,CAAAC,QAAZ,CAAA;AACtE,MAAA,OAAAD,IAAA,CAAA;KANJ,CAAA,CAQJW,IARI,EAAA,CAAA;GAJT,CAAA;AAcF;;;;;"}