{"version":3,"file":"switch.js","sources":["../../src/switch/switch.tsx"],"sourcesContent":["import { defineComponent, h, VNodeChild, computed, watch, toRefs } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport TLoading from '../loading';\nimport props from './props';\nimport { TNodeReturnValue } from '../common';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TSwitch',\n  props: { ...props },\n\n  setup(props, { slots }) {\n    const disabled = useFormDisabled();\n    const COMPONENT_NAME = usePrefixClass('switch');\n    const { STATUS, SIZE } = useCommonClassName();\n    // values\n    const { value, modelValue } = toRefs(props);\n    const [innerValue, setSwitchVal] = useVModel(value, modelValue, props.defaultValue, props.onChange);\n\n    const activeValue = computed(() => {\n      if (props.customValue && props.customValue.length > 0) {\n        return props.customValue[0];\n      }\n      return true;\n    });\n    const inactiveValue = computed(() => {\n      if (props.customValue && props.customValue.length > 1) {\n        return props.customValue[1];\n      }\n      return false;\n    });\n\n    // methods\n    function handleToggle() {\n      const checked = innerValue.value === activeValue.value ? inactiveValue.value : activeValue.value;\n      // emits\n      setSwitchVal(checked);\n    }\n\n    function toggle() {\n      if (disabled.value || props.loading) {\n        return;\n      }\n      handleToggle();\n    }\n\n    // classes\n    const classes = computed(() => [\n      `${COMPONENT_NAME.value}`,\n      SIZE.value[props.size],\n      {\n        [STATUS.value.disabled]: disabled.value,\n        [STATUS.value.loading]: props.loading,\n        [STATUS.value.checked]: innerValue.value === activeValue.value || props.modelValue === activeValue.value,\n      },\n    ]);\n    const nodeClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__handle`,\n        {\n          [STATUS.value.disabled]: disabled.value,\n          [STATUS.value.loading]: props.loading,\n        },\n      ];\n    });\n    const contentClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content`,\n        SIZE.value[props.size],\n        {\n          [STATUS.value.disabled]: disabled.value,\n        },\n      ];\n    });\n\n    watch(\n      innerValue,\n      (val) => {\n        if (props.customValue && props.customValue.length && !props.customValue.includes(val)) {\n          throw new Error(`value is not in ${JSON.stringify(props.customValue)}`);\n        }\n      },\n      {\n        immediate: true,\n      },\n    );\n\n    const content = computed<VNodeChild>(() => {\n      if (typeof props.label === 'function') {\n        return props.label(h, { value: innerValue.value });\n      }\n      if (typeof props.label === 'string') {\n        return props.label;\n      }\n      if (Array.isArray(props.label) && props.label.length) {\n        const label = innerValue.value === activeValue.value ? props.label[0] : props.label[1];\n        if (!label) return;\n        if (typeof label === 'string') {\n          return label;\n        }\n        if (typeof label === 'function') {\n          return label(h);\n        }\n      }\n      if (slots.label) {\n        return slots.label({ value: innerValue.value });\n      }\n      return null;\n    });\n    return () => {\n      let switchContent: VNodeChild;\n      let loadingContent: TNodeReturnValue;\n      if (props.loading) {\n        loadingContent = <TLoading size=\"small\" />;\n      } else if (content.value) {\n        switchContent = content.value;\n      }\n\n      return (\n        <div class={classes.value} disabled={disabled.value} onClick={toggle}>\n          <span class={nodeClasses.value}>{loadingContent}</span>\n          <div class={contentClasses.value}>{switchContent}</div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","slots","disabled","useFormDisabled","COMPONENT_NAME","usePrefixClass","useCommonClassName","STATUS","SIZE","toRefs","value","modelValue","useVModel","defaultValue","onChange","_slicedToArray","innerValue","setSwitchVal","activeValue","computed","customValue","length","inactiveValue","handleToggle","checked","toggle","loading","classes","size","_defineProperty","nodeClasses","contentClasses","watch","val","includes","Error","JSON","stringify","immediate","content","label","h","Array","isArray","switchContent","loadingContent","_createVNode","TLoading"],"mappings":"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"}