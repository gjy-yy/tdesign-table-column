{"version":3,"file":"calcTextareaHeight.js","sources":["../../../../src/_common/js/utils/calcTextareaHeight.ts"],"sourcesContent":["import { calculateNodeSize } from './helper';\n\ntype CalculateStyleType = {\n  height?: string,\n  minHeight?: string\n};\n\ntype LimitType = number | null;\n\nconst TEXTAREA_STYLE = `\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important\n`;\n\nlet hiddenTextarea: HTMLTextAreaElement;\n\nfunction calcTextareaHeight(\n  targetElement: HTMLTextAreaElement,\n  minRows: LimitType = 1,\n  maxRows: LimitType = null,\n): CalculateStyleType {\n  if (!hiddenTextarea) {\n    hiddenTextarea = document.createElement('textarea');\n    document.body.appendChild(hiddenTextarea);\n  }\n\n  const {\n    paddingSize,\n    borderSize,\n    boxSizing,\n    sizingStyle,\n  } = calculateNodeSize(targetElement);\n\n  hiddenTextarea.setAttribute('style', `${sizingStyle};${TEXTAREA_STYLE}`);\n  hiddenTextarea.value = targetElement.value || targetElement.placeholder || '';\n\n  let height = hiddenTextarea.scrollHeight;\n  const result: CalculateStyleType = {};\n  const isBorderbox = boxSizing === 'border-box';\n  const isContentbox = boxSizing === 'content-box';\n\n  if (isBorderbox) {\n    height += borderSize;\n  } else if (isContentbox) {\n    height -= paddingSize;\n  }\n\n  hiddenTextarea.value = '';\n  const singleRowHeight = hiddenTextarea.scrollHeight - paddingSize;\n  hiddenTextarea?.parentNode?.removeChild(hiddenTextarea);\n  // @ts-ignore\n  hiddenTextarea = null;\n\n  const calcHeight = (rows: number) => {\n    let rowsHeight = singleRowHeight * rows;\n    if (isBorderbox) {\n      rowsHeight = rowsHeight + paddingSize + borderSize;\n    }\n    return rowsHeight;\n  };\n\n  if (minRows !== null) {\n    const minHeight = calcHeight(minRows);\n    height = Math.max(minHeight, height);\n    result.minHeight = `${minHeight}px`;\n  }\n  if (maxRows !== null) {\n    height = Math.min(calcHeight(maxRows), height);\n  }\n  result.height = `${height}px`;\n  return result;\n}\n\nexport default calcTextareaHeight;\n"],"names":["TEXTAREA_STYLE","hiddenTextarea","calcTextareaHeight","targetElement","minRows","maxRows","document","createElement","body","appendChild","calculateNodeSize","paddingSize","borderSize","boxSizing","sizingStyle","setAttribute","value","placeholder","height","scrollHeight","result","isBorderbox","isContentbox","singleRowHeight","parentNode","removeChild","calcHeight","rows","rowsHeight","minHeight","Math","max","min"],"mappings":"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"}