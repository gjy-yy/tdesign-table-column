{"version":3,"file":"radio.js","sources":["../../src/radio/radio.tsx"],"sourcesContent":["import { defineComponent, inject, toRefs, computed } from 'vue';\nimport { usePrefixClass, useCommonClassName } from '../hooks/useConfig';\nimport { omit } from '../utils/helper';\nimport props from './props';\nimport { RadioGroupInjectionKey, RadioButtonInjectionKey } from './constants';\n\n// hooks\nimport { useFormDisabled } from '../form/hooks';\nimport useVModel from '../hooks/useVModel';\nimport { useContent } from '../hooks/tnode';\n\nfunction getValidAttrs(obj: Record<string, any>): Record<string, any> {\n  const newObj = {};\n  Object.keys(obj).forEach((key) => {\n    if (typeof obj[key] !== 'undefined') {\n      newObj[key] = obj[key];\n    }\n  });\n  return newObj;\n}\n\nexport default defineComponent({\n  name: 'TRadio',\n  inheritAttrs: false,\n  props: { ...props },\n\n  setup(props, { attrs }) {\n    const { checked, modelValue } = toRefs(props);\n    const [innerChecked, setInnerChecked] = useVModel(\n      checked,\n      modelValue,\n      props.defaultChecked,\n      props.onChange,\n      'checked',\n    );\n    const radioChecked = computed(() => (radioGroup ? props.value === radioGroup.value : innerChecked.value));\n\n    const radioGroup = inject(RadioGroupInjectionKey, undefined);\n\n    /** Event */\n    const handleChange = (e: Event) => {\n      if (radioGroup?.setValue) {\n        radioGroup.setValue(props.value, { e });\n      } else {\n        const { checked } = e.target as HTMLInputElement;\n        setInnerChecked(checked, { e });\n      }\n    };\n    const handleClick = (e: MouseEvent) => {\n      e.stopPropagation();\n      props.onClick?.({ e });\n      if (!radioChecked.value || !props.allowUncheck) return;\n      if (radioGroup) {\n        radioGroup.setValue(undefined, { e });\n      } else {\n        setInnerChecked(false, { e });\n      }\n    };\n    const inputEvents = computed(() =>\n      getValidAttrs({\n        focus: attrs.onFocus,\n        blur: attrs.onBlur,\n        keydown: attrs.onKeydown,\n        keyup: attrs.onKeyup,\n        keypresss: attrs.onKeypresss,\n      }),\n    );\n    const wrapperAttrs = computed(() => {\n      const events = [...Object.keys(inputEvents.value), 'input', 'change'].map(\n        (str) => `on${str[0].toUpperCase()}${str.slice(1)}`,\n      );\n      return omit(attrs, events);\n    });\n    /** Event END */\n\n    // extend radioGroup disabled props\n    const groupDisabled = computed(() => radioGroup?.disabled);\n    const disabled = useFormDisabled(groupDisabled);\n\n    // attribute\n    const inputProps = computed(() => ({\n      name: radioGroup ? radioGroup.name : props.name,\n      checked: radioChecked.value,\n      disabled: disabled.value,\n      value: props.value,\n    }));\n\n    /** Style */\n    const { STATUS } = useCommonClassName();\n    const radioButton = inject(RadioButtonInjectionKey, undefined);\n    const radioBtnName = usePrefixClass('radio-button');\n    const COMPONENT_NAME = usePrefixClass('radio');\n    const prefixCls = computed(() => (radioButton ? radioBtnName.value : COMPONENT_NAME.value));\n    const inputClass = computed(() => [\n      `${prefixCls.value}`,\n      {\n        [STATUS.value.checked]: inputProps.value.checked,\n        [STATUS.value.disabled]: inputProps.value.disabled,\n      },\n    ]);\n    /** Style END */\n\n    const renderContent = useContent();\n\n    return () => (\n      <label class={inputClass.value} {...wrapperAttrs.value}>\n        <input\n          type=\"radio\"\n          class={`${prefixCls.value}__former`}\n          {...inputEvents.value}\n          {...inputProps.value}\n          onChange={handleChange}\n          onClick={handleClick}\n        />\n        <span class={`${prefixCls.value}__input`}></span>\n        <span class={`${prefixCls.value}__label`}>{renderContent('default', 'label')}</span>\n      </label>\n    );\n  },\n});\n"],"names":["getValidAttrs","obj","newObj","Object","keys","forEach","key","defineComponent","name","inheritAttrs","props","setup","attrs","toRefs","checked","modelValue","useVModel","defaultChecked","onChange","_slicedToArray","innerChecked","setInnerChecked","radioChecked","computed","radioGroup","value","inject","RadioGroupInjectionKey","handleChange","e","setValue","target","handleClick","stopPropagation","onClick","allowUncheck","inputEvents","focus","onFocus","blur","onBlur","keydown","onKeydown","keyup","onKeyup","keypresss","onKeypresss","wrapperAttrs","events","_toConsumableArray","map","str","toUpperCase","slice","omit","groupDisabled","disabled","useFormDisabled","inputProps","useCommonClassName","STATUS","radioButton","RadioButtonInjectionKey","radioBtnName","usePrefixClass","COMPONENT_NAME","prefixCls","inputClass","renderContent","useContent","_createVNode","_mergeProps"],"mappings":"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"}