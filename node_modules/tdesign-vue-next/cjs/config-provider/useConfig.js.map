{"version":3,"file":"useConfig.js","sources":["../../src/config-provider/useConfig.tsx"],"sourcesContent":["import { computed, h, inject } from 'vue';\nimport _mergeWith from 'lodash/mergeWith';\nimport { defaultGlobalConfig, configProviderInjectKey } from './context';\nimport { GlobalConfigProvider } from './type';\n\nexport * from './type';\n\n/**\n * component globalConfig\n * @param componentName\n * @returns {t, globalConfig}\n * useConfig('pagination')\n */\nexport function useConfig<T extends keyof GlobalConfigProvider>(componentName?: T) {\n  const injectGlobalConfig = inject(configProviderInjectKey, null);\n  const mergedGlobalConfig = computed(() => injectGlobalConfig?.value || defaultGlobalConfig);\n  const globalConfig = computed(() => mergedGlobalConfig.value[componentName]);\n\n  const classPrefix = computed(() => {\n    return mergedGlobalConfig.value.classPrefix;\n  });\n\n  // 处理正则表达式\n  const t = function <T>(pattern: T, ...args: any[]) {\n    const [data] = args;\n    if (typeof pattern === 'string') {\n      if (!data) return pattern;\n      const regular = /\\{\\s*([\\w-]+)\\s*\\}/g;\n      const translated = pattern.replace(regular, (match, key) => {\n        if (data) {\n          return String(data[key]);\n        }\n        return '';\n      });\n      return translated;\n    }\n    if (typeof pattern === 'function') {\n      // 重要：组件的渲染必须存在参数 h，不能移除\n      if (!args.length) return pattern(h);\n      return pattern(...args);\n    }\n    return '';\n  };\n\n  return {\n    t,\n    globalConfig,\n    classPrefix,\n  };\n}\n"],"names":["useConfig","componentName","injectGlobalConfig","inject","configProviderInjectKey","mergedGlobalConfig","computed","value","defaultGlobalConfig","globalConfig","classPrefix","t","pattern","args","data","regular","translated","replace","match","key","String","length","h"],"mappings":";;;;;;;;;;;;;;;;;AAaO,SAASA,SAAT,CAAyDC,aAAzD,EAA4E;AAC3E,EAAA,IAAAC,kBAAA,GAAqBC,UAAO,CAAAC,8CAAA,EAAyB,IAAzB,CAA5B,CAAA;EACN,IAAMC,kBAAqB,GAAAC,YAAA,CAAS,YAAA;IAAA,OAAM,CAAAJ,kBAAA,KAAA,IAAA,IAAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,kBAAA,CAAoBK,KAApB,KAA6BC,0CAAnC,CAAA;AAAA,GAAT,CAA3B,CAAA;EACA,IAAMC,YAAe,GAAAH,YAAA,CAAS,YAAA;AAAA,IAAA,OAAMD,kBAAA,CAAmBE,KAAnB,CAAyBN,aAAzB,CAAN,CAAA;AAAA,GAAT,CAArB,CAAA;AAEM,EAAA,IAAAS,WAAA,GAAcJ,aAAS,YAAM;AACjC,IAAA,OAAOD,mBAAmBE,KAAnB,CAAyBG,WAAhC,CAAA;AACD,IAFK,CAAA;;AAKA,EAAA,IAAAC,CAAA,GAAI,SAAJA,CAAI,CAAaC,OAAb,EAAyC;AAAA,IAAA,KAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAAbC,IAAa,GAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;MAAbA,IAAa,CAAA,IAAA,GAAA,CAAA,CAAA,GAAA,SAAA,CAAA,IAAA,CAAA,CAAA;AAAA,KAAA;;IAC3C,IAACC,IAAD,GAASD,IAAT,CAAA,CAAA,CAAA,CAAA;;AACF,IAAA,IAAA,OAAOD,OAAP,KAAmB,QAAnB,EAA6B;AAC/B,MAAA,IAAI,CAACE,IAAL,EAAkB,OAAAF,OAAA,CAAA;MAClB,IAAMG,OAAU,GAAA,qBAAhB,CAAA;AACA,MAAA,IAAMC,aAAaJ,OAAQ,CAAAK,OAAR,CAAgBF,OAAhB,EAAyB,UAACG,KAAD,EAAQC,GAAR,EAAgB;AAC1D,QAAA,IAAIL,IAAJ,EAAU;AACD,UAAA,OAAAM,MAAA,CAAON,KAAKK,IAAZ,CAAA,CAAA;AACT,SAAA;;AACO,QAAA,OAAA,EAAA,CAAA;AACR,OALkB,CAAnB,CAAA;AAMO,MAAA,OAAAH,UAAA,CAAA;AACT,KAAA;;AACI,IAAA,IAAA,OAAOJ,OAAP,KAAmB,UAAnB,EAA+B;MAEjC,IAAI,CAACC,IAAK,CAAAQ,MAAV,EAAkB,OAAOT,QAAQU,MAAf,CAAA;AACX,MAAA,OAAAV,OAAA,CAAA,KAAA,CAAWC,KAAAA,CAAAA,EAAAA,IAAX,CAAA,CAAA;AACT,KAAA;;AACO,IAAA,OAAA,EAAA,CAAA;GAlBH,CAAA;;EAqBC,OAAA;AACLF,IAAAA,CAAA,EAAAA,CADK;AAELF,IAAAA,YAAA,EAAAA,YAFK;AAGLC,IAAAA,WAAA,EAAAA,WAAAA;GAHK,CAAA;AAKT;;;;"}