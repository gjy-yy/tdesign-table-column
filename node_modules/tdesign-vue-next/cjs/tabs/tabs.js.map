{"version":3,"file":"tabs.js","sources":["../../src/tabs/tabs.tsx"],"sourcesContent":["import { ComponentPublicInstance, defineComponent, provide, Ref, toRefs } from 'vue';\nimport TTabPanel from './tab-panel';\nimport TTabNav from './tab-nav';\nimport { TabValue, TdTabsProps } from './type';\nimport props from './props';\n\nimport { useTNodeJSX } from '../hooks/tnode';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport useVModel from '../hooks/useVModel';\n\nexport interface InjectTabs {\n  value: Ref<TabValue>;\n}\n\nexport default defineComponent({\n  name: 'TTabs',\n\n  props,\n\n  setup(props) {\n    const COMPONENT_NAME = usePrefixClass('tabs');\n    const classPrefix = usePrefixClass();\n    const renderTNodeJSX = useTNodeJSX();\n\n    const { value, modelValue } = toRefs(props);\n    const [tabValue, setTabValue] = useVModel(value, modelValue, props.defaultValue || '', props.onChange);\n\n    provide<InjectTabs>('tabs', { value: tabValue });\n\n    // methods\n    const onTabAdd = (context: { e: MouseEvent }) => {\n      props.onAdd?.({ e: context.e });\n    };\n    const onTabChange = (value: TabValue) => {\n      setTabValue(value);\n    };\n    const onTabRemove = ({ e, value, index }: Parameters<TdTabsProps['onRemove']>[0]) => {\n      props.onRemove({ value, index, e });\n    };\n\n    // render\n    const getSlotPanels = () => {\n      let content = renderTNodeJSX('default');\n      if (!content) return [];\n      content = content\n        .map((item: ComponentPublicInstance) => {\n          if (item.children && Array.isArray(item.children)) return item.children;\n          return item;\n        })\n        .flat()\n        .filter((item: ComponentPublicInstance) => {\n          return item.type.name === 'TTabPanel';\n        });\n\n      return content;\n    };\n    const renderHeader = () => {\n      const panels = (props.list?.length ? props.list : getSlotPanels()) || [];\n      const panelsData = panels.map((item: ComponentPublicInstance) => {\n        const selfItem = item;\n\n        if (item.props) {\n          Object.keys(item.props).forEach((key) => {\n            selfItem[key] = item.props[key];\n          });\n        }\n\n        return selfItem;\n      });\n      const tabNavProps = {\n        theme: props.theme,\n        value: tabValue.value,\n        size: props.size,\n        disabled: props.disabled,\n        placement: props.placement,\n        addable: props.addable,\n        panels: panelsData,\n        dragSort: props.dragSort,\n      };\n      return (\n        <div\n          class={{\n            [`${classPrefix.value}-tabs__header`]: true,\n            [`${classPrefix.value}-is-${props.placement}`]: true,\n          }}\n        >\n          <TTabNav\n            {...tabNavProps}\n            onDragSort={props.onDragSort}\n            onChange={onTabChange}\n            onAdd={onTabAdd}\n            onRemove={onTabRemove}\n          />\n        </div>\n      );\n    };\n    const renderContent = () => {\n      const panels = getSlotPanels();\n      if (props.list?.length) {\n        return props.list.map((item) => <TTabPanel {...item} onRemove={onTabRemove} />);\n      }\n      if (panels && panels.length) {\n        return <div class={[`${classPrefix.value}-tabs__content`]}>{panels}</div>;\n      }\n      console.warn('Tdesign error: list or slots is empty');\n    };\n\n    return () => {\n      return (\n        <div class={[COMPONENT_NAME.value]}>\n          {props.placement !== 'bottom' ? [renderHeader(), renderContent()] : [renderContent(), renderHeader()]}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","COMPONENT_NAME","usePrefixClass","classPrefix","renderTNodeJSX","useTNodeJSX","toRefs","value","modelValue","useVModel","defaultValue","onChange","_slicedToArray","tabValue","setTabValue","provide","onTabAdd","context","onAdd","e","onTabChange","onTabRemove","index","onRemove","getSlotPanels","content","map","item","children","Array","isArray","flat","filter","type","renderHeader","panels","list","length","panelsData","selfItem","Object","keys","forEach","key","tabNavProps","theme","size","disabled","placement","addable","dragSort","_createVNode","_defineProperty","TTabNav","_mergeProps","onDragSort","renderContent","TTabPanel","console","warn"],"mappings":"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"}