{"version":3,"file":"upload.js","sources":["../../src/upload/upload.tsx"],"sourcesContent":["import { VNode, defineComponent, reactive, computed, toRefs } from 'vue';\n\nimport { UploadIcon as TdUploadIcon } from 'tdesign-icons-vue-next';\n\nimport Dragger from './dragger';\nimport ImageCard from './image';\nimport FlowList from './flow-list';\nimport TButton from '../button';\nimport TDialog from '../dialog';\nimport SingleFile from './single-file';\n\nimport props from './props';\nimport { UploadCtxType } from './interface';\nimport { TdUploadProps } from './type';\n\nimport { useFormDisabled } from '../form/hooks';\nimport { useComponentsStatus, useImgPreview, useDragger, useRemove, useActions, useBatchUpload } from './hooks';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { useConfig, usePrefixClass } from '../hooks/useConfig';\nimport { useContent } from '../hooks/tnode';\nimport useVModel from '../hooks/useVModel';\n\nexport default defineComponent({\n  name: 'TUpload',\n  props,\n\n  setup(props, { expose }) {\n    const renderTNodeContent = useContent();\n    const { classPrefix: prefix, globalConfig } = useConfig('upload');\n    const UPLOAD_NAME = usePrefixClass('upload');\n    const { UploadIcon } = useGlobalIcon({ UploadIcon: TdUploadIcon });\n    const { files, modelValue } = toRefs(props);\n\n    // 合并上传相关状态\n    const { canBatchUpload, uploadInOneRequest } = useBatchUpload(props);\n    // handle controlled property and uncontrolled property\n    const [uploadValue, setUploadValue] = useVModel(\n      files,\n      modelValue,\n      props.defaultFiles || [],\n      props.onChange,\n      'files',\n    );\n\n    const uploadCtx: UploadCtxType = reactive({\n      uploadValue,\n      setUploadValue,\n      uploadInOneRequest,\n      canBatchUpload,\n      // 加载中的文件\n      loadingFile: null,\n      percent: 0,\n      // 等待上传的文件队列\n      toUploadFiles: [],\n      errorMsg: '',\n    });\n\n    const disabled = useFormDisabled();\n\n    // 组件状态\n    const { showUploadList, showTips, showErrorMsg, singleDraggable } = useComponentsStatus(props, uploadCtx);\n\n    // 图片预览\n    const { showImageViewUrl, showImageViewDialog, handlePreviewImg, cancelPreviewImgDialog } = useImgPreview(props);\n\n    // 拖动\n    const { handleDragenter, handleDragleave, dragActive } = useDragger(props, disabled);\n\n    // 删除\n    const { handleFileInputRemove, handleSingleRemove, handleMultipleRemove, handleListRemove } = useRemove(\n      props,\n      uploadCtx,\n    );\n\n    // 上传相关动作\n    const { handleChange, multipleUpload, triggerUpload, cancelUpload, handleDragChange, upload, inputRef } =\n      useActions(props, uploadCtx, disabled);\n\n    expose({\n      triggerUpload,\n      setPercent: (val: number) => {\n        uploadCtx.percent = val;\n      },\n    });\n\n    // input 节点\n    const renderInput = () => {\n      return (\n        <input\n          ref={inputRef}\n          type=\"file\"\n          disabled={disabled.value}\n          onChange={handleChange}\n          multiple={props.multiple}\n          accept={props.accept}\n          hidden\n        />\n      );\n    };\n\n    // 渲染单文件预览：设计稿有两种单文件预览方式，文本型和输入框型。输入框型的需要在右侧显示「删除」按钮\n    const renderSingleDisplay = (triggerElement: VNode) => {\n      return (\n        !props.draggable &&\n        ['file', 'file-input'].includes(props.theme) && (\n          <SingleFile\n            file={uploadValue.value && uploadValue.value[0]}\n            loadingFile={uploadCtx.loadingFile}\n            percent={uploadCtx.percent}\n            theme={props.theme}\n            onRemove={handleSingleRemove}\n            showUploadProgress={props.showUploadProgress}\n            placeholder={props.placeholder}\n          >\n            <div class={`${prefix.value}-upload__trigger`} onclick={triggerUpload}>\n              {triggerElement}\n              {!!(props.theme === 'file-input' && uploadValue.value?.length) && (\n                <TButton theme=\"primary\" variant=\"text\" onClick={handleFileInputRemove}>\n                  删除\n                </TButton>\n              )}\n            </div>\n          </SingleFile>\n        )\n      );\n    };\n\n    const renderDraggerTrigger = () => {\n      const params = {\n        dragActive: dragActive.value,\n        uploadingFile: props.multiple ? uploadCtx.toUploadFiles : uploadCtx.loadingFile,\n      };\n      let triggerElement = renderTNodeContent('default', 'trigger', { params });\n      if (!Array.isArray(triggerElement)) {\n        triggerElement = {};\n      }\n      return (\n        <Dragger\n          showUploadProgress={props.showUploadProgress}\n          loadingFile={uploadCtx.loadingFile}\n          percent={uploadCtx.percent}\n          file={uploadValue.value && uploadValue.value[0]}\n          theme={props.theme}\n          autoUpload={props.autoUpload}\n          onChange={handleDragChange}\n          onDragenter={handleDragenter}\n          onDragleave={handleDragleave}\n          onCancel={cancelUpload}\n          onClick={triggerUpload}\n          onRemove={handleSingleRemove}\n          onUpload={upload}\n          locale={props.locale}\n        >\n          {triggerElement}\n        </Dragger>\n      );\n    };\n\n    const uploadListTriggerText = computed(() => {\n      const localeFromProps = props.locale as TdUploadProps['locale'];\n\n      let uploadText = globalConfig.value.triggerUploadText.fileInput || localeFromProps?.triggerUploadText?.fileInput;\n      if (uploadCtx.toUploadFiles?.length > 0 || uploadCtx.uploadValue?.length > 0) {\n        if (props.theme === 'file-input' || (uploadCtx.uploadValue?.length > 0 && canBatchUpload.value)) {\n          uploadText = localeFromProps?.triggerUploadText?.reupload || globalConfig.value.triggerUploadText.reupload;\n        } else {\n          uploadText =\n            localeFromProps?.triggerUploadText?.continueUpload || globalConfig.value.triggerUploadText.continueUpload;\n        }\n      }\n      return uploadText;\n    });\n\n    const renderTrigger = () => {\n      const getDefaultTrigger = () => {\n        const localeFromProps = props.locale as TdUploadProps['locale'];\n\n        if (props.theme === 'file-input' || showUploadList.value) {\n          return (\n            <t-button variant=\"outline\">\n              {localeFromProps?.triggerUploadText?.fileInput || globalConfig.value.triggerUploadText.fileInput}\n            </t-button>\n          );\n        }\n        const iconSlot = { icon: () => <UploadIcon /> };\n        return (\n          <TButton variant=\"outline\" v-slots={iconSlot}>\n            {uploadListTriggerText.value}\n          </TButton>\n        );\n      };\n\n      const defaultNode = getDefaultTrigger();\n      return renderTNodeContent('default', 'trigger', defaultNode);\n    };\n\n    // 完全自定义上传\n    const renderCustom = (triggerElement: VNode) => {\n      if (props.theme !== 'custom') return;\n      return props.draggable ? (\n        renderDraggerTrigger()\n      ) : (\n        <div class={`${UPLOAD_NAME.value}__trigger`} onclick={triggerUpload}>\n          {triggerElement}\n        </div>\n      );\n    };\n\n    const renderImgCard = () =>\n      !props.draggable &&\n      props.theme === 'image' && (\n        <ImageCard\n          files={uploadValue.value}\n          loadingFile={uploadCtx.loadingFile}\n          percent={uploadCtx.percent}\n          showUploadProgress={props.showUploadProgress}\n          placeholder={props.placeholder}\n          multiple={props.multiple}\n          max={props.max}\n          disabled={disabled.value}\n          onClick={triggerUpload}\n          onRemove={handleMultipleRemove}\n          onImgPreview={handlePreviewImg}\n          locale={props.locale}\n        />\n      );\n\n    const renderFlowList = (triggerElement: VNode) => {\n      let { theme } = props;\n      if (props.multiple && props.theme === 'file' && props.draggable) {\n        theme = 'file-flow';\n      }\n      return (\n        showUploadList.value && (\n          <FlowList\n            files={uploadValue.value}\n            placeholder={props.placeholder}\n            autoUpload={props.autoUpload}\n            toUploadFiles={uploadCtx.toUploadFiles}\n            theme={theme}\n            batchUpload={uploadCtx.canBatchUpload}\n            showUploadProgress={props.showUploadProgress}\n            allowUploadDuplicateFile={props.allowUploadDuplicateFile}\n            onRemove={handleListRemove}\n            onUpload={multipleUpload}\n            onCancel={cancelUpload}\n            onImgPreview={handlePreviewImg}\n            onChange={handleDragChange}\n            onDragenter={handleDragenter}\n            onDragleave={handleDragleave}\n            locale={props.locale}\n          >\n            <div class={`${UPLOAD_NAME.value}__trigger`} onclick={triggerUpload}>\n              {triggerElement}\n            </div>\n          </FlowList>\n        )\n      );\n    };\n\n    const renderDialog = () =>\n      ['image', 'image-flow', 'custom'].includes(props.theme) && (\n        <TDialog\n          visible={showImageViewDialog.value}\n          showOverlay\n          width=\"auto\"\n          top=\"10%\"\n          class={`${UPLOAD_NAME.value}__dialog`}\n          footer={false}\n          header={false}\n          onClose={cancelPreviewImgDialog}\n        >\n          <div class={`${prefix.value}__dialog-body-img-box`}>\n            <img src={showImageViewUrl.value} alt=\"\" />\n          </div>\n        </TDialog>\n      );\n\n    const tipsClasses = computed(() => {\n      return [`${UPLOAD_NAME.value}__tips ${prefix.value}-size-s`];\n    });\n    const errorClasses = computed(() => {\n      return tipsClasses.value.concat(`${UPLOAD_NAME.value}__tips-error`);\n    });\n\n    return () => {\n      const triggerElement = renderTrigger();\n      return (\n        <div class={`${UPLOAD_NAME.value}`}>\n          {renderInput()}\n          {renderCustom(triggerElement)}\n          {renderSingleDisplay(triggerElement)}\n          {singleDraggable.value && renderDraggerTrigger()}\n          {renderImgCard()}\n          {renderFlowList(triggerElement)}\n          {renderDialog()}\n          {!uploadCtx.errorMsg && showTips.value && <small class={tipsClasses.value}>{props.tips}</small>}\n          {showErrorMsg.value && <small class={errorClasses.value}>{uploadCtx.errorMsg}</small>}\n        </div>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","expose","renderTNodeContent","useContent","useConfig","prefix","classPrefix","globalConfig","UPLOAD_NAME","usePrefixClass","useGlobalIcon","UploadIcon","TdUploadIcon","toRefs","files","modelValue","useBatchUpload","canBatchUpload","uploadInOneRequest","useVModel","defaultFiles","onChange","_slicedToArray","uploadValue","setUploadValue","uploadCtx","reactive","loadingFile","percent","toUploadFiles","errorMsg","disabled","useFormDisabled","useComponentsStatus","showUploadList","showTips","showErrorMsg","singleDraggable","useImgPreview","showImageViewUrl","showImageViewDialog","handlePreviewImg","cancelPreviewImgDialog","useDragger","handleDragenter","handleDragleave","dragActive","useRemove","handleFileInputRemove","handleSingleRemove","handleMultipleRemove","handleListRemove","useActions","handleChange","multipleUpload","triggerUpload","cancelUpload","handleDragChange","upload","inputRef","setPercent","val","renderInput","_createVNode","value","multiple","accept","renderSingleDisplay","triggerElement","draggable","includes","theme","SingleFile","showUploadProgress","placeholder","length","TButton","renderDraggerTrigger","params","uploadingFile","Array","isArray","Dragger","autoUpload","locale","uploadListTriggerText","computed","localeFromProps","uploadText","triggerUploadText","fileInput","reupload","continueUpload","renderTrigger","getDefaultTrigger","_resolveComponent","iconSlot","icon","defaultNode","renderCustom","renderImgCard","ImageCard","max","renderFlowList","FlowList","allowUploadDuplicateFile","renderDialog","TDialog","tipsClasses","errorClasses","concat","tips"],"mappings":"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"}